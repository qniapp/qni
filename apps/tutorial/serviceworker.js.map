{
  "version": 3,
  "sources": ["../../node_modules/fraction.js/fraction.js", "../../node_modules/fp-ts/es6/NonEmptyArray.js", "../../node_modules/fraction.js/fraction.js", "../../packages/common/src/angle-parser.ts", "../../packages/common/src/format.ts", "../../packages/common/src/number-formatter.ts", "../../packages/common/src/complex.ts", "../../packages/common/src/config.ts", "../../packages/common/src/emit-event.ts", "../../packages/common/src/numeric-range.ts", "../../packages/common/src/util.ts", "../../packages/common/src/anti-control-gate.ts", "../../packages/common/src/bloch-display.ts", "../../packages/common/src/control-gate.ts", "../../packages/common/src/h-gate.ts", "../../packages/common/src/measurement-gate.ts", "../../packages/common/src/phase-gate.ts", "../../packages/common/src/qft-dagger-gate.ts", "../../packages/common/src/qft-gate.ts", "../../packages/common/src/rnot-gate.ts", "../../packages/common/src/rx-gate.ts", "../../packages/common/src/ry-gate.ts", "../../packages/common/src/rz-gate.ts", "../../packages/common/src/s-dagger-gate.ts", "../../packages/common/src/s-gate.ts", "../../packages/common/src/spacer-gate.ts", "../../packages/common/src/swap-gate.ts", "../../packages/common/src/t-dagger-gate.ts", "../../packages/common/src/t-gate.ts", "../../packages/common/src/write-gate.ts", "../../packages/common/src/x-gate.ts", "../../packages/common/src/y-gate.ts", "../../packages/common/src/z-gate.ts", "../../node_modules/neverthrow/dist/index.es.js", "../../packages/simulator/src/matrix.ts", "../../packages/simulator/src/gate-matrices.ts", "../../packages/simulator/src/state-vector.ts", "../../packages/simulator/src/util.ts", "../../packages/simulator/src/simulator.ts", "../../packages/common/src/angle-parser.ts", "../../packages/common/src/format.ts", "../../packages/common/src/number-formatter.ts", "../../packages/common/src/complex.ts", "../../packages/common/src/config.ts", "../../packages/common/src/emit-event.ts", "../../packages/common/src/numeric-range.ts", "../../packages/common/src/util.ts", "../../packages/common/src/anti-control-gate.ts", "../../packages/common/src/bloch-display.ts", "../../packages/common/src/control-gate.ts", "../../packages/common/src/h-gate.ts", "../../packages/common/src/measurement-gate.ts", "../../packages/common/src/phase-gate.ts", "../../packages/common/src/qft-dagger-gate.ts", "../../packages/common/src/qft-gate.ts", "../../packages/common/src/rnot-gate.ts", "../../packages/common/src/rx-gate.ts", "../../packages/common/src/ry-gate.ts", "../../packages/common/src/rz-gate.ts", "../../packages/common/src/s-dagger-gate.ts", "../../packages/common/src/s-gate.ts", "../../packages/common/src/spacer-gate.ts", "../../packages/common/src/swap-gate.ts", "../../packages/common/src/t-dagger-gate.ts", "../../packages/common/src/t-gate.ts", "../../packages/common/src/write-gate.ts", "../../packages/common/src/x-gate.ts", "../../packages/common/src/y-gate.ts", "../../packages/common/src/z-gate.ts", "../../node_modules/neverthrow/dist/index.es.js", "src/serviceworker.js"],
  "sourcesContent": ["/**\n * @license Fraction.js v4.2.0 05/03/2022\n * https://www.xarg.org/2014/03/rational-numbers-in-javascript/\n *\n * Copyright (c) 2021, Robert Eisele (robert@xarg.org)\n * Dual licensed under the MIT or GPL Version 2 licenses.\n **/\n\n\n/**\n *\n * This class offers the possibility to calculate fractions.\n * You can pass a fraction in different formats. Either as array, as double, as string or as an integer.\n *\n * Array/Object form\n * [ 0 => <nominator>, 1 => <denominator> ]\n * [ n => <nominator>, d => <denominator> ]\n *\n * Integer form\n * - Single integer value\n *\n * Double form\n * - Single double value\n *\n * String form\n * 123.456 - a simple double\n * 123/456 - a string fraction\n * 123.'456' - a double with repeating decimal places\n * 123.(456) - synonym\n * 123.45'6' - a double with repeating last place\n * 123.45(6) - synonym\n *\n * Example:\n *\n * var f = new Fraction(\"9.4'31'\");\n * f.mul([-4, 3]).div(4.9);\n *\n */\n\n(function(root) {\n\n  \"use strict\";\n\n  // Maximum search depth for cyclic rational numbers. 2000 should be more than enough.\n  // Example: 1/7 = 0.(142857) has 6 repeating decimal places.\n  // If MAX_CYCLE_LEN gets reduced, long cycles will not be detected and toString() only gets the first 10 digits\n  var MAX_CYCLE_LEN = 2000;\n\n  // Parsed data to avoid calling \"new\" all the time\n  var P = {\n    \"s\": 1,\n    \"n\": 0,\n    \"d\": 1\n  };\n\n  function assign(n, s) {\n\n    if (isNaN(n = parseInt(n, 10))) {\n      throw Fraction['InvalidParameter'];\n    }\n    return n * s;\n  }\n\n  // Creates a new Fraction internally without the need of the bulky constructor\n  function newFraction(n, d) {\n\n    if (d === 0) {\n      throw Fraction['DivisionByZero'];\n    }\n\n    var f = Object.create(Fraction.prototype);\n    f[\"s\"] = n < 0 ? -1 : 1;\n\n    n = n < 0 ? -n : n;\n\n    var a = gcd(n, d);\n\n    f[\"n\"] = n / a;\n    f[\"d\"] = d / a;\n    return f;\n  }\n\n  function factorize(num) {\n\n    var factors = {};\n\n    var n = num;\n    var i = 2;\n    var s = 4;\n\n    while (s <= n) {\n\n      while (n % i === 0) {\n        n/= i;\n        factors[i] = (factors[i] || 0) + 1;\n      }\n      s+= 1 + 2 * i++;\n    }\n\n    if (n !== num) {\n      if (n > 1)\n        factors[n] = (factors[n] || 0) + 1;\n    } else {\n      factors[num] = (factors[num] || 0) + 1;\n    }\n    return factors;\n  }\n\n  var parse = function(p1, p2) {\n\n    var n = 0, d = 1, s = 1;\n    var v = 0, w = 0, x = 0, y = 1, z = 1;\n\n    var A = 0, B = 1;\n    var C = 1, D = 1;\n\n    var N = 10000000;\n    var M;\n\n    if (p1 === undefined || p1 === null) {\n      /* void */\n    } else if (p2 !== undefined) {\n      n = p1;\n      d = p2;\n      s = n * d;\n\n      if (n % 1 !== 0 || d % 1 !== 0) {\n        throw Fraction['NonIntegerParameter'];\n      }\n\n    } else\n      switch (typeof p1) {\n\n        case \"object\":\n          {\n            if (\"d\" in p1 && \"n\" in p1) {\n              n = p1[\"n\"];\n              d = p1[\"d\"];\n              if (\"s\" in p1)\n                n*= p1[\"s\"];\n            } else if (0 in p1) {\n              n = p1[0];\n              if (1 in p1)\n                d = p1[1];\n            } else {\n              throw Fraction['InvalidParameter'];\n            }\n            s = n * d;\n            break;\n          }\n        case \"number\":\n          {\n            if (p1 < 0) {\n              s = p1;\n              p1 = -p1;\n            }\n\n            if (p1 % 1 === 0) {\n              n = p1;\n            } else if (p1 > 0) { // check for != 0, scale would become NaN (log(0)), which converges really slow\n\n              if (p1 >= 1) {\n                z = Math.pow(10, Math.floor(1 + Math.log(p1) / Math.LN10));\n                p1/= z;\n              }\n\n              // Using Farey Sequences\n              // http://www.johndcook.com/blog/2010/10/20/best-rational-approximation/\n\n              while (B <= N && D <= N) {\n                M = (A + C) / (B + D);\n\n                if (p1 === M) {\n                  if (B + D <= N) {\n                    n = A + C;\n                    d = B + D;\n                  } else if (D > B) {\n                    n = C;\n                    d = D;\n                  } else {\n                    n = A;\n                    d = B;\n                  }\n                  break;\n\n                } else {\n\n                  if (p1 > M) {\n                    A+= C;\n                    B+= D;\n                  } else {\n                    C+= A;\n                    D+= B;\n                  }\n\n                  if (B > N) {\n                    n = C;\n                    d = D;\n                  } else {\n                    n = A;\n                    d = B;\n                  }\n                }\n              }\n              n*= z;\n            } else if (isNaN(p1) || isNaN(p2)) {\n              d = n = NaN;\n            }\n            break;\n          }\n        case \"string\":\n          {\n            B = p1.match(/\\d+|./g);\n\n            if (B === null)\n              throw Fraction['InvalidParameter'];\n\n            if (B[A] === '-') {// Check for minus sign at the beginning\n              s = -1;\n              A++;\n            } else if (B[A] === '+') {// Check for plus sign at the beginning\n              A++;\n            }\n\n            if (B.length === A + 1) { // Check if it's just a simple number \"1234\"\n              w = assign(B[A++], s);\n            } else if (B[A + 1] === '.' || B[A] === '.') { // Check if it's a decimal number\n\n              if (B[A] !== '.') { // Handle 0.5 and .5\n                v = assign(B[A++], s);\n              }\n              A++;\n\n              // Check for decimal places\n              if (A + 1 === B.length || B[A + 1] === '(' && B[A + 3] === ')' || B[A + 1] === \"'\" && B[A + 3] === \"'\") {\n                w = assign(B[A], s);\n                y = Math.pow(10, B[A].length);\n                A++;\n              }\n\n              // Check for repeating places\n              if (B[A] === '(' && B[A + 2] === ')' || B[A] === \"'\" && B[A + 2] === \"'\") {\n                x = assign(B[A + 1], s);\n                z = Math.pow(10, B[A + 1].length) - 1;\n                A+= 3;\n              }\n\n            } else if (B[A + 1] === '/' || B[A + 1] === ':') { // Check for a simple fraction \"123/456\" or \"123:456\"\n              w = assign(B[A], s);\n              y = assign(B[A + 2], 1);\n              A+= 3;\n            } else if (B[A + 3] === '/' && B[A + 1] === ' ') { // Check for a complex fraction \"123 1/2\"\n              v = assign(B[A], s);\n              w = assign(B[A + 2], s);\n              y = assign(B[A + 4], 1);\n              A+= 5;\n            }\n\n            if (B.length <= A) { // Check for more tokens on the stack\n              d = y * z;\n              s = /* void */\n              n = x + d * v + z * w;\n              break;\n            }\n\n            /* Fall through on error */\n          }\n        default:\n          throw Fraction['InvalidParameter'];\n      }\n\n    if (d === 0) {\n      throw Fraction['DivisionByZero'];\n    }\n\n    P[\"s\"] = s < 0 ? -1 : 1;\n    P[\"n\"] = Math.abs(n);\n    P[\"d\"] = Math.abs(d);\n  };\n\n  function modpow(b, e, m) {\n\n    var r = 1;\n    for (; e > 0; b = (b * b) % m, e >>= 1) {\n\n      if (e & 1) {\n        r = (r * b) % m;\n      }\n    }\n    return r;\n  }\n\n\n  function cycleLen(n, d) {\n\n    for (; d % 2 === 0;\n      d/= 2) {\n    }\n\n    for (; d % 5 === 0;\n      d/= 5) {\n    }\n\n    if (d === 1) // Catch non-cyclic numbers\n      return 0;\n\n    // If we would like to compute really large numbers quicker, we could make use of Fermat's little theorem:\n    // 10^(d-1) % d == 1\n    // However, we don't need such large numbers and MAX_CYCLE_LEN should be the capstone,\n    // as we want to translate the numbers to strings.\n\n    var rem = 10 % d;\n    var t = 1;\n\n    for (; rem !== 1; t++) {\n      rem = rem * 10 % d;\n\n      if (t > MAX_CYCLE_LEN)\n        return 0; // Returning 0 here means that we don't print it as a cyclic number. It's likely that the answer is `d-1`\n    }\n    return t;\n  }\n\n\n  function cycleStart(n, d, len) {\n\n    var rem1 = 1;\n    var rem2 = modpow(10, len, d);\n\n    for (var t = 0; t < 300; t++) { // s < ~log10(Number.MAX_VALUE)\n      // Solve 10^s == 10^(s+t) (mod d)\n\n      if (rem1 === rem2)\n        return t;\n\n      rem1 = rem1 * 10 % d;\n      rem2 = rem2 * 10 % d;\n    }\n    return 0;\n  }\n\n  function gcd(a, b) {\n\n    if (!a)\n      return b;\n    if (!b)\n      return a;\n\n    while (1) {\n      a%= b;\n      if (!a)\n        return b;\n      b%= a;\n      if (!b)\n        return a;\n    }\n  };\n\n  /**\n   * Module constructor\n   *\n   * @constructor\n   * @param {number|Fraction=} a\n   * @param {number=} b\n   */\n  function Fraction(a, b) {\n\n    parse(a, b);\n\n    if (this instanceof Fraction) {\n      a = gcd(P[\"d\"], P[\"n\"]); // Abuse variable a\n      this[\"s\"] = P[\"s\"];\n      this[\"n\"] = P[\"n\"] / a;\n      this[\"d\"] = P[\"d\"] / a;\n    } else {\n      return newFraction(P['s'] * P['n'], P['d']);\n    }\n  }\n\n  Fraction['DivisionByZero'] = new Error(\"Division by Zero\");\n  Fraction['InvalidParameter'] = new Error(\"Invalid argument\");\n  Fraction['NonIntegerParameter'] = new Error(\"Parameters must be integer\");\n\n  Fraction.prototype = {\n\n    \"s\": 1,\n    \"n\": 0,\n    \"d\": 1,\n\n    /**\n     * Calculates the absolute value\n     *\n     * Ex: new Fraction(-4).abs() => 4\n     **/\n    \"abs\": function() {\n\n      return newFraction(this[\"n\"], this[\"d\"]);\n    },\n\n    /**\n     * Inverts the sign of the current fraction\n     *\n     * Ex: new Fraction(-4).neg() => 4\n     **/\n    \"neg\": function() {\n\n      return newFraction(-this[\"s\"] * this[\"n\"], this[\"d\"]);\n    },\n\n    /**\n     * Adds two rational numbers\n     *\n     * Ex: new Fraction({n: 2, d: 3}).add(\"14.9\") => 467 / 30\n     **/\n    \"add\": function(a, b) {\n\n      parse(a, b);\n      return newFraction(\n        this[\"s\"] * this[\"n\"] * P[\"d\"] + P[\"s\"] * this[\"d\"] * P[\"n\"],\n        this[\"d\"] * P[\"d\"]\n      );\n    },\n\n    /**\n     * Subtracts two rational numbers\n     *\n     * Ex: new Fraction({n: 2, d: 3}).add(\"14.9\") => -427 / 30\n     **/\n    \"sub\": function(a, b) {\n\n      parse(a, b);\n      return newFraction(\n        this[\"s\"] * this[\"n\"] * P[\"d\"] - P[\"s\"] * this[\"d\"] * P[\"n\"],\n        this[\"d\"] * P[\"d\"]\n      );\n    },\n\n    /**\n     * Multiplies two rational numbers\n     *\n     * Ex: new Fraction(\"-17.(345)\").mul(3) => 5776 / 111\n     **/\n    \"mul\": function(a, b) {\n\n      parse(a, b);\n      return newFraction(\n        this[\"s\"] * P[\"s\"] * this[\"n\"] * P[\"n\"],\n        this[\"d\"] * P[\"d\"]\n      );\n    },\n\n    /**\n     * Divides two rational numbers\n     *\n     * Ex: new Fraction(\"-17.(345)\").inverse().div(3)\n     **/\n    \"div\": function(a, b) {\n\n      parse(a, b);\n      return newFraction(\n        this[\"s\"] * P[\"s\"] * this[\"n\"] * P[\"d\"],\n        this[\"d\"] * P[\"n\"]\n      );\n    },\n\n    /**\n     * Clones the actual object\n     *\n     * Ex: new Fraction(\"-17.(345)\").clone()\n     **/\n    \"clone\": function() {\n      return newFraction(this['s'] * this['n'], this['d']);\n    },\n\n    /**\n     * Calculates the modulo of two rational numbers - a more precise fmod\n     *\n     * Ex: new Fraction('4.(3)').mod([7, 8]) => (13/3) % (7/8) = (5/6)\n     **/\n    \"mod\": function(a, b) {\n\n      if (isNaN(this['n']) || isNaN(this['d'])) {\n        return new Fraction(NaN);\n      }\n\n      if (a === undefined) {\n        return newFraction(this[\"s\"] * this[\"n\"] % this[\"d\"], 1);\n      }\n\n      parse(a, b);\n      if (0 === P[\"n\"] && 0 === this[\"d\"]) {\n        throw Fraction['DivisionByZero'];\n      }\n\n      /*\n       * First silly attempt, kinda slow\n       *\n       return that[\"sub\"]({\n       \"n\": num[\"n\"] * Math.floor((this.n / this.d) / (num.n / num.d)),\n       \"d\": num[\"d\"],\n       \"s\": this[\"s\"]\n       });*/\n\n      /*\n       * New attempt: a1 / b1 = a2 / b2 * q + r\n       * => b2 * a1 = a2 * b1 * q + b1 * b2 * r\n       * => (b2 * a1 % a2 * b1) / (b1 * b2)\n       */\n      return newFraction(\n        this[\"s\"] * (P[\"d\"] * this[\"n\"]) % (P[\"n\"] * this[\"d\"]),\n        P[\"d\"] * this[\"d\"]\n      );\n    },\n\n    /**\n     * Calculates the fractional gcd of two rational numbers\n     *\n     * Ex: new Fraction(5,8).gcd(3,7) => 1/56\n     */\n    \"gcd\": function(a, b) {\n\n      parse(a, b);\n\n      // gcd(a / b, c / d) = gcd(a, c) / lcm(b, d)\n\n      return newFraction(gcd(P[\"n\"], this[\"n\"]) * gcd(P[\"d\"], this[\"d\"]), P[\"d\"] * this[\"d\"]);\n    },\n\n    /**\n     * Calculates the fractional lcm of two rational numbers\n     *\n     * Ex: new Fraction(5,8).lcm(3,7) => 15\n     */\n    \"lcm\": function(a, b) {\n\n      parse(a, b);\n\n      // lcm(a / b, c / d) = lcm(a, c) / gcd(b, d)\n\n      if (P[\"n\"] === 0 && this[\"n\"] === 0) {\n        return newFraction(0, 1);\n      }\n      return newFraction(P[\"n\"] * this[\"n\"], gcd(P[\"n\"], this[\"n\"]) * gcd(P[\"d\"], this[\"d\"]));\n    },\n\n    /**\n     * Calculates the ceil of a rational number\n     *\n     * Ex: new Fraction('4.(3)').ceil() => (5 / 1)\n     **/\n    \"ceil\": function(places) {\n\n      places = Math.pow(10, places || 0);\n\n      if (isNaN(this[\"n\"]) || isNaN(this[\"d\"])) {\n        return new Fraction(NaN);\n      }\n      return newFraction(Math.ceil(places * this[\"s\"] * this[\"n\"] / this[\"d\"]), places);\n    },\n\n    /**\n     * Calculates the floor of a rational number\n     *\n     * Ex: new Fraction('4.(3)').floor() => (4 / 1)\n     **/\n    \"floor\": function(places) {\n\n      places = Math.pow(10, places || 0);\n\n      if (isNaN(this[\"n\"]) || isNaN(this[\"d\"])) {\n        return new Fraction(NaN);\n      }\n      return newFraction(Math.floor(places * this[\"s\"] * this[\"n\"] / this[\"d\"]), places);\n    },\n\n    /**\n     * Rounds a rational numbers\n     *\n     * Ex: new Fraction('4.(3)').round() => (4 / 1)\n     **/\n    \"round\": function(places) {\n\n      places = Math.pow(10, places || 0);\n\n      if (isNaN(this[\"n\"]) || isNaN(this[\"d\"])) {\n        return new Fraction(NaN);\n      }\n      return newFraction(Math.round(places * this[\"s\"] * this[\"n\"] / this[\"d\"]), places);\n    },\n\n    /**\n     * Gets the inverse of the fraction, means numerator and denominator are exchanged\n     *\n     * Ex: new Fraction([-3, 4]).inverse() => -4 / 3\n     **/\n    \"inverse\": function() {\n\n      return newFraction(this[\"s\"] * this[\"d\"], this[\"n\"]);\n    },\n\n    /**\n     * Calculates the fraction to some rational exponent, if possible\n     *\n     * Ex: new Fraction(-1,2).pow(-3) => -8\n     */\n    \"pow\": function(a, b) {\n\n      parse(a, b);\n\n      // Trivial case when exp is an integer\n\n      if (P['d'] === 1) {\n\n        if (P['s'] < 0) {\n          return newFraction(Math.pow(this['s'] * this[\"d\"], P['n']), Math.pow(this[\"n\"], P['n']));\n        } else {\n          return newFraction(Math.pow(this['s'] * this[\"n\"], P['n']), Math.pow(this[\"d\"], P['n']));\n        }\n      }\n\n      // Negative roots become complex\n      //     (-a/b)^(c/d) = x\n      // <=> (-1)^(c/d) * (a/b)^(c/d) = x\n      // <=> (cos(pi) + i*sin(pi))^(c/d) * (a/b)^(c/d) = x         # rotate 1 by 180\u00B0\n      // <=> (cos(c*pi/d) + i*sin(c*pi/d)) * (a/b)^(c/d) = x       # DeMoivre's formula in Q ( https://proofwiki.org/wiki/De_Moivre%27s_Formula/Rational_Index )\n      // From which follows that only for c=0 the root is non-complex. c/d is a reduced fraction, so that sin(c/dpi)=0 occurs for d=1, which is handled by our trivial case.\n      if (this['s'] < 0) return null;\n\n      // Now prime factor n and d\n      var N = factorize(this['n']);\n      var D = factorize(this['d']);\n\n      // Exponentiate and take root for n and d individually\n      var n = 1;\n      var d = 1;\n      for (var k in N) {\n        if (k === '1') continue;\n        if (k === '0') {\n          n = 0;\n          break;\n        }\n        N[k]*= P['n'];\n\n        if (N[k] % P['d'] === 0) {\n          N[k]/= P['d'];\n        } else return null;\n        n*= Math.pow(k, N[k]);\n      }\n\n      for (var k in D) {\n        if (k === '1') continue;\n        D[k]*= P['n'];\n\n        if (D[k] % P['d'] === 0) {\n          D[k]/= P['d'];\n        } else return null;\n        d*= Math.pow(k, D[k]);\n      }\n\n      if (P['s'] < 0) {\n        return newFraction(d, n);\n      }\n      return newFraction(n, d);\n    },\n\n    /**\n     * Check if two rational numbers are the same\n     *\n     * Ex: new Fraction(19.6).equals([98, 5]);\n     **/\n    \"equals\": function(a, b) {\n\n      parse(a, b);\n      return this[\"s\"] * this[\"n\"] * P[\"d\"] === P[\"s\"] * P[\"n\"] * this[\"d\"]; // Same as compare() === 0\n    },\n\n    /**\n     * Check if two rational numbers are the same\n     *\n     * Ex: new Fraction(19.6).equals([98, 5]);\n     **/\n    \"compare\": function(a, b) {\n\n      parse(a, b);\n      var t = (this[\"s\"] * this[\"n\"] * P[\"d\"] - P[\"s\"] * P[\"n\"] * this[\"d\"]);\n      return (0 < t) - (t < 0);\n    },\n\n    \"simplify\": function(eps) {\n\n      if (isNaN(this['n']) || isNaN(this['d'])) {\n        return this;\n      }\n\n      eps = eps || 0.001;\n\n      var thisABS = this['abs']();\n      var cont = thisABS['toContinued']();\n\n      for (var i = 1; i < cont.length; i++) {\n\n        var s = newFraction(cont[i - 1], 1);\n        for (var k = i - 2; k >= 0; k--) {\n          s = s['inverse']()['add'](cont[k]);\n        }\n\n        if (s['sub'](thisABS)['abs']().valueOf() < eps) {\n          return s['mul'](this['s']);\n        }\n      }\n      return this;\n    },\n\n    /**\n     * Check if two rational numbers are divisible\n     *\n     * Ex: new Fraction(19.6).divisible(1.5);\n     */\n    \"divisible\": function(a, b) {\n\n      parse(a, b);\n      return !(!(P[\"n\"] * this[\"d\"]) || ((this[\"n\"] * P[\"d\"]) % (P[\"n\"] * this[\"d\"])));\n    },\n\n    /**\n     * Returns a decimal representation of the fraction\n     *\n     * Ex: new Fraction(\"100.'91823'\").valueOf() => 100.91823918239183\n     **/\n    'valueOf': function() {\n\n      return this[\"s\"] * this[\"n\"] / this[\"d\"];\n    },\n\n    /**\n     * Returns a string-fraction representation of a Fraction object\n     *\n     * Ex: new Fraction(\"1.'3'\").toFraction(true) => \"4 1/3\"\n     **/\n    'toFraction': function(excludeWhole) {\n\n      var whole, str = \"\";\n      var n = this[\"n\"];\n      var d = this[\"d\"];\n      if (this[\"s\"] < 0) {\n        str+= '-';\n      }\n\n      if (d === 1) {\n        str+= n;\n      } else {\n\n        if (excludeWhole && (whole = Math.floor(n / d)) > 0) {\n          str+= whole;\n          str+= \" \";\n          n%= d;\n        }\n\n        str+= n;\n        str+= '/';\n        str+= d;\n      }\n      return str;\n    },\n\n    /**\n     * Returns a latex representation of a Fraction object\n     *\n     * Ex: new Fraction(\"1.'3'\").toLatex() => \"\\frac{4}{3}\"\n     **/\n    'toLatex': function(excludeWhole) {\n\n      var whole, str = \"\";\n      var n = this[\"n\"];\n      var d = this[\"d\"];\n      if (this[\"s\"] < 0) {\n        str+= '-';\n      }\n\n      if (d === 1) {\n        str+= n;\n      } else {\n\n        if (excludeWhole && (whole = Math.floor(n / d)) > 0) {\n          str+= whole;\n          n%= d;\n        }\n\n        str+= \"\\\\frac{\";\n        str+= n;\n        str+= '}{';\n        str+= d;\n        str+= '}';\n      }\n      return str;\n    },\n\n    /**\n     * Returns an array of continued fraction elements\n     *\n     * Ex: new Fraction(\"7/8\").toContinued() => [0,1,7]\n     */\n    'toContinued': function() {\n\n      var t;\n      var a = this['n'];\n      var b = this['d'];\n      var res = [];\n\n      if (isNaN(a) || isNaN(b)) {\n        return res;\n      }\n\n      do {\n        res.push(Math.floor(a / b));\n        t = a % b;\n        a = b;\n        b = t;\n      } while (a !== 1);\n\n      return res;\n    },\n\n    /**\n     * Creates a string representation of a fraction with all digits\n     *\n     * Ex: new Fraction(\"100.'91823'\").toString() => \"100.(91823)\"\n     **/\n    'toString': function(dec) {\n\n      var N = this[\"n\"];\n      var D = this[\"d\"];\n\n      if (isNaN(N) || isNaN(D)) {\n        return \"NaN\";\n      }\n\n      dec = dec || 15; // 15 = decimal places when no repetation\n\n      var cycLen = cycleLen(N, D); // Cycle length\n      var cycOff = cycleStart(N, D, cycLen); // Cycle start\n\n      var str = this['s'] < 0 ? \"-\" : \"\";\n\n      str+= N / D | 0;\n\n      N%= D;\n      N*= 10;\n\n      if (N)\n        str+= \".\";\n\n      if (cycLen) {\n\n        for (var i = cycOff; i--;) {\n          str+= N / D | 0;\n          N%= D;\n          N*= 10;\n        }\n        str+= \"(\";\n        for (var i = cycLen; i--;) {\n          str+= N / D | 0;\n          N%= D;\n          N*= 10;\n        }\n        str+= \")\";\n      } else {\n        for (var i = dec; N && i--;) {\n          str+= N / D | 0;\n          N%= D;\n          N*= 10;\n        }\n      }\n      return str;\n    }\n  };\n\n  if (typeof define === \"function\" && define[\"amd\"]) {\n    define([], function() {\n      return Fraction;\n    });\n  } else if (typeof exports === \"object\") {\n    Object.defineProperty(Fraction, \"__esModule\", { 'value': true });\n    Fraction['default'] = Fraction;\n    Fraction['Fraction'] = Fraction;\n    module['exports'] = Fraction;\n  } else {\n    root['Fraction'] = Fraction;\n  }\n\n})(this);\n", "var __spreadArray = (this && this.__spreadArray) || function (to, from) {\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\n        to[j] = from[i];\n    return to;\n};\nimport { apFirst as apFirst_, apS as apS_, apSecond as apSecond_ } from './Apply';\nimport { bind as bind_, chainFirst as chainFirst_ } from './Chain';\nimport { identity, pipe } from './function';\nimport { bindTo as bindTo_, flap as flap_ } from './Functor';\nimport * as _ from './internal';\nimport { getMonoid } from './Ord';\nimport * as RNEA from './ReadonlyNonEmptyArray';\n// -------------------------------------------------------------------------------------\n// internal\n// -------------------------------------------------------------------------------------\n/**\n * @internal\n */\nexport var isNonEmpty = function (as) { return as.length > 0; };\n/**\n * @internal\n */\nexport var isOutOfBound = function (i, as) { return i < 0 || i >= as.length; };\n/**\n * @internal\n */\nexport var prependW = function (head) { return function (tail) { return __spreadArray([head], tail); }; };\n/**\n * @internal\n */\nexport var prepend = prependW;\n/**\n * @internal\n */\nexport var appendW = function (end) { return function (init) { return __spreadArray(__spreadArray([], init), [end]); }; };\n/**\n * @internal\n */\nexport var append = appendW;\n/**\n * @internal\n */\nexport var unsafeInsertAt = function (i, a, as) {\n    if (isNonEmpty(as)) {\n        var xs = fromReadonlyNonEmptyArray(as);\n        xs.splice(i, 0, a);\n        return xs;\n    }\n    return [a];\n};\n/**\n * @internal\n */\nexport var unsafeUpdateAt = function (i, a, as) {\n    var xs = fromReadonlyNonEmptyArray(as);\n    xs[i] = a;\n    return xs;\n};\n/**\n * Remove duplicates from a `NonEmptyArray`, keeping the first occurrence of an element.\n *\n * @example\n * import { uniq } from 'fp-ts/NonEmptyArray'\n * import * as N from 'fp-ts/number'\n *\n * assert.deepStrictEqual(uniq(N.Eq)([1, 2, 1]), [1, 2])\n *\n * @category combinators\n * @since 2.11.0\n */\nexport var uniq = function (E) { return function (as) {\n    if (as.length === 1) {\n        return copy(as);\n    }\n    var out = [head(as)];\n    var rest = tail(as);\n    var _loop_1 = function (a) {\n        if (out.every(function (o) { return !E.equals(o, a); })) {\n            out.push(a);\n        }\n    };\n    for (var _i = 0, rest_1 = rest; _i < rest_1.length; _i++) {\n        var a = rest_1[_i];\n        _loop_1(a);\n    }\n    return out;\n}; };\n/**\n * Sort the elements of a `NonEmptyArray` in increasing order, where elements are compared using first `ords[0]`, then `ords[1]`,\n * etc...\n *\n * @example\n * import * as NEA from 'fp-ts/NonEmptyArray'\n * import { contramap } from 'fp-ts/Ord'\n * import * as S from 'fp-ts/string'\n * import * as N from 'fp-ts/number'\n * import { pipe } from 'fp-ts/function'\n *\n * interface Person {\n *   name: string\n *   age: number\n * }\n *\n * const byName = pipe(S.Ord, contramap((p: Person) => p.name))\n *\n * const byAge = pipe(N.Ord, contramap((p: Person) => p.age))\n *\n * const sortByNameByAge = NEA.sortBy([byName, byAge])\n *\n * const persons: NEA.NonEmptyArray<Person> = [\n *   { name: 'a', age: 1 },\n *   { name: 'b', age: 3 },\n *   { name: 'c', age: 2 },\n *   { name: 'b', age: 2 }\n * ]\n *\n * assert.deepStrictEqual(sortByNameByAge(persons), [\n *   { name: 'a', age: 1 },\n *   { name: 'b', age: 2 },\n *   { name: 'b', age: 3 },\n *   { name: 'c', age: 2 }\n * ])\n *\n * @category combinators\n * @since 2.11.0\n */\nexport var sortBy = function (ords) {\n    if (isNonEmpty(ords)) {\n        var M = getMonoid();\n        return sort(ords.reduce(M.concat, M.empty));\n    }\n    return copy;\n};\n/**\n * @category combinators\n * @since 2.11.0\n */\nexport var union = function (E) {\n    var uniqE = uniq(E);\n    return function (second) { return function (first) { return uniqE(pipe(first, concat(second))); }; };\n};\n/**\n * Rotate a `NonEmptyArray` by `n` steps.\n *\n * @example\n * import { rotate } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(rotate(2)([1, 2, 3, 4, 5]), [4, 5, 1, 2, 3])\n * assert.deepStrictEqual(rotate(-2)([1, 2, 3, 4, 5]), [3, 4, 5, 1, 2])\n *\n * @category combinators\n * @since 2.11.0\n */\nexport var rotate = function (n) { return function (as) {\n    var len = as.length;\n    var m = Math.round(n) % len;\n    if (isOutOfBound(Math.abs(m), as) || m === 0) {\n        return copy(as);\n    }\n    if (m < 0) {\n        var _a = splitAt(-m)(as), f = _a[0], s = _a[1];\n        return pipe(s, concat(f));\n    }\n    else {\n        return rotate(m - len)(as);\n    }\n}; };\n// -------------------------------------------------------------------------------------\n// constructors\n// -------------------------------------------------------------------------------------\n/**\n * @category constructors\n * @since 2.10.0\n */\nexport var fromReadonlyNonEmptyArray = _.fromReadonlyNonEmptyArray;\n/**\n * Builds a `NonEmptyArray` from an `Array` returning `none` if `as` is an empty array\n *\n * @category constructors\n * @since 2.0.0\n */\nexport var fromArray = function (as) { return (isNonEmpty(as) ? _.some(as) : _.none); };\n/**\n * Return a `NonEmptyArray` of length `n` with element `i` initialized with `f(i)`.\n *\n * **Note**. `n` is normalized to a natural number.\n *\n * @example\n * import { makeBy } from 'fp-ts/NonEmptyArray'\n * import { pipe } from 'fp-ts/function'\n *\n * const double = (n: number): number => n * 2\n * assert.deepStrictEqual(pipe(5, makeBy(double)), [0, 2, 4, 6, 8])\n *\n * @category constructors\n * @since 2.11.0\n */\nexport var makeBy = function (f) { return function (n) {\n    var j = Math.max(0, Math.floor(n));\n    var out = [f(0)];\n    for (var i = 1; i < j; i++) {\n        out.push(f(i));\n    }\n    return out;\n}; };\n/**\n * Create a `NonEmptyArray` containing a value repeated the specified number of times.\n *\n * **Note**. `n` is normalized to a natural number.\n *\n * @example\n * import { replicate } from 'fp-ts/NonEmptyArray'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe(3, replicate('a')), ['a', 'a', 'a'])\n *\n * @category constructors\n * @since 2.11.0\n */\nexport var replicate = function (a) { return makeBy(function () { return a; }); };\n/**\n * Create a `NonEmptyArray` containing a range of integers, including both endpoints.\n *\n * @example\n * import { range } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(range(1, 5), [1, 2, 3, 4, 5])\n *\n * @category constructors\n * @since 2.11.0\n */\nexport var range = function (start, end) {\n    return start <= end ? makeBy(function (i) { return start + i; })(end - start + 1) : [start];\n};\n// -------------------------------------------------------------------------------------\n// destructors\n// -------------------------------------------------------------------------------------\n/**\n * Return the tuple of the `head` and the `tail`.\n *\n * @example\n * import { unprepend } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(unprepend([1, 2, 3]), [1, [2, 3]])\n *\n * @category destructors\n * @since 2.9.0\n */\nexport var unprepend = function (as) { return [head(as), tail(as)]; };\n/**\n * Return the tuple of the `init` and the `last`.\n *\n * @example\n * import { unappend } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(unappend([1, 2, 3, 4]), [[1, 2, 3], 4])\n *\n * @category destructors\n * @since 2.9.0\n */\nexport var unappend = function (as) { return [init(as), last(as)]; };\nexport function concatW(second) {\n    return function (first) { return first.concat(second); };\n}\nexport function concat(x, y) {\n    return y ? x.concat(y) : function (y) { return y.concat(x); };\n}\n/**\n * @category combinators\n * @since 2.0.0\n */\nexport var reverse = function (as) { return __spreadArray([last(as)], as.slice(0, -1).reverse()); };\nexport function group(E) {\n    return function (as) {\n        var len = as.length;\n        if (len === 0) {\n            return [];\n        }\n        var out = [];\n        var head = as[0];\n        var nea = [head];\n        for (var i = 1; i < len; i++) {\n            var a = as[i];\n            if (E.equals(a, head)) {\n                nea.push(a);\n            }\n            else {\n                out.push(nea);\n                head = a;\n                nea = [head];\n            }\n        }\n        out.push(nea);\n        return out;\n    };\n}\n/**\n * Splits an array into sub-non-empty-arrays stored in an object, based on the result of calling a `string`-returning\n * function on each element, and grouping the results according to values returned\n *\n * @example\n * import { groupBy } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(groupBy((s: string) => String(s.length))(['a', 'b', 'ab']), {\n *   '1': ['a', 'b'],\n *   '2': ['ab']\n * })\n *\n * @category combinators\n * @since 2.0.0\n */\nexport var groupBy = function (f) { return function (as) {\n    var out = {};\n    for (var _i = 0, as_1 = as; _i < as_1.length; _i++) {\n        var a = as_1[_i];\n        var k = f(a);\n        if (out.hasOwnProperty(k)) {\n            out[k].push(a);\n        }\n        else {\n            out[k] = [a];\n        }\n    }\n    return out;\n}; };\n/**\n * @category combinators\n * @since 2.0.0\n */\nexport var sort = function (O) { return function (as) {\n    return as.slice().sort(O.compare);\n}; };\n/**\n * @category combinators\n * @since 2.0.0\n */\nexport var insertAt = function (i, a) { return function (as) {\n    return i < 0 || i > as.length ? _.none : _.some(unsafeInsertAt(i, a, as));\n}; };\n/**\n * @category combinators\n * @since 2.0.0\n */\nexport var updateAt = function (i, a) {\n    return modifyAt(i, function () { return a; });\n};\n/**\n * @category combinators\n * @since 2.0.0\n */\nexport var modifyAt = function (i, f) { return function (as) {\n    return isOutOfBound(i, as) ? _.none : _.some(unsafeUpdateAt(i, f(as[i]), as));\n}; };\n/**\n * @category combinators\n * @since 2.0.0\n */\nexport var copy = fromReadonlyNonEmptyArray;\n/**\n * @category Pointed\n * @since 2.0.0\n */\nexport var of = function (a) { return [a]; };\n/**\n * @category combinators\n * @since 2.5.1\n */\nexport var zipWith = function (as, bs, f) {\n    var cs = [f(as[0], bs[0])];\n    var len = Math.min(as.length, bs.length);\n    for (var i = 1; i < len; i++) {\n        cs[i] = f(as[i], bs[i]);\n    }\n    return cs;\n};\nexport function zip(as, bs) {\n    if (bs === undefined) {\n        return function (bs) { return zip(bs, as); };\n    }\n    return zipWith(as, bs, function (a, b) { return [a, b]; });\n}\n/**\n * @category combinators\n * @since 2.5.1\n */\nexport var unzip = function (abs) {\n    var fa = [abs[0][0]];\n    var fb = [abs[0][1]];\n    for (var i = 1; i < abs.length; i++) {\n        fa[i] = abs[i][0];\n        fb[i] = abs[i][1];\n    }\n    return [fa, fb];\n};\n/**\n * Prepend an element to every member of an array\n *\n * @example\n * import { prependAll } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(prependAll(9)([1, 2, 3, 4]), [9, 1, 9, 2, 9, 3, 9, 4])\n *\n * @category combinators\n * @since 2.10.0\n */\nexport var prependAll = function (middle) { return function (as) {\n    var out = [middle, as[0]];\n    for (var i = 1; i < as.length; i++) {\n        out.push(middle, as[i]);\n    }\n    return out;\n}; };\n/**\n * Places an element in between members of an array\n *\n * @example\n * import { intersperse } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(intersperse(9)([1, 2, 3, 4]), [1, 9, 2, 9, 3, 9, 4])\n *\n * @category combinators\n * @since 2.9.0\n */\nexport var intersperse = function (middle) { return function (as) {\n    var rest = tail(as);\n    return isNonEmpty(rest) ? pipe(rest, prependAll(middle), prepend(head(as))) : copy(as);\n}; };\n/**\n * @category combinators\n * @since 2.0.0\n */\nexport var foldMapWithIndex = RNEA.foldMapWithIndex;\n/**\n * @category combinators\n * @since 2.0.0\n */\nexport var foldMap = RNEA.foldMap;\n/**\n * @category combinators\n * @since 2.10.0\n */\nexport var chainWithIndex = function (f) { return function (as) {\n    var out = fromReadonlyNonEmptyArray(f(0, head(as)));\n    for (var i = 1; i < as.length; i++) {\n        out.push.apply(out, f(i, as[i]));\n    }\n    return out;\n}; };\n/**\n * @category combinators\n * @since 2.10.0\n */\nexport var chop = function (f) { return function (as) {\n    var _a = f(as), b = _a[0], rest = _a[1];\n    var out = [b];\n    var next = rest;\n    while (isNonEmpty(next)) {\n        var _b = f(next), b_1 = _b[0], rest_2 = _b[1];\n        out.push(b_1);\n        next = rest_2;\n    }\n    return out;\n}; };\n/**\n * Splits a `NonEmptyArray` into two pieces, the first piece has max `n` elements.\n *\n * @category combinators\n * @since 2.10.0\n */\nexport var splitAt = function (n) { return function (as) {\n    var m = Math.max(1, n);\n    return m >= as.length ? [copy(as), []] : [pipe(as.slice(1, m), prepend(head(as))), as.slice(m)];\n}; };\n/**\n * @category combinators\n * @since 2.10.0\n */\nexport var chunksOf = function (n) { return chop(splitAt(n)); };\n// -------------------------------------------------------------------------------------\n// non-pipeables\n// -------------------------------------------------------------------------------------\n/* istanbul ignore next */\nvar _map = function (fa, f) { return pipe(fa, map(f)); };\n/* istanbul ignore next */\nvar _mapWithIndex = function (fa, f) { return pipe(fa, mapWithIndex(f)); };\n/* istanbul ignore next */\nvar _ap = function (fab, fa) { return pipe(fab, ap(fa)); };\n/* istanbul ignore next */\nvar _chain = function (ma, f) { return pipe(ma, chain(f)); };\n/* istanbul ignore next */\nvar _extend = function (wa, f) { return pipe(wa, extend(f)); };\n/* istanbul ignore next */\nvar _reduce = function (fa, b, f) { return pipe(fa, reduce(b, f)); };\n/* istanbul ignore next */\nvar _foldMap = function (M) {\n    var foldMapM = foldMap(M);\n    return function (fa, f) { return pipe(fa, foldMapM(f)); };\n};\n/* istanbul ignore next */\nvar _reduceRight = function (fa, b, f) { return pipe(fa, reduceRight(b, f)); };\n/* istanbul ignore next */\nvar _traverse = function (F) {\n    var traverseF = traverse(F);\n    return function (ta, f) { return pipe(ta, traverseF(f)); };\n};\n/* istanbul ignore next */\nvar _alt = function (fa, that) { return pipe(fa, alt(that)); };\n/* istanbul ignore next */\nvar _reduceWithIndex = function (fa, b, f) {\n    return pipe(fa, reduceWithIndex(b, f));\n};\n/* istanbul ignore next */\nvar _foldMapWithIndex = function (M) {\n    var foldMapWithIndexM = foldMapWithIndex(M);\n    return function (fa, f) { return pipe(fa, foldMapWithIndexM(f)); };\n};\n/* istanbul ignore next */\nvar _reduceRightWithIndex = function (fa, b, f) {\n    return pipe(fa, reduceRightWithIndex(b, f));\n};\n/* istanbul ignore next */\nvar _traverseWithIndex = function (F) {\n    var traverseWithIndexF = traverseWithIndex(F);\n    return function (ta, f) { return pipe(ta, traverseWithIndexF(f)); };\n};\n// -------------------------------------------------------------------------------------\n// type class members\n// -------------------------------------------------------------------------------------\n/**\n * Less strict version of [`alt`](#alt).\n *\n * @category Alt\n * @since 2.9.0\n */\nexport var altW = function (that) { return function (as) {\n    return pipe(as, concatW(that()));\n}; };\n/**\n * Identifies an associative operation on a type constructor. It is similar to `Semigroup`, except that it applies to\n * types of kind `* -> *`.\n *\n * @category Alt\n * @since 2.6.2\n */\nexport var alt = altW;\n/**\n * Apply a function to an argument under a type constructor.\n *\n * @category Apply\n * @since 2.0.0\n */\nexport var ap = function (as) {\n    return chain(function (f) { return pipe(as, map(f)); });\n};\n/**\n * Composes computations in sequence, using the return value of one computation to determine the next computation.\n *\n * @category Monad\n * @since 2.0.0\n */\nexport var chain = function (f) {\n    return chainWithIndex(function (_, a) { return f(a); });\n};\n/**\n * @category Extend\n * @since 2.0.0\n */\nexport var extend = function (f) { return function (as) {\n    var next = tail(as);\n    var out = [f(as)];\n    while (isNonEmpty(next)) {\n        out.push(f(next));\n        next = tail(next);\n    }\n    return out;\n}; };\n/**\n * Derivable from `Extend`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexport var duplicate = \n/*#__PURE__*/\nextend(identity);\n/**\n * Derivable from `Chain`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexport var flatten = \n/*#__PURE__*/\nchain(identity);\n/**\n * `map` can be used to turn functions `(a: A) => B` into functions `(fa: F<A>) => F<B>` whose argument and return types\n * use the type constructor `F` to represent some computational context.\n *\n * @category Functor\n * @since 2.0.0\n */\nexport var map = function (f) { return mapWithIndex(function (_, a) { return f(a); }); };\n/**\n * @category FunctorWithIndex\n * @since 2.0.0\n */\nexport var mapWithIndex = function (f) { return function (as) {\n    var out = [f(0, head(as))];\n    for (var i = 1; i < as.length; i++) {\n        out.push(f(i, as[i]));\n    }\n    return out;\n}; };\n/**\n * @category Foldable\n * @since 2.0.0\n */\nexport var reduce = RNEA.reduce;\n/**\n * @category FoldableWithIndex\n * @since 2.0.0\n */\nexport var reduceWithIndex = RNEA.reduceWithIndex;\n/**\n * @category Foldable\n * @since 2.0.0\n */\nexport var reduceRight = RNEA.reduceRight;\n/**\n * @category FoldableWithIndex\n * @since 2.0.0\n */\nexport var reduceRightWithIndex = RNEA.reduceRightWithIndex;\n/**\n * @since 2.6.3\n */\nexport var traverse = function (F) {\n    var traverseWithIndexF = traverseWithIndex(F);\n    return function (f) { return traverseWithIndexF(function (_, a) { return f(a); }); };\n};\n/**\n * @since 2.6.3\n */\nexport var sequence = function (F) { return traverseWithIndex(F)(function (_, a) { return a; }); };\n/**\n * @since 2.6.3\n */\nexport var traverseWithIndex = function (F) { return function (f) { return function (as) {\n    var out = F.map(f(0, head(as)), of);\n    for (var i = 1; i < as.length; i++) {\n        out = F.ap(F.map(out, function (bs) { return function (b) { return pipe(bs, append(b)); }; }), f(i, as[i]));\n    }\n    return out;\n}; }; };\n/**\n * @since 2.7.0\n */\nexport var extract = RNEA.head;\n// -------------------------------------------------------------------------------------\n// instances\n// -------------------------------------------------------------------------------------\n/**\n * @category instances\n * @since 2.0.0\n */\nexport var URI = 'NonEmptyArray';\n/**\n * @category instances\n * @since 2.0.0\n */\nexport var getShow = RNEA.getShow;\n/**\n * Builds a `Semigroup` instance for `NonEmptyArray`\n *\n * @category instances\n * @since 2.0.0\n */\nexport var getSemigroup = function () { return ({\n    concat: concat\n}); };\n/**\n * @example\n * import { getEq } from 'fp-ts/NonEmptyArray'\n * import * as N from 'fp-ts/number'\n *\n * const E = getEq(N.Eq)\n * assert.strictEqual(E.equals([1, 2], [1, 2]), true)\n * assert.strictEqual(E.equals([1, 2], [1, 3]), false)\n *\n * @category instances\n * @since 2.0.0\n */\nexport var getEq = RNEA.getEq;\n/**\n * @category combinators\n * @since 2.11.0\n */\nexport var getUnionSemigroup = function (E) {\n    var unionE = union(E);\n    return {\n        concat: function (first, second) { return unionE(second)(first); }\n    };\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexport var Functor = {\n    URI: URI,\n    map: _map\n};\n/**\n * Derivable from `Functor`.\n *\n * @category combinators\n * @since 2.10.0\n */\nexport var flap = \n/*#__PURE__*/\nflap_(Functor);\n/**\n * @category instances\n * @since 2.10.0\n */\nexport var Pointed = {\n    URI: URI,\n    of: of\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexport var FunctorWithIndex = {\n    URI: URI,\n    map: _map,\n    mapWithIndex: _mapWithIndex\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexport var Apply = {\n    URI: URI,\n    map: _map,\n    ap: _ap\n};\n/**\n * Combine two effectful actions, keeping only the result of the first.\n *\n * Derivable from `Apply`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexport var apFirst = \n/*#__PURE__*/\napFirst_(Apply);\n/**\n * Combine two effectful actions, keeping only the result of the second.\n *\n * Derivable from `Apply`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexport var apSecond = \n/*#__PURE__*/\napSecond_(Apply);\n/**\n * @category instances\n * @since 2.7.0\n */\nexport var Applicative = {\n    URI: URI,\n    map: _map,\n    ap: _ap,\n    of: of\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexport var Chain = {\n    URI: URI,\n    map: _map,\n    ap: _ap,\n    chain: _chain\n};\n/**\n * Composes computations in sequence, using the return value of one computation to determine the next computation and\n * keeping only the result of the first.\n *\n * Derivable from `Chain`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexport var chainFirst = \n/*#__PURE__*/\nchainFirst_(Chain);\n/**\n * @category instances\n * @since 2.7.0\n */\nexport var Monad = {\n    URI: URI,\n    map: _map,\n    ap: _ap,\n    of: of,\n    chain: _chain\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexport var Foldable = {\n    URI: URI,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexport var FoldableWithIndex = {\n    URI: URI,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    reduceWithIndex: _reduceWithIndex,\n    foldMapWithIndex: _foldMapWithIndex,\n    reduceRightWithIndex: _reduceRightWithIndex\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexport var Traversable = {\n    URI: URI,\n    map: _map,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: sequence\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexport var TraversableWithIndex = {\n    URI: URI,\n    map: _map,\n    mapWithIndex: _mapWithIndex,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: sequence,\n    reduceWithIndex: _reduceWithIndex,\n    foldMapWithIndex: _foldMapWithIndex,\n    reduceRightWithIndex: _reduceRightWithIndex,\n    traverseWithIndex: _traverseWithIndex\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexport var Alt = {\n    URI: URI,\n    map: _map,\n    alt: _alt\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexport var Comonad = {\n    URI: URI,\n    map: _map,\n    extend: _extend,\n    extract: extract\n};\n// -------------------------------------------------------------------------------------\n// do notation\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.9.0\n */\nexport var Do = \n/*#__PURE__*/\nof(_.emptyRecord);\n/**\n * @since 2.8.0\n */\nexport var bindTo = \n/*#__PURE__*/\nbindTo_(Functor);\n/**\n * @since 2.8.0\n */\nexport var bind = \n/*#__PURE__*/\nbind_(Chain);\n// -------------------------------------------------------------------------------------\n// pipeable sequence S\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.8.0\n */\nexport var apS = \n/*#__PURE__*/\napS_(Apply);\n// -------------------------------------------------------------------------------------\n// utils\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.0.0\n */\nexport var head = RNEA.head;\n/**\n * @since 2.0.0\n */\nexport var tail = function (as) { return as.slice(1); };\n/**\n * @since 2.0.0\n */\nexport var last = RNEA.last;\n/**\n * Get all but the last element of a non empty array, creating a new array.\n *\n * @example\n * import { init } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(init([1, 2, 3]), [1, 2])\n * assert.deepStrictEqual(init([1]), [])\n *\n * @since 2.2.0\n */\nexport var init = function (as) { return as.slice(0, -1); };\n/**\n * @since 2.0.0\n */\nexport var min = RNEA.min;\n/**\n * @since 2.0.0\n */\nexport var max = RNEA.max;\n/**\n * @since 2.10.0\n */\nexport var concatAll = function (S) { return function (as) { return as.reduce(S.concat); }; };\n/**\n * Break an `Array` into its first element and remaining elements.\n *\n * @category destructors\n * @since 2.11.0\n */\nexport var matchLeft = function (f) { return function (as) { return f(head(as), tail(as)); }; };\n/**\n * Break an `Array` into its initial elements and the last element.\n *\n * @category destructors\n * @since 2.11.0\n */\nexport var matchRight = function (f) { return function (as) {\n    return f(init(as), last(as));\n}; };\n/**\n * Apply a function to the head, creating a new `NonEmptyArray`.\n *\n * @since 2.11.0\n */\nexport var modifyHead = function (f) { return function (as) { return __spreadArray([\n    f(head(as))\n], tail(as)); }; };\n/**\n * Change the head, creating a new `NonEmptyArray`.\n *\n * @category combinators\n * @since 2.11.0\n */\nexport var updateHead = function (a) { return modifyHead(function () { return a; }); };\n/**\n * Apply a function to the last element, creating a new `NonEmptyArray`.\n *\n * @since 2.11.0\n */\nexport var modifyLast = function (f) { return function (as) {\n    return pipe(init(as), append(f(last(as))));\n}; };\n/**\n * Change the last element, creating a new `NonEmptyArray`.\n *\n * @category combinators\n * @since 2.11.0\n */\nexport var updateLast = function (a) { return modifyLast(function () { return a; }); };\nexport function groupSort(O) {\n    var sortO = sort(O);\n    var groupO = group(O);\n    return function (as) { return (isNonEmpty(as) ? groupO(sortO(as)) : []); };\n}\nexport function filter(predicate) {\n    return filterWithIndex(function (_, a) { return predicate(a); });\n}\n/**\n * Use [`filterWithIndex`](./Array.ts.html#filterwithindex) instead.\n *\n * @category combinators\n * @since 2.0.0\n * @deprecated\n */\nexport var filterWithIndex = function (predicate) { return function (as) { return fromArray(as.filter(function (a, i) { return predicate(i, a); })); }; };\n/**\n * Use [`unprepend`](#unprepend) instead.\n *\n * @category destructors\n * @since 2.9.0\n * @deprecated\n */\nexport var uncons = unprepend;\n/**\n * Use [`unappend`](#unappend) instead.\n *\n * @category destructors\n * @since 2.9.0\n * @deprecated\n */\nexport var unsnoc = unappend;\nexport function cons(head, tail) {\n    return tail === undefined ? prepend(head) : pipe(tail, prepend(head));\n}\n/**\n * Use [`append`](./Array.ts.html#append) instead.\n *\n * @category constructors\n * @since 2.0.0\n * @deprecated\n */\nexport var snoc = function (init, end) { return pipe(init, append(end)); };\n/**\n * Use [`prependAll`](#prependall) instead.\n *\n * @category combinators\n * @since 2.9.0\n * @deprecated\n */\nexport var prependToAll = prependAll;\n/**\n * Use [`concatAll`](#concatall) instead.\n *\n * @since 2.5.0\n * @deprecated\n */\nexport var fold = RNEA.concatAll;\n/**\n * Use small, specific instances instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexport var nonEmptyArray = {\n    URI: URI,\n    of: of,\n    map: _map,\n    mapWithIndex: _mapWithIndex,\n    ap: _ap,\n    chain: _chain,\n    extend: _extend,\n    extract: extract,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: sequence,\n    reduceWithIndex: _reduceWithIndex,\n    foldMapWithIndex: _foldMapWithIndex,\n    reduceRightWithIndex: _reduceRightWithIndex,\n    traverseWithIndex: _traverseWithIndex,\n    alt: _alt\n};\n", "/**\n * @license Fraction.js v4.2.0 05/03/2022\n * https://www.xarg.org/2014/03/rational-numbers-in-javascript/\n *\n * Copyright (c) 2021, Robert Eisele (robert@xarg.org)\n * Dual licensed under the MIT or GPL Version 2 licenses.\n **/\n\n\n/**\n *\n * This class offers the possibility to calculate fractions.\n * You can pass a fraction in different formats. Either as array, as double, as string or as an integer.\n *\n * Array/Object form\n * [ 0 => <nominator>, 1 => <denominator> ]\n * [ n => <nominator>, d => <denominator> ]\n *\n * Integer form\n * - Single integer value\n *\n * Double form\n * - Single double value\n *\n * String form\n * 123.456 - a simple double\n * 123/456 - a string fraction\n * 123.'456' - a double with repeating decimal places\n * 123.(456) - synonym\n * 123.45'6' - a double with repeating last place\n * 123.45(6) - synonym\n *\n * Example:\n *\n * var f = new Fraction(\"9.4'31'\");\n * f.mul([-4, 3]).div(4.9);\n *\n */\n\n(function(root) {\n\n  \"use strict\";\n\n  // Maximum search depth for cyclic rational numbers. 2000 should be more than enough.\n  // Example: 1/7 = 0.(142857) has 6 repeating decimal places.\n  // If MAX_CYCLE_LEN gets reduced, long cycles will not be detected and toString() only gets the first 10 digits\n  var MAX_CYCLE_LEN = 2000;\n\n  // Parsed data to avoid calling \"new\" all the time\n  var P = {\n    \"s\": 1,\n    \"n\": 0,\n    \"d\": 1\n  };\n\n  function assign(n, s) {\n\n    if (isNaN(n = parseInt(n, 10))) {\n      throw Fraction['InvalidParameter'];\n    }\n    return n * s;\n  }\n\n  // Creates a new Fraction internally without the need of the bulky constructor\n  function newFraction(n, d) {\n\n    if (d === 0) {\n      throw Fraction['DivisionByZero'];\n    }\n\n    var f = Object.create(Fraction.prototype);\n    f[\"s\"] = n < 0 ? -1 : 1;\n\n    n = n < 0 ? -n : n;\n\n    var a = gcd(n, d);\n\n    f[\"n\"] = n / a;\n    f[\"d\"] = d / a;\n    return f;\n  }\n\n  function factorize(num) {\n\n    var factors = {};\n\n    var n = num;\n    var i = 2;\n    var s = 4;\n\n    while (s <= n) {\n\n      while (n % i === 0) {\n        n/= i;\n        factors[i] = (factors[i] || 0) + 1;\n      }\n      s+= 1 + 2 * i++;\n    }\n\n    if (n !== num) {\n      if (n > 1)\n        factors[n] = (factors[n] || 0) + 1;\n    } else {\n      factors[num] = (factors[num] || 0) + 1;\n    }\n    return factors;\n  }\n\n  var parse = function(p1, p2) {\n\n    var n = 0, d = 1, s = 1;\n    var v = 0, w = 0, x = 0, y = 1, z = 1;\n\n    var A = 0, B = 1;\n    var C = 1, D = 1;\n\n    var N = 10000000;\n    var M;\n\n    if (p1 === undefined || p1 === null) {\n      /* void */\n    } else if (p2 !== undefined) {\n      n = p1;\n      d = p2;\n      s = n * d;\n\n      if (n % 1 !== 0 || d % 1 !== 0) {\n        throw Fraction['NonIntegerParameter'];\n      }\n\n    } else\n      switch (typeof p1) {\n\n        case \"object\":\n          {\n            if (\"d\" in p1 && \"n\" in p1) {\n              n = p1[\"n\"];\n              d = p1[\"d\"];\n              if (\"s\" in p1)\n                n*= p1[\"s\"];\n            } else if (0 in p1) {\n              n = p1[0];\n              if (1 in p1)\n                d = p1[1];\n            } else {\n              throw Fraction['InvalidParameter'];\n            }\n            s = n * d;\n            break;\n          }\n        case \"number\":\n          {\n            if (p1 < 0) {\n              s = p1;\n              p1 = -p1;\n            }\n\n            if (p1 % 1 === 0) {\n              n = p1;\n            } else if (p1 > 0) { // check for != 0, scale would become NaN (log(0)), which converges really slow\n\n              if (p1 >= 1) {\n                z = Math.pow(10, Math.floor(1 + Math.log(p1) / Math.LN10));\n                p1/= z;\n              }\n\n              // Using Farey Sequences\n              // http://www.johndcook.com/blog/2010/10/20/best-rational-approximation/\n\n              while (B <= N && D <= N) {\n                M = (A + C) / (B + D);\n\n                if (p1 === M) {\n                  if (B + D <= N) {\n                    n = A + C;\n                    d = B + D;\n                  } else if (D > B) {\n                    n = C;\n                    d = D;\n                  } else {\n                    n = A;\n                    d = B;\n                  }\n                  break;\n\n                } else {\n\n                  if (p1 > M) {\n                    A+= C;\n                    B+= D;\n                  } else {\n                    C+= A;\n                    D+= B;\n                  }\n\n                  if (B > N) {\n                    n = C;\n                    d = D;\n                  } else {\n                    n = A;\n                    d = B;\n                  }\n                }\n              }\n              n*= z;\n            } else if (isNaN(p1) || isNaN(p2)) {\n              d = n = NaN;\n            }\n            break;\n          }\n        case \"string\":\n          {\n            B = p1.match(/\\d+|./g);\n\n            if (B === null)\n              throw Fraction['InvalidParameter'];\n\n            if (B[A] === '-') {// Check for minus sign at the beginning\n              s = -1;\n              A++;\n            } else if (B[A] === '+') {// Check for plus sign at the beginning\n              A++;\n            }\n\n            if (B.length === A + 1) { // Check if it's just a simple number \"1234\"\n              w = assign(B[A++], s);\n            } else if (B[A + 1] === '.' || B[A] === '.') { // Check if it's a decimal number\n\n              if (B[A] !== '.') { // Handle 0.5 and .5\n                v = assign(B[A++], s);\n              }\n              A++;\n\n              // Check for decimal places\n              if (A + 1 === B.length || B[A + 1] === '(' && B[A + 3] === ')' || B[A + 1] === \"'\" && B[A + 3] === \"'\") {\n                w = assign(B[A], s);\n                y = Math.pow(10, B[A].length);\n                A++;\n              }\n\n              // Check for repeating places\n              if (B[A] === '(' && B[A + 2] === ')' || B[A] === \"'\" && B[A + 2] === \"'\") {\n                x = assign(B[A + 1], s);\n                z = Math.pow(10, B[A + 1].length) - 1;\n                A+= 3;\n              }\n\n            } else if (B[A + 1] === '/' || B[A + 1] === ':') { // Check for a simple fraction \"123/456\" or \"123:456\"\n              w = assign(B[A], s);\n              y = assign(B[A + 2], 1);\n              A+= 3;\n            } else if (B[A + 3] === '/' && B[A + 1] === ' ') { // Check for a complex fraction \"123 1/2\"\n              v = assign(B[A], s);\n              w = assign(B[A + 2], s);\n              y = assign(B[A + 4], 1);\n              A+= 5;\n            }\n\n            if (B.length <= A) { // Check for more tokens on the stack\n              d = y * z;\n              s = /* void */\n              n = x + d * v + z * w;\n              break;\n            }\n\n            /* Fall through on error */\n          }\n        default:\n          throw Fraction['InvalidParameter'];\n      }\n\n    if (d === 0) {\n      throw Fraction['DivisionByZero'];\n    }\n\n    P[\"s\"] = s < 0 ? -1 : 1;\n    P[\"n\"] = Math.abs(n);\n    P[\"d\"] = Math.abs(d);\n  };\n\n  function modpow(b, e, m) {\n\n    var r = 1;\n    for (; e > 0; b = (b * b) % m, e >>= 1) {\n\n      if (e & 1) {\n        r = (r * b) % m;\n      }\n    }\n    return r;\n  }\n\n\n  function cycleLen(n, d) {\n\n    for (; d % 2 === 0;\n      d/= 2) {\n    }\n\n    for (; d % 5 === 0;\n      d/= 5) {\n    }\n\n    if (d === 1) // Catch non-cyclic numbers\n      return 0;\n\n    // If we would like to compute really large numbers quicker, we could make use of Fermat's little theorem:\n    // 10^(d-1) % d == 1\n    // However, we don't need such large numbers and MAX_CYCLE_LEN should be the capstone,\n    // as we want to translate the numbers to strings.\n\n    var rem = 10 % d;\n    var t = 1;\n\n    for (; rem !== 1; t++) {\n      rem = rem * 10 % d;\n\n      if (t > MAX_CYCLE_LEN)\n        return 0; // Returning 0 here means that we don't print it as a cyclic number. It's likely that the answer is `d-1`\n    }\n    return t;\n  }\n\n\n  function cycleStart(n, d, len) {\n\n    var rem1 = 1;\n    var rem2 = modpow(10, len, d);\n\n    for (var t = 0; t < 300; t++) { // s < ~log10(Number.MAX_VALUE)\n      // Solve 10^s == 10^(s+t) (mod d)\n\n      if (rem1 === rem2)\n        return t;\n\n      rem1 = rem1 * 10 % d;\n      rem2 = rem2 * 10 % d;\n    }\n    return 0;\n  }\n\n  function gcd(a, b) {\n\n    if (!a)\n      return b;\n    if (!b)\n      return a;\n\n    while (1) {\n      a%= b;\n      if (!a)\n        return b;\n      b%= a;\n      if (!b)\n        return a;\n    }\n  };\n\n  /**\n   * Module constructor\n   *\n   * @constructor\n   * @param {number|Fraction=} a\n   * @param {number=} b\n   */\n  function Fraction(a, b) {\n\n    parse(a, b);\n\n    if (this instanceof Fraction) {\n      a = gcd(P[\"d\"], P[\"n\"]); // Abuse variable a\n      this[\"s\"] = P[\"s\"];\n      this[\"n\"] = P[\"n\"] / a;\n      this[\"d\"] = P[\"d\"] / a;\n    } else {\n      return newFraction(P['s'] * P['n'], P['d']);\n    }\n  }\n\n  Fraction['DivisionByZero'] = new Error(\"Division by Zero\");\n  Fraction['InvalidParameter'] = new Error(\"Invalid argument\");\n  Fraction['NonIntegerParameter'] = new Error(\"Parameters must be integer\");\n\n  Fraction.prototype = {\n\n    \"s\": 1,\n    \"n\": 0,\n    \"d\": 1,\n\n    /**\n     * Calculates the absolute value\n     *\n     * Ex: new Fraction(-4).abs() => 4\n     **/\n    \"abs\": function() {\n\n      return newFraction(this[\"n\"], this[\"d\"]);\n    },\n\n    /**\n     * Inverts the sign of the current fraction\n     *\n     * Ex: new Fraction(-4).neg() => 4\n     **/\n    \"neg\": function() {\n\n      return newFraction(-this[\"s\"] * this[\"n\"], this[\"d\"]);\n    },\n\n    /**\n     * Adds two rational numbers\n     *\n     * Ex: new Fraction({n: 2, d: 3}).add(\"14.9\") => 467 / 30\n     **/\n    \"add\": function(a, b) {\n\n      parse(a, b);\n      return newFraction(\n        this[\"s\"] * this[\"n\"] * P[\"d\"] + P[\"s\"] * this[\"d\"] * P[\"n\"],\n        this[\"d\"] * P[\"d\"]\n      );\n    },\n\n    /**\n     * Subtracts two rational numbers\n     *\n     * Ex: new Fraction({n: 2, d: 3}).add(\"14.9\") => -427 / 30\n     **/\n    \"sub\": function(a, b) {\n\n      parse(a, b);\n      return newFraction(\n        this[\"s\"] * this[\"n\"] * P[\"d\"] - P[\"s\"] * this[\"d\"] * P[\"n\"],\n        this[\"d\"] * P[\"d\"]\n      );\n    },\n\n    /**\n     * Multiplies two rational numbers\n     *\n     * Ex: new Fraction(\"-17.(345)\").mul(3) => 5776 / 111\n     **/\n    \"mul\": function(a, b) {\n\n      parse(a, b);\n      return newFraction(\n        this[\"s\"] * P[\"s\"] * this[\"n\"] * P[\"n\"],\n        this[\"d\"] * P[\"d\"]\n      );\n    },\n\n    /**\n     * Divides two rational numbers\n     *\n     * Ex: new Fraction(\"-17.(345)\").inverse().div(3)\n     **/\n    \"div\": function(a, b) {\n\n      parse(a, b);\n      return newFraction(\n        this[\"s\"] * P[\"s\"] * this[\"n\"] * P[\"d\"],\n        this[\"d\"] * P[\"n\"]\n      );\n    },\n\n    /**\n     * Clones the actual object\n     *\n     * Ex: new Fraction(\"-17.(345)\").clone()\n     **/\n    \"clone\": function() {\n      return newFraction(this['s'] * this['n'], this['d']);\n    },\n\n    /**\n     * Calculates the modulo of two rational numbers - a more precise fmod\n     *\n     * Ex: new Fraction('4.(3)').mod([7, 8]) => (13/3) % (7/8) = (5/6)\n     **/\n    \"mod\": function(a, b) {\n\n      if (isNaN(this['n']) || isNaN(this['d'])) {\n        return new Fraction(NaN);\n      }\n\n      if (a === undefined) {\n        return newFraction(this[\"s\"] * this[\"n\"] % this[\"d\"], 1);\n      }\n\n      parse(a, b);\n      if (0 === P[\"n\"] && 0 === this[\"d\"]) {\n        throw Fraction['DivisionByZero'];\n      }\n\n      /*\n       * First silly attempt, kinda slow\n       *\n       return that[\"sub\"]({\n       \"n\": num[\"n\"] * Math.floor((this.n / this.d) / (num.n / num.d)),\n       \"d\": num[\"d\"],\n       \"s\": this[\"s\"]\n       });*/\n\n      /*\n       * New attempt: a1 / b1 = a2 / b2 * q + r\n       * => b2 * a1 = a2 * b1 * q + b1 * b2 * r\n       * => (b2 * a1 % a2 * b1) / (b1 * b2)\n       */\n      return newFraction(\n        this[\"s\"] * (P[\"d\"] * this[\"n\"]) % (P[\"n\"] * this[\"d\"]),\n        P[\"d\"] * this[\"d\"]\n      );\n    },\n\n    /**\n     * Calculates the fractional gcd of two rational numbers\n     *\n     * Ex: new Fraction(5,8).gcd(3,7) => 1/56\n     */\n    \"gcd\": function(a, b) {\n\n      parse(a, b);\n\n      // gcd(a / b, c / d) = gcd(a, c) / lcm(b, d)\n\n      return newFraction(gcd(P[\"n\"], this[\"n\"]) * gcd(P[\"d\"], this[\"d\"]), P[\"d\"] * this[\"d\"]);\n    },\n\n    /**\n     * Calculates the fractional lcm of two rational numbers\n     *\n     * Ex: new Fraction(5,8).lcm(3,7) => 15\n     */\n    \"lcm\": function(a, b) {\n\n      parse(a, b);\n\n      // lcm(a / b, c / d) = lcm(a, c) / gcd(b, d)\n\n      if (P[\"n\"] === 0 && this[\"n\"] === 0) {\n        return newFraction(0, 1);\n      }\n      return newFraction(P[\"n\"] * this[\"n\"], gcd(P[\"n\"], this[\"n\"]) * gcd(P[\"d\"], this[\"d\"]));\n    },\n\n    /**\n     * Calculates the ceil of a rational number\n     *\n     * Ex: new Fraction('4.(3)').ceil() => (5 / 1)\n     **/\n    \"ceil\": function(places) {\n\n      places = Math.pow(10, places || 0);\n\n      if (isNaN(this[\"n\"]) || isNaN(this[\"d\"])) {\n        return new Fraction(NaN);\n      }\n      return newFraction(Math.ceil(places * this[\"s\"] * this[\"n\"] / this[\"d\"]), places);\n    },\n\n    /**\n     * Calculates the floor of a rational number\n     *\n     * Ex: new Fraction('4.(3)').floor() => (4 / 1)\n     **/\n    \"floor\": function(places) {\n\n      places = Math.pow(10, places || 0);\n\n      if (isNaN(this[\"n\"]) || isNaN(this[\"d\"])) {\n        return new Fraction(NaN);\n      }\n      return newFraction(Math.floor(places * this[\"s\"] * this[\"n\"] / this[\"d\"]), places);\n    },\n\n    /**\n     * Rounds a rational numbers\n     *\n     * Ex: new Fraction('4.(3)').round() => (4 / 1)\n     **/\n    \"round\": function(places) {\n\n      places = Math.pow(10, places || 0);\n\n      if (isNaN(this[\"n\"]) || isNaN(this[\"d\"])) {\n        return new Fraction(NaN);\n      }\n      return newFraction(Math.round(places * this[\"s\"] * this[\"n\"] / this[\"d\"]), places);\n    },\n\n    /**\n     * Gets the inverse of the fraction, means numerator and denominator are exchanged\n     *\n     * Ex: new Fraction([-3, 4]).inverse() => -4 / 3\n     **/\n    \"inverse\": function() {\n\n      return newFraction(this[\"s\"] * this[\"d\"], this[\"n\"]);\n    },\n\n    /**\n     * Calculates the fraction to some rational exponent, if possible\n     *\n     * Ex: new Fraction(-1,2).pow(-3) => -8\n     */\n    \"pow\": function(a, b) {\n\n      parse(a, b);\n\n      // Trivial case when exp is an integer\n\n      if (P['d'] === 1) {\n\n        if (P['s'] < 0) {\n          return newFraction(Math.pow(this['s'] * this[\"d\"], P['n']), Math.pow(this[\"n\"], P['n']));\n        } else {\n          return newFraction(Math.pow(this['s'] * this[\"n\"], P['n']), Math.pow(this[\"d\"], P['n']));\n        }\n      }\n\n      // Negative roots become complex\n      //     (-a/b)^(c/d) = x\n      // <=> (-1)^(c/d) * (a/b)^(c/d) = x\n      // <=> (cos(pi) + i*sin(pi))^(c/d) * (a/b)^(c/d) = x         # rotate 1 by 180\u00B0\n      // <=> (cos(c*pi/d) + i*sin(c*pi/d)) * (a/b)^(c/d) = x       # DeMoivre's formula in Q ( https://proofwiki.org/wiki/De_Moivre%27s_Formula/Rational_Index )\n      // From which follows that only for c=0 the root is non-complex. c/d is a reduced fraction, so that sin(c/dpi)=0 occurs for d=1, which is handled by our trivial case.\n      if (this['s'] < 0) return null;\n\n      // Now prime factor n and d\n      var N = factorize(this['n']);\n      var D = factorize(this['d']);\n\n      // Exponentiate and take root for n and d individually\n      var n = 1;\n      var d = 1;\n      for (var k in N) {\n        if (k === '1') continue;\n        if (k === '0') {\n          n = 0;\n          break;\n        }\n        N[k]*= P['n'];\n\n        if (N[k] % P['d'] === 0) {\n          N[k]/= P['d'];\n        } else return null;\n        n*= Math.pow(k, N[k]);\n      }\n\n      for (var k in D) {\n        if (k === '1') continue;\n        D[k]*= P['n'];\n\n        if (D[k] % P['d'] === 0) {\n          D[k]/= P['d'];\n        } else return null;\n        d*= Math.pow(k, D[k]);\n      }\n\n      if (P['s'] < 0) {\n        return newFraction(d, n);\n      }\n      return newFraction(n, d);\n    },\n\n    /**\n     * Check if two rational numbers are the same\n     *\n     * Ex: new Fraction(19.6).equals([98, 5]);\n     **/\n    \"equals\": function(a, b) {\n\n      parse(a, b);\n      return this[\"s\"] * this[\"n\"] * P[\"d\"] === P[\"s\"] * P[\"n\"] * this[\"d\"]; // Same as compare() === 0\n    },\n\n    /**\n     * Check if two rational numbers are the same\n     *\n     * Ex: new Fraction(19.6).equals([98, 5]);\n     **/\n    \"compare\": function(a, b) {\n\n      parse(a, b);\n      var t = (this[\"s\"] * this[\"n\"] * P[\"d\"] - P[\"s\"] * P[\"n\"] * this[\"d\"]);\n      return (0 < t) - (t < 0);\n    },\n\n    \"simplify\": function(eps) {\n\n      if (isNaN(this['n']) || isNaN(this['d'])) {\n        return this;\n      }\n\n      eps = eps || 0.001;\n\n      var thisABS = this['abs']();\n      var cont = thisABS['toContinued']();\n\n      for (var i = 1; i < cont.length; i++) {\n\n        var s = newFraction(cont[i - 1], 1);\n        for (var k = i - 2; k >= 0; k--) {\n          s = s['inverse']()['add'](cont[k]);\n        }\n\n        if (s['sub'](thisABS)['abs']().valueOf() < eps) {\n          return s['mul'](this['s']);\n        }\n      }\n      return this;\n    },\n\n    /**\n     * Check if two rational numbers are divisible\n     *\n     * Ex: new Fraction(19.6).divisible(1.5);\n     */\n    \"divisible\": function(a, b) {\n\n      parse(a, b);\n      return !(!(P[\"n\"] * this[\"d\"]) || ((this[\"n\"] * P[\"d\"]) % (P[\"n\"] * this[\"d\"])));\n    },\n\n    /**\n     * Returns a decimal representation of the fraction\n     *\n     * Ex: new Fraction(\"100.'91823'\").valueOf() => 100.91823918239183\n     **/\n    'valueOf': function() {\n\n      return this[\"s\"] * this[\"n\"] / this[\"d\"];\n    },\n\n    /**\n     * Returns a string-fraction representation of a Fraction object\n     *\n     * Ex: new Fraction(\"1.'3'\").toFraction(true) => \"4 1/3\"\n     **/\n    'toFraction': function(excludeWhole) {\n\n      var whole, str = \"\";\n      var n = this[\"n\"];\n      var d = this[\"d\"];\n      if (this[\"s\"] < 0) {\n        str+= '-';\n      }\n\n      if (d === 1) {\n        str+= n;\n      } else {\n\n        if (excludeWhole && (whole = Math.floor(n / d)) > 0) {\n          str+= whole;\n          str+= \" \";\n          n%= d;\n        }\n\n        str+= n;\n        str+= '/';\n        str+= d;\n      }\n      return str;\n    },\n\n    /**\n     * Returns a latex representation of a Fraction object\n     *\n     * Ex: new Fraction(\"1.'3'\").toLatex() => \"\\frac{4}{3}\"\n     **/\n    'toLatex': function(excludeWhole) {\n\n      var whole, str = \"\";\n      var n = this[\"n\"];\n      var d = this[\"d\"];\n      if (this[\"s\"] < 0) {\n        str+= '-';\n      }\n\n      if (d === 1) {\n        str+= n;\n      } else {\n\n        if (excludeWhole && (whole = Math.floor(n / d)) > 0) {\n          str+= whole;\n          n%= d;\n        }\n\n        str+= \"\\\\frac{\";\n        str+= n;\n        str+= '}{';\n        str+= d;\n        str+= '}';\n      }\n      return str;\n    },\n\n    /**\n     * Returns an array of continued fraction elements\n     *\n     * Ex: new Fraction(\"7/8\").toContinued() => [0,1,7]\n     */\n    'toContinued': function() {\n\n      var t;\n      var a = this['n'];\n      var b = this['d'];\n      var res = [];\n\n      if (isNaN(a) || isNaN(b)) {\n        return res;\n      }\n\n      do {\n        res.push(Math.floor(a / b));\n        t = a % b;\n        a = b;\n        b = t;\n      } while (a !== 1);\n\n      return res;\n    },\n\n    /**\n     * Creates a string representation of a fraction with all digits\n     *\n     * Ex: new Fraction(\"100.'91823'\").toString() => \"100.(91823)\"\n     **/\n    'toString': function(dec) {\n\n      var N = this[\"n\"];\n      var D = this[\"d\"];\n\n      if (isNaN(N) || isNaN(D)) {\n        return \"NaN\";\n      }\n\n      dec = dec || 15; // 15 = decimal places when no repetation\n\n      var cycLen = cycleLen(N, D); // Cycle length\n      var cycOff = cycleStart(N, D, cycLen); // Cycle start\n\n      var str = this['s'] < 0 ? \"-\" : \"\";\n\n      str+= N / D | 0;\n\n      N%= D;\n      N*= 10;\n\n      if (N)\n        str+= \".\";\n\n      if (cycLen) {\n\n        for (var i = cycOff; i--;) {\n          str+= N / D | 0;\n          N%= D;\n          N*= 10;\n        }\n        str+= \"(\";\n        for (var i = cycLen; i--;) {\n          str+= N / D | 0;\n          N%= D;\n          N*= 10;\n        }\n        str+= \")\";\n      } else {\n        for (var i = dec; N && i--;) {\n          str+= N / D | 0;\n          N%= D;\n          N*= 10;\n        }\n      }\n      return str;\n    }\n  };\n\n  if (typeof define === \"function\" && define[\"amd\"]) {\n    define([], function() {\n      return Fraction;\n    });\n  } else if (typeof exports === \"object\") {\n    Object.defineProperty(Fraction, \"__esModule\", { 'value': true });\n    Fraction['default'] = Fraction;\n    Fraction['Fraction'] = Fraction;\n    module['exports'] = Fraction;\n  } else {\n    root['Fraction'] = Fraction;\n  }\n\n})(this);\n", "import Fraction from 'fraction.js'\n\nexport function radian(angle: string): number {\n  const coefficient = piCoefficient(angle)\n  const fraction = new Fraction(coefficient).valueOf()\n\n  return fraction * Math.PI\n}\n\n// TODO: neverthrow \u5316\nexport function angleDenominator(angle: string): number {\n  const coefficient = piCoefficient(angle)\n  const split = coefficient.split('/')\n\n  if (split.length === 1) {\n    return 1\n  } else if (split.length === 2) {\n    return parseInt(split[1])\n  } else {\n    throw new Error(`Failed to parse angle '${angle}'`)\n  }\n}\n\n// TODO: neverthrow \u5316\nexport function angleNumerator(angle: string): number {\n  const coefficient = piCoefficient(angle)\n  const split = coefficient.split('/')\n\n  if (split.length === 1) {\n    return parseInt(split[0])\n  } else if (split.length === 2) {\n    return parseInt(split[0])\n  } else {\n    throw new Error(`Failed to parse angle '${angle}'`)\n  }\n}\n\nexport function isAngleLessThan(angle: string, other: string): boolean {\n  return new Fraction(piCoefficient(angle)).valueOf() < new Fraction(piCoefficient(other)).valueOf()\n}\n\nexport function isAngleGreaterThan(angle: string, other: string): boolean {\n  return new Fraction(piCoefficient(angle)).valueOf() > new Fraction(piCoefficient(other)).valueOf()\n}\n\nexport function isValidAngle(angle: string): boolean {\n  if (angle === '0') return true\n  if (!/\u03C0/.test(angle)) return false\n\n  try {\n    const coefficient = piCoefficient(angle)\n    new Fraction(coefficient).valueOf()\n\n    return true\n  } catch (e) {\n    return false\n  }\n}\n\nexport function piCoefficient(angle: string): string {\n  return angle.replace(/(\\d+)\u03C0/g, '$1').replace(/\u03C0/g, '1')\n}\n\nexport function reduceAngle(angle: string): string {\n  try {\n    const coefficient = piCoefficient(angle)\n    const reduced = new Fraction(coefficient).toFraction()\n    const split = reduced.split('/')\n\n    let numerator: string\n    if (split[0] === '0') {\n      numerator = '0'\n    } else if (split[0] === '1') {\n      numerator = `\u03C0`\n    } else if (split[0] === '-1') {\n      numerator = `-\u03C0`\n    } else {\n      numerator = `${split[0]}\u03C0`\n    }\n\n    if (split.length === 1) {\n      return numerator\n    } else {\n      return `${numerator}/${split[1]}`\n    }\n  } catch (e) {\n    throw new Error(`Failed to parse angle '${angle}'`)\n  }\n}\n", "type UnicodeFraction = {character: string; ref: string; value: number}\n\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const UNICODE_FRACTIONS = [\n  {character: '\\u00BD', ref: '\u00BD', expanded: '1/2', value: 1 / 2},\n  {character: '\\u00BC', ref: '\u00BC', expanded: '1/4', value: 1 / 4},\n  {character: '\\u00BE', ref: '\u00BE', expanded: '3/4', value: 3 / 4},\n  {character: '\\u2153', ref: '\u2153', expanded: '1/3', value: 1 / 3},\n  {character: '\\u2154', ref: '\u2154', expanded: '2/3', value: 2 / 3},\n  {character: '\\u2155', ref: '\u2155', expanded: '1/5', value: 1 / 5},\n  {character: '\\u2156', ref: '\u2156', expanded: '2/5', value: 2 / 5},\n  {character: '\\u2157', ref: '\u2157', expanded: '3/5', value: 3 / 5},\n  {character: '\\u2158', ref: '\u2158', expanded: '4/5', value: 4 / 5},\n  {character: '\\u2159', ref: '\u2159', expanded: '1/6', value: 1 / 6},\n  {character: '\\u215A', ref: '\u215A', expanded: '5/6', value: 5 / 6},\n  {character: '\\u2150', ref: '\u2150', expanded: '1/7', value: 1 / 7},\n  {character: '\\u215B', ref: '\u215B', expanded: '1/8', value: 1 / 8},\n  {character: '\\u215C', ref: '\u215C', expanded: '3/8', value: 3 / 8},\n  {character: '\\u215D', ref: '\u215D', expanded: '5/8', value: 5 / 8},\n  {character: '\\u215E', ref: '\u215E', expanded: '7/8', value: 7 / 8},\n  {character: '\\u2151', ref: '\u2151', expanded: '1/9', value: 1 / 9},\n  {character: '\\u2152', ref: '\u2152', expanded: '1/10', value: 1 / 10},\n]\n\n/**\n * Stores formatting options, for determining what string output should look\n * like.\n */\nexport class Format {\n  /**\n   * Returns an approximated result, but with the constraint that when it\n   * changes slightly it should \"look the same\". (It should look good when\n   * varying and animated.)\n   */\n  static readonly CONSISTENT = new Format(false, 0, 2, ', ')\n\n  /**\n   * Returns an accurate result, but favoring looking nice over being small.\n   */\n  static readonly EXACT = new Format(true, 0, undefined, ', ')\n\n  /**\n   * Returns an accurate result, favoring being small over looking nice.\n   */\n  static readonly MINIFIED = new Format(true, 0, undefined, ',')\n\n  /**\n   * Returns an approximated result, strongly favoring looking nice.\n   */\n  static readonly SIMPLIFIED = new Format(true, 0.0005, 3, ', ')\n\n  /**\n   * Parses the given text into a float. Works for text created by\n   * [[formatFloat]].\n   */\n  static parseFloat(text: string): number {\n    if (text.length === 0) {\n      throw new Error(`Not a number: '${text}'`)\n    }\n    if (text[0] === '-') {\n      return -Format.parseFloat(text.substr(1))\n    }\n    if (text[0] === '\\u221A') {\n      return Math.sqrt(Format.parseFloat(text.substr(1)))\n    }\n\n    const fraction = Format.matchUnicodeFraction(e => e.character === text)\n    if (fraction !== undefined) {\n      return fraction.value\n    }\n\n    const result = parseFloat(text)\n    if (isNaN(result)) {\n      throw new Error(`Not a number: '${text}'`)\n    }\n    return result\n  }\n\n  /**\n   * Corrects a value to a nearby simple fraction or root thereof, such as\n   * sqrt(1/2), so it can be printed compactly.\n   *\n   * @param value  The value to round.\n   * @param epsilon  The maximum offset error introduced by the rounding.\n   */\n  static simplifyByRounding(value: number, epsilon: number): number {\n    if (value < 0) {\n      return -Format.simplifyByRounding(-value, epsilon)\n    }\n\n    const r = value % 1\n    if (r <= epsilon || 1 - r <= epsilon) {\n      return Math.round(value)\n    }\n\n    const fraction = Format.matchUnicodeFraction(e => Math.abs(e.value - value) <= epsilon)\n    if (fraction !== undefined) {\n      return fraction.value\n    }\n\n    const rootFraction = Format.matchUnicodeFraction(e => Math.abs(Math.sqrt(e.value) - value) <= epsilon)\n    if (rootFraction !== undefined) {\n      return Math.sqrt(rootFraction.value)\n    }\n\n    return value\n  }\n\n  /**\n   * Returns the first element of an array matching the given predicate, or else\n   * returns undefined.\n   *\n   * @hidden\n   */\n  static matchUnicodeFraction(predicate: (arrayItem: UnicodeFraction) => boolean): UnicodeFraction | undefined {\n    for (const each of UNICODE_FRACTIONS) {\n      if (predicate(each)) return each\n    }\n    return undefined\n  }\n\n  public allowAbbreviation: boolean\n  public maxAbbreviationError: number\n  public fixedDigits: number | undefined\n  public itemSeparator: string\n\n  /**\n   * @param allowAbbreviation  Should outputs be shortened, if possible?\n   * @param maxAbbreviationError  How much error is abbreviating allowed to introduce?\n   * @param fixedDigits  Use toFixed? How many digits?\n   * @param itemSeparator  What should list items be separated by?\n   */\n  constructor(\n    allowAbbreviation: boolean,\n    maxAbbreviationError: number,\n    fixedDigits: number | undefined,\n    itemSeparator: string,\n  ) {\n    this.allowAbbreviation = allowAbbreviation\n    this.maxAbbreviationError = maxAbbreviationError\n    this.fixedDigits = fixedDigits\n    this.itemSeparator = itemSeparator\n  }\n\n  formatFloat(f: number): string {\n    if (this.allowAbbreviation) {\n      return this.abbreviateFloat(f, this.maxAbbreviationError, this.fixedDigits)\n    }\n    if (this.fixedDigits !== undefined) {\n      return f.toFixed(this.fixedDigits)\n    }\n    return String(f)\n  }\n\n  /**\n   * Returns a string representation of a float, taking advantage of unicode\n   * fractions and square roots.\n   *\n   * @param value  The value to represent as a string.\n   * @param epsilon  The maximum error introduced by using an expression.\n   * @param digits  digits The number of digits to use if no expression matches.\n   */\n  private abbreviateFloat(value: number, epsilon = 0, digits: number | undefined = undefined): string {\n    if (Math.abs(value) < epsilon) return '0'\n    if (value < 0) return `-${this.abbreviateFloat(-value, epsilon, digits)}`\n\n    const fraction = Format.matchUnicodeFraction(e => Math.abs(e.value - value) <= epsilon)\n    if (fraction !== undefined) {\n      return fraction.character\n    }\n\n    const rootFraction = Format.matchUnicodeFraction(e => Math.abs(Math.sqrt(e.value) - value) <= epsilon)\n    if (rootFraction !== undefined) {\n      return `\\u221A${rootFraction.character}`\n    }\n\n    if (value % 1 !== 0 && digits !== undefined) {\n      return value.toFixed(digits)\n    }\n\n    return value.toString()\n  }\n}\n", "import {UNICODE_FRACTIONS} from './format'\n\ntype UnicodeFraction = {character: string; ref: string; value: number}\n\nexport class NumberFormatter {\n  public allowAbbreviation: boolean\n  public maxAbbreviationError: number\n  public fixedDigits: number | undefined\n  public itemSeparator: string\n\n  static matchUnicodeFraction(predicate: (arrayItem: UnicodeFraction) => boolean): UnicodeFraction | undefined {\n    for (const each of UNICODE_FRACTIONS) {\n      if (predicate(each)) return each\n    }\n    return undefined\n  }\n\n  constructor(\n    allowAbbreviation: boolean,\n    maxAbbreviationError: number,\n    fixedDigits: number | undefined,\n    itemSeparator = ', ',\n  ) {\n    this.allowAbbreviation = allowAbbreviation\n    this.maxAbbreviationError = maxAbbreviationError\n    this.fixedDigits = fixedDigits\n    this.itemSeparator = itemSeparator\n  }\n\n  format(n: number): string {\n    if (this.allowAbbreviation) {\n      return this.abbreviateNumber(n, this.maxAbbreviationError, this.fixedDigits)\n    }\n    if (this.fixedDigits !== undefined) {\n      return n.toFixed(this.fixedDigits)\n    }\n    return String(n)\n  }\n\n  private abbreviateNumber(value: number, epsilon = 0, digits: number | undefined = undefined): string {\n    if (Math.abs(value) < epsilon) return '0'\n    if (value < 0) return `-${this.abbreviateNumber(-value, epsilon, digits)}`\n\n    const fraction = NumberFormatter.matchUnicodeFraction(e => Math.abs(e.value - value) <= epsilon)\n    if (fraction !== undefined) {\n      return fraction.character\n    }\n\n    const rootFraction = NumberFormatter.matchUnicodeFraction(e => Math.abs(Math.sqrt(e.value) - value) <= epsilon)\n    if (rootFraction !== undefined) {\n      return `\\u221A${rootFraction.character}`\n    }\n\n    if (value % 1 !== 0 && digits !== undefined) {\n      return value.toFixed(digits)\n    }\n\n    return value.toString()\n  }\n}\n", "import {NumberFormatter} from './number-formatter'\nimport {ok, err, Result} from 'neverthrow'\n\ntype FormatOptions = {\n  allowAbbreviation?: boolean\n  maxAbbreviationError?: number\n  fixedDigits?: number | undefined\n}\n\nconst DEFAULT_FORMAT_OPTIONS = {\n  allowAbbreviation: true,\n  maxAbbreviationError: 0,\n  fixedDigits: undefined,\n}\n\nexport class Complex {\n  /**\n   * Complex { real: 0, imag: 0 }\n   */\n  static readonly ZERO = new Complex(0, 0)\n  /**\n   * Complex { real: 1, imag: 0 }\n   */\n  static readonly ONE = new Complex(1, 0)\n  /**\n   * The imaginary unit.\n   */\n  static readonly I = new Complex(0, 1)\n\n  /**\n   * The real part of the Complex number.\n   */\n  public real: number\n  /**\n   * The imaginary part of the Complex number.\n   */\n  public imag: number\n\n  /**\n   * Converts the given value to a Complex value.\n   *\n   * @param value - The value to convert to a Complex value\n   */\n  static from(value: number | Complex): Complex {\n    if (typeof value === 'number') {\n      return new Complex(value, 0)\n    }\n\n    return value\n  }\n\n  /**\n   * Returns the real part of a Complex or a number value.\n   *\n   * @param value - The value to get the real part of\n   */\n  static real(value: number | Complex): number {\n    if (typeof value === 'number') {\n      return value\n    }\n\n    return value.real\n  }\n\n  /**\n   * Returns the imaginary part of a Complex value, or else 0 for number values.\n   *\n   * @param value - The value to get the imaginary part of\n   */\n  static imag(value: number | Complex): number {\n    if (typeof value === 'number') {\n      return 0\n    }\n\n    return value.imag\n  }\n\n  /**\n   * Returns a new Complex number with the given magnitude and phase.\n   *\n   * @param magnitude - The magnitude of the Complex number\n   * @param phase - The phase of the Complex number\n   */\n  static polar(magnitude: number, phase: number): Complex {\n    const [cos, sin] = this.cosAndSin(phase)\n\n    return new Complex(magnitude * cos, magnitude * sin)\n  }\n\n  private static cosAndSin(radians: number): number[] {\n    const unit = Math.PI / 4\n    const i = Math.round(radians / unit)\n    if (i * unit === radians) {\n      const s = Math.sqrt(0.5)\n      const snaps = [\n        [1, 0], // 0\n        [s, s], // \u03C0/4\n        [0, 1], // \u03C0/2\n        [-s, s], // 3\u03C0/4\n        [-1, 0], // \u03C0\n        [-s, -s], // 5\u03C0/4\n        [0, -1], // 3\u03C0/2\n        [s, -s], // 7\u03C0/4\n      ]\n      return snaps[i & 7]\n    }\n    return [Math.cos(radians), Math.sin(radians)]\n  }\n\n  /**\n   * @param real - The real part of the Complex number\n   * @param imag - The imaginary part of the Complex number\n   */\n  constructor(real: number, imag: number) {\n    this.real = real\n    this.imag = imag\n\n    this.isApproximatelyEqualTo = this.nearlyEq // alias for nearlyEq\n    this.isEqualTo = this.eq // alias for eq\n    this.conj = this.conjugate // alias for conjugate\n    this.plus = this.add // alias for add\n    // aliases for sub\n    this.subtract = this.sub\n    this.minus = this.sub\n    // aliases for mult\n    this.multiply = this.mult\n    this.times = this.mult\n    this.dividedBy = this.div // alias for div\n    this.magnitude = this.abs // alias for abs\n    this.norm2 = this.abs2 // alias for abs2\n    // aliases for arg\n    this.angle = this.arg\n    this.phase = this.arg\n  }\n\n  /**\n   * Returns true if complex number is equal to other.\n   *\n   * @param other - The other value to compare with\n   */\n  eq(other: unknown): boolean {\n    if (typeof other === 'number') {\n      return this.real === other && this.imag === 0\n    }\n    if (other instanceof Complex) {\n      return this.real === other.real && this.imag === other.imag\n    }\n    return false\n  }\n\n  isEqualTo = this.eq.bind(this)\n\n  /**\n   * Returns true if the Complex number is close to the value of other.\n   *\n   * @param other - The other value to compare with\n   */\n  nearlyEq(other: number | Complex | unknown, epsilon: number): boolean {\n    if (typeof other === 'number' || other instanceof Complex) {\n      const d = this.sub(Complex.from(other))\n      return Math.abs(d.real) <= epsilon && Math.abs(d.imag) <= epsilon && d.abs() <= epsilon\n    }\n    return false\n  }\n\n  isApproximatelyEqualTo = this.nearlyEq.bind(this)\n\n  /**\n   * Returns the complex conjugate.\n   *\n   * @returns A new Complex representing the complex conjugate of this complex number\n   */\n  conjugate(): Complex {\n    return new Complex(this.real, -this.imag)\n  }\n\n  conj = this.conjugate.bind(this)\n\n  /**\n   * Returns negation of the value.\n   *\n   * @returns A new Complex representing the negation of this complex number.\n   */\n  neg(): Complex {\n    return new Complex(-this.real, -this.imag)\n  }\n\n  /**\n   * Returns the sum of this complex number and value.\n   *\n   * @param value - The addend number.\n   * @returns A new Complex representing the sum of this complex number and value.\n   */\n  add(value: number | Complex): Complex {\n    const c = Complex.from(value)\n\n    return new Complex(this.real + c.real, this.imag + c.imag)\n  }\n\n  plus = this.add.bind(this)\n\n  /**\n   * Returns the subtraction of this complex number and value.\n   *\n   * @param value - The subtrahend number.\n   * @returns A new Complex representing the subtraction of this complex number and value.\n   */\n  sub(value: number | Complex): Complex {\n    const c = Complex.from(value)\n\n    return new Complex(this.real - c.real, this.imag - c.imag)\n  }\n\n  subtract = this.sub.bind(this)\n  minus = this.sub.bind(this)\n\n  /**\n   * Returns the product of this complex number and value.\n   *\n   * @param value - The multiplier number.\n   * @returns A new Complex representing the product of this complex number and value.\n   */\n  mult(value: number | Complex): Complex {\n    const c = Complex.from(value)\n\n    return new Complex(this.real * c.real - this.imag * c.imag, this.real * c.imag + this.imag * c.real)\n  }\n\n  multiply = this.mult.bind(this)\n  times = this.mult.bind(this)\n\n  /**\n   * Returns a complex number divided by value.\n   * If value is zero, returns an error.\n   *\n   * @param value - The divisor number.\n   * @returns A Result object with the result of division or a division-by-zero error.\n   * @example\n   * ```\n   * const res = new Complex(2, 3).div(2)\n   * if (res.isOk()) {\n   *   console.log(res.value) // Complex { real: 1, imag: 1.5 }\n   * } else {\n   *   console.error(res.error)\n   * }\n   * ```\n   */\n  div(value: number | Complex): Result<Complex, Error> {\n    const c = Complex.from(value)\n    const d = c.abs2()\n    if (d === 0) {\n      return err(Error('Division by Zero'))\n    }\n\n    const n = this.mult(c.conjugate())\n    return ok(new Complex(n.real / d, n.imag / d))\n  }\n\n  dividedBy = this.div.bind(this)\n\n  /**\n   * Returns the absolute part of its polar form.\n   *\n   * @returns A number representing the absolute part of its polar form.\n   * @example\n   * ```\n   * new Complex(-1, 0).abs() // 1\n   * new Complex(3, 4).abs() // 5\n   * ```\n   */\n  abs(): number {\n    return Math.sqrt(this.abs2())\n  }\n\n  magnitude = this.abs.bind(this)\n\n  /**\n   * Returns square of the absolute value.\n   *\n   * @returns A number representing the square of the absolute value.\n   * @example\n   * ```\n   * new Complex(-1, 0).abs2() // 1\n   * new Complex(3, 4).abs2() // 25\n   * ```\n   */\n  abs2(): number {\n    return this.real * this.real + this.imag * this.imag\n  }\n\n  norm2 = this.abs2.bind(this)\n\n  /**\n   * Returns the angle part of its polar form.\n   *\n   * @returns A number representing the angle part of its polar form in radians.\n   */\n  arg(): number {\n    return Math.atan2(this.imag, this.real)\n  }\n\n  angle = this.arg.bind(this)\n  phase = this.arg.bind(this)\n\n  /**\n   * Returns the exponentiation of a complex number. That is c.pow(x) = c^x.\n   *\n   * @param exponent - the exponent number\n   * @returns A number representing base taken to the power of exponent\n   */\n  pow(exponent: number | Complex): Complex {\n    if (exponent === 0.5 && this.imag === 0 && this.real >= 0) {\n      return new Complex(Math.sqrt(this.real), 0)\n    }\n    if (this.eq(Complex.ZERO)) {\n      return Complex.ZERO\n    }\n    return this.ln().mult(Complex.from(exponent)).exp()\n  }\n\n  /**\n   * Returns e raised to the c power. That is c.exp() = e^c.\n   */\n  exp(): Complex {\n    return Complex.polar(Math.exp(this.real), this.imag)\n  }\n\n  /**\n   * Returns a string representing this complex number according to the specified format.\n   *\n   * @param options - An object that sets the format options for this complex number.\n   * @returns A string representing this complex number.\n   * @example\n   * ```\n   * new Complex(1, 2).format() // '1+2i'\n   * new Complex(1, 2).format({\n   *   allowAbbreviation: false,\n   *   fixedDigits: 2,\n   * }) // '+1.00+2.00i'\n   * ```\n   */\n  format(options: FormatOptions = DEFAULT_FORMAT_OPTIONS): string {\n    const format = new NumberFormatter(\n      options.allowAbbreviation === undefined ? DEFAULT_FORMAT_OPTIONS.allowAbbreviation : options.allowAbbreviation,\n      options.maxAbbreviationError || 0,\n      options.fixedDigits,\n    )\n    return format.allowAbbreviation ? this.toStringAllowSingleValue(format) : this.toStringBothValues(format)\n  }\n\n  /**\n   * Returns a compact string representing this Complex number.\n   *\n   * @returns A string representing this complex number.\n   * @example\n   * ```\n   * new Complex(1, 2).toString() // '1+2i'\n   * new Complex(Math.sqrt(1 / 2), -1 / 3).toString() // '\u221A\u00BD-\u2153i'\n   * ```\n   */\n  toString(): string {\n    const formatter = new NumberFormatter(\n      DEFAULT_FORMAT_OPTIONS.allowAbbreviation,\n      DEFAULT_FORMAT_OPTIONS.maxAbbreviationError,\n      DEFAULT_FORMAT_OPTIONS.fixedDigits,\n    )\n    return this.toStringAllowSingleValue(formatter)\n  }\n\n  // log(c) = ln|c| + arg(c)i\n  private ln(): Complex {\n    return new Complex(Math.log(this.abs()), this.arg())\n  }\n\n  // If a complex number has only real or imaginary parts,\n  // convert it to a string with only real or imaginary parts, such as '\u2153' or '-3i'.\n  private toStringAllowSingleValue(formatter: NumberFormatter): string {\n    if (this.canImagPartBeOmitted(formatter.maxAbbreviationError)) {\n      return formatter.format(this.real)\n    }\n\n    if (this.canRealPartBeOmitted(formatter.maxAbbreviationError)) {\n      let imagFactor\n\n      if (this.isImagFactorCloseToOne(formatter.maxAbbreviationError)) {\n        imagFactor = ''\n      } else if (this.isImagFactorMinusOne(formatter.maxAbbreviationError)) {\n        imagFactor = '-'\n      } else {\n        imagFactor = formatter.format(this.imag)\n      }\n\n      return `${imagFactor}i`\n    }\n\n    return this.toStringBothValues(formatter)\n  }\n\n  // Convert a complex number whose real and imaginary parts are not both zero into a string like '\u2153-3i'.\n  private toStringBothValues(formatter: NumberFormatter): string {\n    const imagSign = this.imag >= 0 ? '+' : '-'\n    const imagFactor = this.canImagFactorBeOmitted(formatter) ? '' : formatter.format(Math.abs(this.imag))\n    const realPlusSign = formatter.allowAbbreviation || formatter.fixedDigits === undefined || this.real < 0 ? '' : '+'\n\n    return `${realPlusSign + formatter.format(this.real) + imagSign + imagFactor}i`\n  }\n\n  // Returns whether the real part of a complex number can be omitted.\n  private canRealPartBeOmitted(maxAbbreviationError: number): boolean {\n    return Math.abs(this.real) <= maxAbbreviationError\n  }\n\n  // Returns whether the imaginary part of a complex number can be omitted.\n  private canImagPartBeOmitted(maxAbbreviationError: number): boolean {\n    return Math.abs(this.imag) <= maxAbbreviationError\n  }\n\n  // Returns whether the imaginary part of a complex number is close to 1.\n  private isImagFactorCloseToOne(maxAbbreviationError: number): boolean {\n    return Math.abs(this.imag - 1) <= maxAbbreviationError\n  }\n\n  // Returns whether the imaginary part of a complex number is close to -1.\n  private isImagFactorMinusOne(maxAbbreviationError: number): boolean {\n    return Math.abs(this.imag + 1) <= maxAbbreviationError\n  }\n\n  // Returns true if the factor of the imaginary part can be omitted, such as i or -i.\n  private canImagFactorBeOmitted(formatter: NumberFormatter): boolean {\n    return formatter.allowAbbreviation && Math.abs(Math.abs(this.imag) - 1) <= formatter.maxAbbreviationError\n  }\n}\n", "export const Config = {\n  MAX_QUBIT_COUNT: 16,\n} as const\n", "/**\n * Emit a custom event\n *\n * @param type    The event type\n * @param detail  Any details to pass along with the event\n * @param element The element to attach the event to\n */\nexport function emitEvent(type: string, detail = {}, element: Node = document): boolean {\n  const event = new CustomEvent(type, {\n    bubbles: true,\n    cancelable: true,\n    detail,\n  })\n\n  return element.dispatchEvent(event)\n}\n", "import {Config} from './config'\n\nexport type CreateArrayWithLengthX<LENGTH extends number, ACC extends unknown[] = []> = ACC['length'] extends LENGTH\n  ? ACC\n  : CreateArrayWithLengthX<LENGTH, [...ACC, 1]>\n\nexport type NumericRange<\n  START_ARR extends number[],\n  END extends number,\n  ACC extends number = never,\n> = START_ARR['length'] extends END ? ACC | END : NumericRange<[...START_ARR, 1], END, ACC | START_ARR['length']>\n\nexport type ResizeableSpan = NumericRange<CreateArrayWithLengthX<1>, typeof Config.MAX_QUBIT_COUNT>\n\nexport const isResizeableSpan = (arg: unknown): arg is ResizeableSpan =>\n  typeof arg == 'number' && 1 <= arg && arg <= Config.MAX_QUBIT_COUNT\n", "/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Result} from 'neverthrow'\n\ntype ParseError = {message: string}\nconst toParseError = (): ParseError => ({message: 'Parse Error'})\n\nexport class Util {\n  static need(expression: boolean, message: string, args?: unknown[]): asserts expression {\n    if (expression !== true) {\n      const argDesc = args === undefined ? '(not provided)' : `[${Array.prototype.slice.call(args).join(', ')}]`\n      const msgDesc = message === undefined ? '(not provided)' : message\n      const msg = `Precondition failed\\n\\nMessage: ${msgDesc}\\n\\nArgs: ${argDesc}`\n      throw new Error(msg)\n    }\n  }\n\n  static notNull<T>(v: T): asserts v is NonNullable<T> {\n    Util.need(v !== null && v !== undefined, 'notNull')\n  }\n\n  // \u73FE\u5728\u306E URL \u3092\u30D1\u30FC\u30B9\u3057\u3001\u6700\u5F8C\u306E / \u4EE5\u964D\u3092\u30C7\u30B3\u30FC\u30C9\u3057\u305F\u3082\u306E\u3092\u8FD4\u3059\n  static get urlJson(): string {\n    const url = new URL(location.href, window.location.origin)\n    const path = decodeURIComponent(url.pathname)\n    const lastSlashIndex = path.lastIndexOf('/')\n\n    return path.substring(lastSlashIndex + 1)\n  }\n\n  static safeJsonParse = Result.fromThrowable(JSON.parse, toParseError)\n}\n", "export const SerializedAntiControlGateType = '\u25E6'\n\nexport type SerializedAntiControlGate = {\n  type: typeof SerializedAntiControlGateType\n  targets: number[]\n}\n", "export const SerializedBlochDisplayType = 'Bloch'\n\nexport type SerializedBlochDisplay = {\n  type: typeof SerializedBlochDisplayType\n  targets: number[]\n}\n", "export const SerializedControlGateType = '\u2022'\n\nexport type SerializedControlGate = {\n  type: typeof SerializedControlGateType\n  targets: number[]\n}\n", "export const SerializedHGateType = 'H'\n\nexport type SerializedHGate = {\n  type: typeof SerializedHGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedMeasurementGateType = 'Measure'\n\nexport type SerializedMeasurementGate = {\n  type: typeof SerializedMeasurementGateType\n  targets: number[]\n  flag?: string\n}\n", "export const SerializedPhaseGateType = 'P'\n\nexport type SerializedPhaseGate = {\n  type: typeof SerializedPhaseGateType\n  angle?: string\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "import {ResizeableSpan} from './numeric-range'\n\nexport const SerializedQftDaggerGateType = 'QFT\u2020'\n\nexport type SerializedQftDaggerGate = {\n  type: typeof SerializedQftDaggerGateType\n  span: ResizeableSpan\n  targets: number[]\n}\n", "import {ResizeableSpan} from './numeric-range'\n\nexport const SerializedQftGateType = 'QFT'\n\nexport type SerializedQftGate = {\n  type: typeof SerializedQftGateType\n  span: ResizeableSpan\n  targets: number[]\n}\n", "export const SerializedRnotGateType = 'X^\u00BD'\n\nexport type SerializedRnotGate = {\n  type: typeof SerializedRnotGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedRxGateType = 'Rx'\n\nexport type SerializedRxGate = {\n  type: typeof SerializedRxGateType\n  targets: number[]\n  angle?: string\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedRyGateType = 'Ry'\n\nexport type SerializedRyGate = {\n  type: typeof SerializedRyGateType\n  targets: number[]\n  angle?: string\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedRzGateType = 'Rz'\n\nexport type SerializedRzGate = {\n  type: typeof SerializedRzGateType\n  targets: number[]\n  angle?: string\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedSDaggerGateType = 'S\u2020'\n\nexport type SerializedSDaggerGate = {\n  type: typeof SerializedSDaggerGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedSGateType = 'S'\n\nexport type SerializedSGate = {\n  type: typeof SerializedSGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedSpacerGateType = '\u2026'\n\nexport type SerializedSpacerGate = {\n  type: typeof SerializedSpacerGateType\n  targets: number[]\n}\n", "export const SerializedSwapGateType = 'Swap'\n\nexport type SerializedSwapGate = {\n  type: typeof SerializedSwapGateType\n  targets: [number, number]\n  controls?: number[]\n  antiControls?: number[]\n}\n", "export const SerializedTDaggerGateType = 'T\u2020'\n\nexport type SerializedTDaggerGate = {\n  type: typeof SerializedTDaggerGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedTGateType = 'T'\n\nexport type SerializedTGate = {\n  type: typeof SerializedTGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedWrite0GateType = '|0>'\nexport const SerializedWrite1GateType = '|1>'\n\nexport type SerializedWriteGate = {\n  type: typeof SerializedWrite0GateType | typeof SerializedWrite1GateType\n  targets: number[]\n}\n", "export const SerializedXGateType = 'X'\n\nexport type SerializedXGate = {\n  type: typeof SerializedXGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedYGateType = 'Y'\n\nexport type SerializedYGate = {\n  type: typeof SerializedYGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedZGateType = 'Z'\n\nexport type SerializedZGate = {\n  type: typeof SerializedZGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nfunction __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nfunction __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nfunction __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\n\nvar defaultErrorConfig = {\r\n    withStackTrace: false\r\n};\r\n// Custom error object\r\n// Context / discussion: https://github.com/supermacro/neverthrow/pull/215\r\nvar createNeverThrowError = function (message, result, config) {\r\n    if (config === void 0) { config = defaultErrorConfig; }\r\n    var data = result.isOk()\r\n        ? { type: 'Ok', value: result.value }\r\n        : { type: 'Err', value: result.error };\r\n    var maybeStack = config.withStackTrace ? new Error().stack : undefined;\r\n    return {\r\n        data: data,\r\n        message: message,\r\n        stack: maybeStack\r\n    };\r\n};\n\nvar ResultAsync = /** @class */ (function () {\r\n    function ResultAsync(res) {\r\n        this._promise = res;\r\n    }\r\n    ResultAsync.fromSafePromise = function (promise) {\r\n        var newPromise = promise.then(function (value) { return new Ok(value); });\r\n        return new ResultAsync(newPromise);\r\n    };\r\n    ResultAsync.fromPromise = function (promise, errorFn) {\r\n        var newPromise = promise\r\n            .then(function (value) { return new Ok(value); })[\"catch\"](function (e) { return new Err(errorFn(e)); });\r\n        return new ResultAsync(newPromise);\r\n    };\r\n    ResultAsync.combine = function (asyncResultList) {\r\n        return combineResultAsyncList(asyncResultList);\r\n    };\r\n    ResultAsync.combineWithAllErrors = function (asyncResultList) {\r\n        return combineResultAsyncListWithAllErrors(asyncResultList);\r\n    };\r\n    ResultAsync.prototype.map = function (f) {\r\n        var _this = this;\r\n        return new ResultAsync(this._promise.then(function (res) { return __awaiter(_this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (res.isErr()) {\r\n                            return [2 /*return*/, new Err(res.error)];\r\n                        }\r\n                        _a = Ok.bind;\r\n                        return [4 /*yield*/, f(res.value)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(Ok, [void 0, _b.sent()]))()];\r\n                }\r\n            });\r\n        }); }));\r\n    };\r\n    ResultAsync.prototype.mapErr = function (f) {\r\n        var _this = this;\r\n        return new ResultAsync(this._promise.then(function (res) { return __awaiter(_this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (res.isOk()) {\r\n                            return [2 /*return*/, new Ok(res.value)];\r\n                        }\r\n                        _a = Err.bind;\r\n                        return [4 /*yield*/, f(res.error)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(Err, [void 0, _b.sent()]))()];\r\n                }\r\n            });\r\n        }); }));\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\r\n    ResultAsync.prototype.andThen = function (f) {\r\n        return new ResultAsync(this._promise.then(function (res) {\r\n            if (res.isErr()) {\r\n                return new Err(res.error);\r\n            }\r\n            var newValue = f(res.value);\r\n            return newValue instanceof ResultAsync ? newValue._promise : newValue;\r\n        }));\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\r\n    ResultAsync.prototype.orElse = function (f) {\r\n        var _this = this;\r\n        return new ResultAsync(this._promise.then(function (res) { return __awaiter(_this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                if (res.isErr()) {\r\n                    return [2 /*return*/, f(res.error)];\r\n                }\r\n                return [2 /*return*/, new Ok(res.value)];\r\n            });\r\n        }); }));\r\n    };\r\n    ResultAsync.prototype.match = function (ok, _err) {\r\n        return this._promise.then(function (res) { return res.match(ok, _err); });\r\n    };\r\n    ResultAsync.prototype.unwrapOr = function (t) {\r\n        return this._promise.then(function (res) { return res.unwrapOr(t); });\r\n    };\r\n    // Makes ResultAsync implement PromiseLike<Result>\r\n    ResultAsync.prototype.then = function (successCallback, failureCallback) {\r\n        return this._promise.then(successCallback, failureCallback);\r\n    };\r\n    return ResultAsync;\r\n}());\r\nvar okAsync = function (value) {\r\n    return new ResultAsync(Promise.resolve(new Ok(value)));\r\n};\r\nvar errAsync = function (err) {\r\n    return new ResultAsync(Promise.resolve(new Err(err)));\r\n};\r\nvar fromPromise = ResultAsync.fromPromise;\r\nvar fromSafePromise = ResultAsync.fromSafePromise;\n\nvar appendValueToEndOfList = function (value) { return function (list) { return __spreadArray(__spreadArray([], __read(list), false), [value], false); }; };\r\n/**\r\n * Short circuits on the FIRST Err value that we find\r\n */\r\nvar combineResultList = function (resultList) {\r\n    return resultList.reduce(function (acc, result) {\r\n        return acc.isOk()\r\n            ? result.isErr()\r\n                ? err(result.error)\r\n                : acc.map(appendValueToEndOfList(result.value))\r\n            : acc;\r\n    }, ok([]));\r\n};\r\n/* This is the typesafe version of Promise.all\r\n *\r\n * Takes a list of ResultAsync<T, E> and success if all inner results are Ok values\r\n * or fails if one (or more) of the inner results are Err values\r\n */\r\nvar combineResultAsyncList = function (asyncResultList) {\r\n    return ResultAsync.fromSafePromise(Promise.all(asyncResultList)).andThen(combineResultList);\r\n};\r\n/**\r\n * Give a list of all the errors we find\r\n */\r\nvar combineResultListWithAllErrors = function (resultList) {\r\n    return resultList.reduce(function (acc, result) {\r\n        return result.isErr()\r\n            ? acc.isErr()\r\n                ? err(__spreadArray(__spreadArray([], __read(acc.error), false), [result.error], false))\r\n                : err([result.error])\r\n            : acc.isErr()\r\n                ? acc\r\n                : ok(__spreadArray(__spreadArray([], __read(acc.value), false), [result.value], false));\r\n    }, ok([]));\r\n};\r\nvar combineResultAsyncListWithAllErrors = function (asyncResultList) {\r\n    return ResultAsync.fromSafePromise(Promise.all(asyncResultList)).andThen(combineResultListWithAllErrors);\r\n};\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\r\nvar Result;\r\n(function (Result) {\r\n    /**\r\n     * Wraps a function with a try catch, creating a new function with the same\r\n     * arguments but returning `Ok` if successful, `Err` if the function throws\r\n     *\r\n     * @param fn function to wrap with ok on success or err on failure\r\n     * @param errorFn when an error is thrown, this will wrap the error result if provided\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    function fromThrowable(fn, errorFn) {\r\n        return function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            try {\r\n                var result = fn.apply(void 0, __spreadArray([], __read(args), false));\r\n                return ok(result);\r\n            }\r\n            catch (e) {\r\n                return err(errorFn ? errorFn(e) : e);\r\n            }\r\n        };\r\n    }\r\n    Result.fromThrowable = fromThrowable;\r\n    function combine(resultList) {\r\n        return combineResultList(resultList);\r\n    }\r\n    Result.combine = combine;\r\n    function combineWithAllErrors(resultList) {\r\n        return combineResultListWithAllErrors(resultList);\r\n    }\r\n    Result.combineWithAllErrors = combineWithAllErrors;\r\n})(Result || (Result = {}));\r\nvar ok = function (value) { return new Ok(value); };\r\nvar err = function (err) { return new Err(err); };\r\nvar Ok = /** @class */ (function () {\r\n    function Ok(value) {\r\n        this.value = value;\r\n    }\r\n    Ok.prototype.isOk = function () {\r\n        return true;\r\n    };\r\n    Ok.prototype.isErr = function () {\r\n        return !this.isOk();\r\n    };\r\n    Ok.prototype.map = function (f) {\r\n        return ok(f(this.value));\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    Ok.prototype.mapErr = function (_f) {\r\n        return ok(this.value);\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\r\n    Ok.prototype.andThen = function (f) {\r\n        return f(this.value);\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\r\n    Ok.prototype.orElse = function (_f) {\r\n        return ok(this.value);\r\n    };\r\n    Ok.prototype.asyncAndThen = function (f) {\r\n        return f(this.value);\r\n    };\r\n    Ok.prototype.asyncMap = function (f) {\r\n        return ResultAsync.fromSafePromise(f(this.value));\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    Ok.prototype.unwrapOr = function (_v) {\r\n        return this.value;\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    Ok.prototype.match = function (ok, _err) {\r\n        return ok(this.value);\r\n    };\r\n    Ok.prototype._unsafeUnwrap = function (_) {\r\n        return this.value;\r\n    };\r\n    Ok.prototype._unsafeUnwrapErr = function (config) {\r\n        throw createNeverThrowError('Called `_unsafeUnwrapErr` on an Ok', this, config);\r\n    };\r\n    return Ok;\r\n}());\r\nvar Err = /** @class */ (function () {\r\n    function Err(error) {\r\n        this.error = error;\r\n    }\r\n    Err.prototype.isOk = function () {\r\n        return false;\r\n    };\r\n    Err.prototype.isErr = function () {\r\n        return !this.isOk();\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    Err.prototype.map = function (_f) {\r\n        return err(this.error);\r\n    };\r\n    Err.prototype.mapErr = function (f) {\r\n        return err(f(this.error));\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\r\n    Err.prototype.andThen = function (_f) {\r\n        return err(this.error);\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\r\n    Err.prototype.orElse = function (f) {\r\n        return f(this.error);\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    Err.prototype.asyncAndThen = function (_f) {\r\n        return errAsync(this.error);\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    Err.prototype.asyncMap = function (_f) {\r\n        return errAsync(this.error);\r\n    };\r\n    Err.prototype.unwrapOr = function (v) {\r\n        return v;\r\n    };\r\n    Err.prototype.match = function (_ok, err) {\r\n        return err(this.error);\r\n    };\r\n    Err.prototype._unsafeUnwrap = function (config) {\r\n        throw createNeverThrowError('Called `_unsafeUnwrap` on an Err', this, config);\r\n    };\r\n    Err.prototype._unsafeUnwrapErr = function (_) {\r\n        return this.error;\r\n    };\r\n    return Err;\r\n}());\r\nvar fromThrowable = Result.fromThrowable;\r\n//#endregion\n\nexport { Err, Ok, Result, ResultAsync, err, errAsync, fromPromise, fromSafePromise, fromThrowable, ok, okAsync };\n", "import {Complex, Format, Util} from '@qni/common'\nimport {range} from 'fp-ts/NonEmptyArray'\nimport {ok, err, Result} from 'neverthrow'\n\ntype FormatOptions = {\n  allowAbbreviation?: boolean\n  maxAbbreviationError?: number\n  fixedDigits?: number | undefined\n  itemSeparator?: string\n}\n\nconst DEFAULT_FORMAT_OPTIONS: FormatOptions = {\n  allowAbbreviation: true,\n  maxAbbreviationError: 0.0005,\n  fixedDigits: undefined,\n  itemSeparator: ', ',\n}\n\nexport class Matrix {\n  public width: number\n  public height: number\n  public buffer: Float64Array\n\n  /**\n   * Creates a new Matrix object from the given rows.\n   */\n  static rows(rows: Array<Array<number | Complex>>): Result<Matrix, Error> {\n    const height = rows.length\n    if (height === 0) {\n      return err(Error('rows is empty'))\n    }\n    const width = rows[0].length\n    if (rows[0].length === 0) {\n      return err(Error('rows[0] is empty'))\n    }\n\n    return Matrix.build(height, width, (row, col) => rows[row][col])\n  }\n\n  /**\n   * Creates a column vector from the given elements.\n   */\n  static column_vector(...elements: Array<number | Complex>): Result<Matrix, Error> {\n    return Matrix.build(elements.length, 1, row => elements[row])\n  }\n\n  /**\n   * Builds a matrix with the specified width and height, using the provided\n   * function to generate each element.\n   */\n  static build(\n    height: number,\n    width: number,\n    matrixElementGenerator?: (row: number, col: number) => number | Complex,\n  ): Result<Matrix, Error> {\n    const buf = new Float64Array(width * height * 2)\n\n    for (let row = 0; row < height; row++) {\n      for (let col = 0; col < width; col++) {\n        const ri = (row * width + col) * 2 // real part index\n        const ii = ri + 1 // imaginary part index\n\n        let v: Complex\n        if (matrixElementGenerator) {\n          v = Complex.from(matrixElementGenerator(row, col))\n        } else {\n          v = Complex.from(0)\n        }\n\n        buf[ri] = v.real\n        buf[ii] = v.imag\n      }\n    }\n\n    return Matrix.create(height, width, buf)\n  }\n\n  private static create(height: number, width: number, buffer: Float64Array): Result<Matrix, Error> {\n    if (width < 0) {\n      return err(Error(`width(${width}) < 0`))\n    }\n    if (height < 0) {\n      return err(Error(`height(${height}) < 0`))\n    }\n    if (width * height * 2 !== buffer.length) {\n      return err(Error(`width(${width})*height(${height})*2 !== buffer.length(${buffer.length})`))\n    }\n\n    return ok(new Matrix(height, width, buffer))\n  }\n\n  private constructor(height: number, width: number, buffer: Float64Array) {\n    this.height = height\n    this.width = width\n    this.buffer = buffer\n\n    this.plus = this.add // alias for add\n  }\n\n  /**\n   * Retrieves the value at the specified row and column in the matrix.\n   */\n  element(row: number, col: number): Result<Complex, Error> {\n    if (row < 0 || col < 0 || row >= this.height || col >= this.width) {\n      return err(Error('Element out of range'))\n    }\n\n    const ri = (this.width * row + col) * 2 // real part index\n    const ii = ri + 1 // imaginary part index\n\n    return ok(new Complex(this.buffer[ri], this.buffer[ii]))\n  }\n\n  /**\n   * Sets the value of a element in the matrix.\n   */\n  set(row: number, col: number, value: Complex): Result<Matrix, Error> {\n    if (row < 0 || col < 0 || row >= this.height || col >= this.width) {\n      return err(Error('Element out of range'))\n    }\n\n    const ri = (this.width * row + col) * 2 // real part index\n    const ii = ri + 1 // imaginary part index\n\n    this.buffer[ri] = value.real\n    this.buffer[ii] = value.imag\n\n    return ok(this)\n  }\n\n  /**\n   * Retrieves a column from the matrix.\n   */\n  column(colIndex: number): Result<Complex[], Error> {\n    if (colIndex < 0) {\n      return err(Error('colIndex < 0'))\n    }\n    if (colIndex > this.width) {\n      return err(Error('colIndex > this.width'))\n    }\n\n    const col = []\n    for (let row = 0; row < this.height; row++) {\n      const element = this.element(row, colIndex)\n      if (element.isErr()) {\n        return err(element.error)\n      }\n      col.push(element.value)\n    }\n    return ok(col)\n  }\n\n  /**\n   * Adds another matrix to the current matrix.\n   */\n  add(other: Matrix): Result<Matrix, Error> {\n    if (other.width !== this.width || other.height !== this.height) {\n      return err(Error('Incompatible sizes'))\n    }\n\n    const newBuffer = new Float64Array(this.buffer.length)\n    for (let i = 0; i < newBuffer.length; i++) {\n      newBuffer[i] = this.buffer[i] + other.buffer[i]\n    }\n\n    return ok(new Matrix(this.height, this.width, newBuffer))\n  }\n  plus = this.add.bind(this)\n\n  /**\n   * Subtracts another matrix from this matrix.\n   */\n  sub(other: Matrix): Result<Matrix, Error> {\n    if (other.width !== this.width || other.height !== this.height) {\n      return err(Error('Incompatible sizes'))\n    }\n\n    const newBuffer = new Float64Array(this.buffer.length)\n    for (let i = 0; i < newBuffer.length; i++) {\n      newBuffer[i] = this.buffer[i] - other.buffer[i]\n    }\n\n    return ok(new Matrix(this.height, this.width, newBuffer))\n  }\n\n  mult(other: Matrix | number | Complex): Result<Matrix, Error> {\n    return other instanceof Matrix ? this.multMatrix(other) : ok(this.multScalar(other))\n  }\n\n  applyControlledGate(\n    operation2x2: Matrix,\n    targetBit: number,\n    controls: number[] = [],\n    antiControls: number[] = [],\n  ): Matrix {\n    const {width: w, height: h, buffer: old} = this\n\n    for (const each of controls) {\n      Util.need(each >= 0, 'control bit out of range')\n      Util.need(h >= 2 << each, 'control bit out of range')\n    }\n    for (const each of antiControls) {\n      Util.need(each >= 0, 'anti control bit out of range')\n      Util.need(h >= 2 << each, 'anti control bit out of range')\n    }\n\n    const controlMask = controls.concat(antiControls).reduce((result, each) => {\n      return result | (1 << each)\n    }, 0)\n    const desiredValueMask = controls.reduce((result, each) => {\n      return result | (1 << each)\n    }, 0)\n\n    Util.need((desiredValueMask & (1 << targetBit)) === 0, 'Matrix.timesQubitOperation: self-controlled')\n    Util.need(operation2x2.width === 2 && operation2x2.height === 2, 'Matrix.timesQubitOperation: not 2x2')\n\n    const [ar, ai, br, bi, cr, ci, dr, di] = operation2x2.buffer\n\n    Util.need(targetBit >= 0, 'target bit out of range')\n    Util.need(h >= 2 << targetBit, 'target bit out of range')\n\n    const buf = new Float64Array(old)\n    let i = 0\n    for (let r = 0; r < h; r++) {\n      const targetBitSet = (r & (1 << targetBit)) !== 0\n      const meetsControlConditions = ((controlMask & r) ^ desiredValueMask) === 0\n\n      for (let c = 0; c < w; c++) {\n        if (meetsControlConditions && !targetBitSet) {\n          const j = i + (1 << targetBit) * 2 * w\n          const xr = buf[i]\n          const xi = buf[i + 1]\n          const yr = buf[j]\n          const yi = buf[j + 1]\n\n          buf[i] = xr * ar - xi * ai + yr * br - yi * bi\n          buf[i + 1] = xr * ai + xi * ar + yr * bi + yi * br\n          buf[j] = xr * cr - xi * ci + yr * dr - yi * di\n          buf[j + 1] = xr * ci + xi * cr + yr * di + yi * dr\n        }\n        i += 2\n      }\n    }\n\n    return Matrix.create(h, w, buf)._unsafeUnwrap()\n  }\n\n  timesQubitOperation(operation2x2: Matrix, qubitIndex: number, controlMask: number): Matrix {\n    Util.need((controlMask & (1 << qubitIndex)) === 0, 'Matrix.timesQubitOperation: self-controlled')\n    Util.need(operation2x2.width === 2 && operation2x2.height === 2, 'Matrix.timesQubitOperation: not 2x2')\n\n    const {width: w, height: h, buffer: old} = this\n    const [ar, ai, br, bi, cr, ci, dr, di] = operation2x2.buffer\n\n    Util.need(h >= 2 << qubitIndex, 'Matrix.timesQubitOperation: qubit index out of range')\n\n    const buf = new Float64Array(old)\n    let i = 0\n    for (let r = 0; r < h; r++) {\n      const isControlled = ((controlMask & r) ^ controlMask) !== 0\n      const qubitVal = (r & (1 << qubitIndex)) !== 0\n      for (let c = 0; c < w; c++) {\n        if (!isControlled && !qubitVal) {\n          const j = i + (1 << qubitIndex) * 2 * w\n          const xr = buf[i]\n          const xi = buf[i + 1]\n          const yr = buf[j]\n          const yi = buf[j + 1]\n\n          buf[i] = xr * ar - xi * ai + yr * br - yi * bi\n          buf[i + 1] = xr * ai + xi * ar + yr * bi + yi * br\n          buf[j] = xr * cr - xi * ci + yr * dr - yi * di\n          buf[j + 1] = xr * ci + xi * cr + yr * di + yi * dr\n        }\n        i += 2\n      }\n    }\n\n    return Matrix.create(h, w, buf)._unsafeUnwrap()\n  }\n\n  /**\n   * Returns the matrix as an array of rows.\n   *\n   * @returns An array of rows\n   */\n  rows(): Complex[][] {\n    return range(0, this.height - 1).map<Complex[]>(row =>\n      range(0, this.width - 1).map<Complex>(col => this.element(row, col)._unsafeUnwrap()),\n    )\n  }\n\n  /**\n   * Return true if the matrix is a Hermitian matrix.\n   *\n   * @param epsilon - The epsilon to use for comparison\n   * @returns true if the matrix is a Hermitian matrix\n   */\n  isHermitian(epsilon = 0): boolean {\n    if (this.width !== this.height) {\n      return false\n    }\n\n    for (let col = 0; col < this.width; col++) {\n      for (let row = 0; row < this.height; row++) {\n        const i = (this.width * row + col) * 2\n        const j = (this.width * col + row) * 2\n\n        if (Math.abs(this.buffer[i] - this.buffer[j]) > epsilon) {\n          return false\n        }\n        if (Math.abs(this.buffer[i + 1] + this.buffer[j + 1]) > epsilon) {\n          return false\n        }\n      }\n    }\n\n    return true\n  }\n\n  /**\n   * Returns a trace of the `Matrix`.\n   *\n   * @returns A `Complex` number representing the trace\n   */\n  trace(): Complex {\n    let tr_r = 0\n    let tr_i = 0\n    const d = this.width * 2 + 2\n\n    for (let i = 0; i < this.buffer.length; i += d) {\n      tr_r += this.buffer[i]\n      tr_i += this.buffer[i + 1]\n    }\n\n    return new Complex(tr_r, tr_i)\n  }\n\n  /**\n   * Returns the adjoint matrix of the matrix.\n   *\n   * @returns The adjoint matrix\n   */\n  adjoint(): Matrix {\n    const w = this.height\n    const h = this.width\n    const newBuf = new Float64Array(w * h * 2)\n\n    for (let row = 0; row < h; row++) {\n      for (let col = 0; col < w; col++) {\n        const kIn = (col * this.width + row) * 2\n        const kOut = (row * w + col) * 2\n\n        newBuf[kOut] = this.buffer[kIn]\n        newBuf[kOut + 1] = -this.buffer[kIn + 1]\n      }\n    }\n\n    return new Matrix(h, w, newBuf)\n  }\n\n  /**\n   * Returns the tensor product of matrices.\n   *\n   * @param other - The matrix to multiply\n   */\n  tensorProduct(other: Matrix): Matrix {\n    const w1 = this.width\n    const h1 = this.height\n    const w2 = other.width\n    const h2 = other.height\n    const w = w1 * w2\n    const h = h1 * h2\n    const newBuffer = new Float64Array(w * h * 2)\n\n    for (let r1 = 0; r1 < h1; r1++) {\n      for (let r2 = 0; r2 < h2; r2++) {\n        for (let c1 = 0; c1 < w1; c1++) {\n          for (let c2 = 0; c2 < w2; c2++) {\n            const k1 = (r1 * w1 + c1) * 2\n            const k2 = (r2 * w2 + c2) * 2\n            const k3 = ((r1 * h2 + r2) * w + (c1 * w2 + c2)) * 2\n            const cr1 = this.buffer[k1]\n            const ci1 = this.buffer[k1 + 1]\n            const cr2 = other.buffer[k2]\n            const ci2 = other.buffer[k2 + 1]\n            const cr3 = cr1 * cr2 - ci1 * ci2\n            const ci3 = cr1 * ci2 + ci1 * cr2\n\n            newBuffer[k3] = cr3\n            newBuffer[k3 + 1] = ci3\n          }\n        }\n      }\n    }\n\n    return new Matrix(h, w, newBuffer)\n  }\n\n  /**\n   * Returns true if the Matrix is equal to other.\n   *\n   * @param other - The other Matrix to compare with\n   */\n  eq(obj: Matrix | unknown): boolean {\n    if (this === obj) return true\n    if (!(obj instanceof Matrix)) return false\n\n    const other = obj\n    return (\n      this.width === other.width &&\n      this.height === other.height &&\n      range(0, this.buffer.length - 1).every(i => this.buffer[i] === other.buffer[i])\n    )\n  }\n\n  /**\n   * Returns true if the Matrix is close to the value of other.\n   *\n   * @param other - The other Matrix to compare with\n   */\n  nearlyEq(other: Matrix | unknown, epsilon: number): boolean {\n    return (\n      other instanceof Matrix &&\n      this.width === other.width &&\n      this.height === other.height &&\n      Math.sqrt(this.sub(other)._unsafeUnwrap().norm2()) <= epsilon\n    )\n  }\n\n  format(options = DEFAULT_FORMAT_OPTIONS): string {\n    const format = new Format(\n      options.allowAbbreviation === undefined ? true : options.allowAbbreviation,\n      options.maxAbbreviationError || 0,\n      options.fixedDigits,\n      options.itemSeparator || ', ',\n    )\n\n    const data = this.rows()\n      .map(row => row.map(e => e.format(format)).join(format.itemSeparator))\n      .join(`}${format.itemSeparator}{`)\n\n    return `{{${data}}}`\n  }\n\n  toString(): string {\n    return this.format()\n  }\n\n  qubitDensityMatrixToBlochVector(): [number, number, number] {\n    if (this.width !== 2 || this.height !== 2) {\n      throw new Error('Need a 2x2 density matrix.')\n    }\n    if (!this.isHermitian(0.01)) {\n      throw new Error('Density matrix should be Hermitian.')\n    }\n    if (!this.trace().nearlyEq(1, 0.01)) {\n      throw new Error('Density matrix should have unit trace.')\n    }\n\n    // Density matrix from bloch vector equation: M = 1/2 (I + v\u03C3)\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const [ar, ai, br, bi, cr, ci, dr, di] = this.buffer\n    const x = cr + br\n    const y = ci - bi\n    const z = ar - dr\n    return [x, y, z]\n  }\n\n  clone(): Matrix {\n    return new Matrix(this.height, this.width, this.buffer.slice())\n  }\n\n  private norm2(): number {\n    let t = 0\n    for (const e of this.buffer) {\n      t += e * e\n    }\n    return t\n  }\n\n  private multMatrix(other: Matrix): Result<Matrix, Error> {\n    if (this.width !== other.height) {\n      return err(Error('Incompatible sizes.'))\n    }\n\n    const w = other.width\n    const h = this.height\n    const n = this.width\n    const newBuffer = new Float64Array(w * h * 2)\n\n    for (let r = 0; r < h; r++) {\n      for (let c = 0; c < w; c++) {\n        const k3 = (r * w + c) * 2\n        for (let k = 0; k < n; k++) {\n          const k1 = (r * n + k) * 2\n          const k2 = (k * w + c) * 2\n          const r1 = this.buffer[k1]\n          const i1 = this.buffer[k1 + 1]\n          const r2 = other.buffer[k2]\n          const i2 = other.buffer[k2 + 1]\n          const r3 = r1 * r2 - i1 * i2\n          const i3 = r1 * i2 + r2 * i1\n          newBuffer[k3] += r3\n          newBuffer[k3 + 1] += i3\n        }\n      }\n    }\n\n    return ok(new Matrix(h, w, newBuffer))\n  }\n\n  private multScalar(v: number | Complex): Matrix {\n    const newBuffer = new Float64Array(this.buffer.length)\n    const sr = Complex.real(v)\n    const si = Complex.imag(v)\n\n    for (let i = 0; i < newBuffer.length; i += 2) {\n      const vr = this.buffer[i]\n      const vi = this.buffer[i + 1]\n      newBuffer[i] = vr * sr - vi * si\n      newBuffer[i + 1] = vr * si + vi * sr\n    }\n\n    return new Matrix(this.height, this.width, newBuffer)\n  }\n}\n", "import {Complex, radian} from '@qni/common'\nimport {Matrix} from './matrix'\n\nconst i = Complex.I\nconst mi = i.neg()\n\n/**\n * Hadamard gate.\n *\n * ```\n * H = 1/\u221A2 * | 1  1 |\n *            | 1 -1 |\n * ```\n */\nexport const H = Matrix.rows([\n  [1, 1],\n  [1, -1],\n])\n  ._unsafeUnwrap()\n  .mult(Math.sqrt(0.5))\n  ._unsafeUnwrap()\n\n/**\n * Pauli X gate.\n *\n * ```\n * X = | 0 1 |\n *     | 1 0 |\n * ```\n */\nexport const X = Matrix.rows([\n  [0, 1],\n  [1, 0],\n])._unsafeUnwrap()\n\n/**\n * Pauli Y gate.\n *\n * ```\n * Y = | 0 -i |\n *     | i  0 |\n * ```\n */\nexport const Y = Matrix.rows([\n  [0, mi],\n  [i, 0],\n])._unsafeUnwrap()\n\n/**\n * Pauli Z gate.\n *\n * ```\n * Z = | 1  0 |\n *     | 0 -1 |\n * ```\n */\nexport const Z = Matrix.rows([\n  [1, 0],\n  [0, -1],\n])._unsafeUnwrap()\n\n/**\n * S gate.\n *\n * ```\n * S = | 1 0 |\n *     | 0 i |\n * ```\n */\nexport const S = Matrix.rows([\n  [1, 0],\n  [0, i],\n])._unsafeUnwrap()\n\n/**\n * S\u2020 gate.\n *\n * ```\n * S\u2020 = | 1  0 |\n *      | 0 -i |\n * ```\n */\nexport const SDagger = S.adjoint()\n\n/**\n * T gate.\n *\n * ```\n * T = | 1          0 |\n *     | 0  exp(i\u03C0/4) |\n * ```\n */\nexport const T = Matrix.rows([\n  [1, 0],\n  [0, i.times(Math.PI / 4).exp()],\n])._unsafeUnwrap()\n\n/**\n * T\u2020 gate.\n *\n * ```\n * T = | 1           0 |\n *     | 0  exp(-i\u03C0/4) |\n * ```\n */\nexport const TDagger = T.adjoint()\n\n/**\n * Phase (P) gate.\n *\n * ```\n * P(\u03C6) = | 1        0 |\n *        | 0  exp(i\u03C6) |\n * ```\n */\nexport function PHASE(phi: string): Matrix {\n  const \u03C6 = radian(phi)\n\n  return Matrix.rows([\n    [1, 0],\n    [0, i.times(\u03C6).exp()],\n  ])._unsafeUnwrap()\n}\n\n/**\n * RNOT (\u221AX) gate.\n *\n * ```\n * \u221AX = 1/2 * | 1+i 1-i |\n *            | 1-i 1+i |\n * ```\n */\nexport const RNOT = Matrix.rows([\n  [i.plus(1), mi.plus(1)],\n  [mi.plus(1), i.plus(1)],\n])\n  ._unsafeUnwrap()\n  .mult(0.5)\n  ._unsafeUnwrap()\n\n/**\n * Rx gate.\n *\n * ```\n * Rx(\u03B8) = | cos(\u03B8/2)   -isin(\u03B8/2) |\n *         | -isin(\u03B8/2)  cos(\u03B8/2)  |\n *\n * e.g.,\n * Rx(\u03C0/2) = | cos(\u03C0/4)   -isin(\u03C0/4) |\n *           | -isin(\u03C0/4)  cos(\u03C0/4)  |\n *\n *         = 1/\u221A2 * |  1 -i |\n *                  | -i  1 |\n * ```\n */\nexport function RX(theta: string): Matrix {\n  const \u03B8 = radian(theta)\n  const cos\u03B82 = Math.cos(\u03B8 / 2)\n  const sin\u03B82 = Math.sin(\u03B8 / 2)\n\n  return Matrix.rows([\n    [cos\u03B82, mi.times(sin\u03B82)],\n    [mi.times(sin\u03B82), cos\u03B82],\n  ])._unsafeUnwrap()\n}\n\n/**\n * Ry gate.\n *\n * ```\n * Ry(\u03B8) = | cos(\u03B8/2) -sin(\u03B8/2) |\n *         | sin(\u03B8/2)  cos(\u03B8/2)  |\n *\n * e.g.,\n * Ry(\u03C0/2) = | cos(\u03C0/4) -sin(\u03C0/4) |\n *           | sin(\u03C0/4)  cos(\u03C0/4) |\n *\n *         = 1/\u221A2 * | 1 -1 |\n *                  | 1  1 |\n * ```\n */\nexport function RY(theta: string): Matrix {\n  const \u03B8 = radian(theta)\n  const cos\u03B82 = Math.cos(\u03B8 / 2)\n  const sin\u03B82 = Math.sin(\u03B8 / 2)\n\n  return Matrix.rows([\n    [cos\u03B82, -sin\u03B82],\n    [sin\u03B82, cos\u03B82],\n  ])._unsafeUnwrap()\n}\n\n/**\n * Rz gate.\n *\n * ```\n * Rz(\u03B8) = | exp(-i\u03B8/2)          0 |\n *         |          0  exp(i\u03B8/2) |\n *\n * e.g.,\n * Rz(\u03C0/2) = | exp(-i\u03C0/4)          0 |\n *           |          0  exp(i\u03C0/4) |\n *\n *         = 1/\u221A2 * | 1-i   0 |\n *                  |   0 1+i |\n * ```\n */\nexport function RZ(theta: string): Matrix {\n  const \u03B8 = radian(theta)\n\n  return Matrix.rows([\n    [mi.times(\u03B8 / 2).exp(), 0],\n    [0, i.times(\u03B8 / 2).exp()],\n  ])._unsafeUnwrap()\n}\n", "import {Complex} from '@qni/common'\nimport {Matrix} from './matrix'\nimport {ok, err, Result} from 'neverthrow'\n\nexport class StateVector {\n  public matrix: Matrix\n  public size: number\n  public nqubit: number\n\n  get bra(): Matrix {\n    return this.matrix.adjoint()\n  }\n\n  get ket(): Matrix {\n    return this.matrix\n  }\n\n  constructor(bits: string | Matrix) {\n    if ('string' === typeof bits) {\n      const ketPattern = /^.*\\|.+>$/\n      if (ketPattern.test(bits)) {\n        this.matrix = this.ketstringToMatrix(bits)\n      } else {\n        this.matrix = this.bitstringToMatrix(bits)\n      }\n    } else {\n      this.matrix = bits\n    }\n\n    this.size = this.matrix.height\n    this.nqubit = Math.log2(this.size)\n\n    this.toWolfram = this.toString\n  }\n\n  amplifier(index: number): Complex {\n    return this.matrix.element(index, 0)._unsafeUnwrap()\n  }\n\n  setAmplifier(index: number, value: Complex): Result<StateVector, Error> {\n    const res = this.matrix.set(index, 0, value)\n    if (res.isErr()) {\n      return err(Error(res.error.message))\n    }\n\n    return ok(this)\n  }\n\n  blochVector(bit: number): [number, number, number] {\n    return this.qubitDensityMatrix(bit).qubitDensityMatrixToBlochVector()\n  }\n\n  isApproximatelyEqualTo(other: StateVector | unknown, epsilon: number): boolean {\n    return other instanceof StateVector && this.matrix.nearlyEq(other.matrix, epsilon)\n  }\n\n  applyControlledGate(\n    operation2x2: Matrix,\n    qubitIndex: number,\n    controls: number[] = [],\n    antiControls: number[] = [],\n  ): Matrix {\n    this.matrix = this.matrix.applyControlledGate(operation2x2, qubitIndex, controls, antiControls)\n    return this.matrix\n  }\n\n  timesQubitOperation(operation2x2: Matrix, qubitIndex: number, controlMask: number): Matrix {\n    this.matrix = this.matrix.timesQubitOperation(operation2x2, qubitIndex, controlMask)\n    return this.matrix\n  }\n\n  toString(): string {\n    return this.matrix.toString()\n  }\n  toWolfram = this.toString.bind(this)\n\n  private bitstringToMatrix(bitString: string): Matrix {\n    let paren = false\n    let parenToken = ''\n    const kets = []\n    const invalidBitStringError = new Error(`Invalid StateVector bit string: ${bitString}`)\n\n    for (const char of bitString.split('')) {\n      switch (char) {\n        case '0': {\n          if (paren) throw invalidBitStringError\n          kets.push(Matrix.column_vector(1, 0)._unsafeUnwrap())\n          break\n        }\n        case '1': {\n          if (paren) throw invalidBitStringError\n          kets.push(Matrix.column_vector(0, 1)._unsafeUnwrap())\n          break\n        }\n        case '+': {\n          if (paren) throw invalidBitStringError\n          kets.push(Matrix.column_vector(1, 1)._unsafeUnwrap().mult(Math.sqrt(0.5))._unsafeUnwrap())\n          break\n        }\n        case '-': {\n          if (paren) {\n            parenToken += '-'\n          } else {\n            kets.push(Matrix.column_vector(1, -1)._unsafeUnwrap().mult(Math.sqrt(0.5))._unsafeUnwrap())\n          }\n          break\n        }\n        case 'i': {\n          if (paren) {\n            parenToken += 'i'\n          } else {\n            kets.push(Matrix.column_vector(1, new Complex(0, 1))._unsafeUnwrap().mult(Math.sqrt(0.5))._unsafeUnwrap())\n          }\n          break\n        }\n        case '(': {\n          if (paren) throw invalidBitStringError\n          paren = true\n          parenToken = ''\n          break\n        }\n        case ')': {\n          if (!paren) throw invalidBitStringError\n          if (parenToken !== '-i') throw invalidBitStringError\n          kets.push(Matrix.column_vector(1, new Complex(0, -1))._unsafeUnwrap().mult(Math.sqrt(0.5))._unsafeUnwrap())\n          paren = false\n          break\n        }\n        default:\n          throw invalidBitStringError\n      }\n    }\n\n    if (kets.length === 0) throw invalidBitStringError\n    return kets.reduce((result, each) => result.tensorProduct(each))\n  }\n\n  private ketstringToMatrix(ket: string): Matrix {\n    const match = ket.match(/^(.*)\\|(.+)>$/)\n    if (match === null) {\n      throw new Error(`ketString: invalid ket ${ket}`)\n    }\n    const coefLabel = match[1]\n    const ketLabel = match[2]\n\n    if (coefLabel === '') {\n      return this.bitstringToMatrix(ketLabel)\n    } else {\n      let coef: number | Complex\n      if (coefLabel === '-') {\n        coef = -1\n      } else if (coefLabel === 'i') {\n        coef = Complex.I\n      } else if (coefLabel === '-i') {\n        coef = Complex.I.times(-1)\n      } else {\n        throw new Error(`ketString: invalid coef ${coefLabel}`)\n      }\n\n      const vector = new StateVector(ketLabel).matrix.mult(coef)\n\n      if (vector.isErr()) {\n        throw new Error(`ketString: invalid ket ${ketLabel}`)\n      }\n\n      return vector.value\n    }\n  }\n\n  qubitDensityMatrix(qubitIndex: number): Matrix {\n    if (qubitIndex < 0 || qubitIndex >= this.nqubit) {\n      throw new Error(`Qubit index out of range: ${qubitIndex}`)\n    }\n\n    const traceBits = [...Array(Math.log2(this.matrix.height)).keys()].filter(each => each !== qubitIndex)\n    const removeBits = (num: number, bits: number[]) => {\n      return bits\n        .sort()\n        .reverse()\n        .reduce((result, each) => {\n          let mask = result >> (each + 1)\n          mask = mask << each\n          const right = ((1 << each) - 1) & result\n\n          return mask | right\n        }, num)\n    }\n\n    let densityMatrix = Matrix.build(2, 2)._unsafeUnwrap()\n\n    for (let bra = 0; bra < this.matrix.height; bra++) {\n      for (let ket = 0; ket < this.matrix.height; ket++) {\n        const survived = traceBits.every(b => {\n          return ((bra >> b) & 1) === ((ket >> b) & 1)\n        })\n        if (!survived) continue\n\n        const amp = this.matrix\n          .element(ket, 0)\n          ._unsafeUnwrap()\n          .times(this.matrix.element(bra, 0)._unsafeUnwrap().conjugate())\n        if (amp.isEqualTo(0)) continue\n\n        const ketMat =\n          removeBits(ket, traceBits) === 0\n            ? Matrix.column_vector(1, 0)._unsafeUnwrap()\n            : Matrix.column_vector(0, 1)._unsafeUnwrap()\n        const braMat =\n          removeBits(bra, traceBits) === 0\n            ? Matrix.rows([[1, 0]])._unsafeUnwrap()\n            : Matrix.rows([[0, 1]])._unsafeUnwrap()\n        const ketBra = ketMat.mult(braMat)._unsafeUnwrap()\n\n        densityMatrix = densityMatrix.add(ketBra.mult(amp)._unsafeUnwrap())._unsafeUnwrap()\n      }\n    }\n\n    return densityMatrix\n  }\n}\n", "export function round(n: number, decimal: number): number {\n  return Math.round(n * Math.pow(10, decimal)) / Math.pow(10, decimal)\n}\n", "import {\n  Complex,\n  ResizeableSpan,\n  SerializedBlochDisplayType,\n  SerializedCircuitStep,\n  SerializedControlGateType,\n  SerializedHGateType,\n  SerializedMeasurementGateType,\n  SerializedPhaseGateType,\n  SerializedQftDaggerGateType,\n  SerializedQftGateType,\n  SerializedRnotGateType,\n  SerializedRxGateType,\n  SerializedRyGateType,\n  SerializedRzGateType,\n  SerializedSDaggerGateType,\n  SerializedSGateType,\n  SerializedSpacerGateType,\n  SerializedSwapGateType,\n  SerializedTDaggerGateType,\n  SerializedTGateType,\n  SerializedWrite0GateType,\n  SerializedWrite1GateType,\n  SerializedXGateType,\n  SerializedYGateType,\n  SerializedZGateType,\n} from '@qni/common'\nimport {H, X, Y, Z, S, SDagger, T, TDagger, PHASE, RNOT, RX, RY, RZ} from './gate-matrices'\nimport {Matrix} from './matrix'\nimport {StateVector} from './state-vector'\nimport {round} from './util'\n\ntype ControlOptions = {\n  controls?: number[]\n  antiControls?: number[]\n}\n\nexport class Simulator {\n  public state: StateVector\n  public blochVectors!: {[bit: number]: {x: number; y: number; z: number}}\n  public measuredBits: {[bit: number]: number}\n  public flags: {[key: string]: boolean}\n\n  constructor(bits: string) {\n    this.state = new StateVector(bits)\n    this.measuredBits = {}\n    this.flags = {}\n    this.blochVectors = {}\n  }\n\n  runStep(operations: SerializedCircuitStep): Simulator {\n    this.blochVectors = {}\n\n    for (const each of operations) {\n      switch (each.type) {\n        case SerializedHGateType:\n          if (each.if && !this.flags[each.if]) break\n          this.h(...each.targets, {controls: each.controls, antiControls: each.antiControls})\n          break\n        case SerializedXGateType:\n          if (each.if && !this.flags[each.if]) break\n          this.x(...each.targets, {controls: each.controls, antiControls: each.antiControls})\n          break\n        case SerializedYGateType:\n          if (each.if && !this.flags[each.if]) break\n          this.y(...each.targets, {controls: each.controls, antiControls: each.antiControls})\n          break\n        case SerializedZGateType:\n          if (each.if && !this.flags[each.if]) break\n          this.z(...each.targets, {controls: each.controls, antiControls: each.antiControls})\n          break\n        case SerializedRnotGateType:\n          if (each.if && !this.flags[each.if]) break\n          this.rnot(...each.targets, {controls: each.controls, antiControls: each.antiControls})\n          break\n        case SerializedSGateType: {\n          if (each.if && !this.flags[each.if]) break\n          this.s(...each.targets, {controls: each.controls, antiControls: each.antiControls})\n          break\n        }\n        case SerializedSDaggerGateType: {\n          if (each.if && !this.flags[each.if]) break\n          this.sDagger(...each.targets, {controls: each.controls, antiControls: each.antiControls})\n          break\n        }\n        case SerializedTGateType: {\n          if (each.if && !this.flags[each.if]) break\n          this.t(...each.targets, {controls: each.controls, antiControls: each.antiControls})\n          break\n        }\n        case SerializedTDaggerGateType: {\n          if (each.if && !this.flags[each.if]) break\n          this.tDagger(...each.targets, {controls: each.controls, antiControls: each.antiControls})\n          break\n        }\n        case SerializedPhaseGateType: {\n          if (!each.angle) throw new Error('angle is not set')\n          if (each.if && !this.flags[each.if]) break\n          this.phase(each.angle, ...each.targets, {controls: each.controls, antiControls: each.antiControls})\n          break\n        }\n        case SerializedRxGateType:\n          if (!each.angle) throw new Error('angle is not set')\n          if (each.if && !this.flags[each.if]) break\n          this.rx(each.angle, ...each.targets, {controls: each.controls, antiControls: each.antiControls})\n          break\n        case SerializedRyGateType:\n          if (!each.angle) throw new Error('angle is not set')\n          if (each.if && !this.flags[each.if]) break\n          this.ry(each.angle, ...each.targets, {controls: each.controls, antiControls: each.antiControls})\n          break\n        case SerializedRzGateType:\n          if (!each.angle) throw new Error('angle is not set')\n          if (each.if && !this.flags[each.if]) break\n          this.rz(each.angle, ...each.targets, {controls: each.controls, antiControls: each.antiControls})\n          break\n        case SerializedSwapGateType: {\n          this.swap(each.targets[0], each.targets[1], {controls: each.controls})\n          break\n        }\n        case SerializedControlGateType: {\n          this.z(each.targets[0], {controls: each.targets.slice(1)})\n          break\n        }\n        case SerializedBlochDisplayType:\n          for (const target of each.targets) {\n            this.blochDisplay(target)\n          }\n          break\n        case SerializedWrite0GateType:\n          this.write(0, ...each.targets)\n          break\n        case SerializedWrite1GateType:\n          this.write(1, ...each.targets)\n          break\n        case SerializedMeasurementGateType:\n          for (const target of each.targets) {\n            this.measure(target)\n            if (each.flag) {\n              this.flags[each.flag] = this.measuredBits[target] === 1\n            }\n          }\n          break\n        case SerializedSpacerGateType:\n          break\n        case SerializedQftGateType:\n          this.qft(each.span, ...each.targets)\n          break\n        case SerializedQftDaggerGateType:\n          this.qftDagger(each.span, ...each.targets)\n          break\n        /* istanbul ignore next */\n        default:\n          throw new Error('Unknown instruction')\n      }\n    }\n\n    return this\n  }\n\n  /**\n   * Applies the H gate to the specified qubit(s).\n   */\n  h(...args: Array<number | ControlOptions>): Simulator {\n    const {targets, controlOptions} = this.processGateArgs(args)\n\n    this.cu(H, targets, controlOptions)\n    return this\n  }\n\n  /**\n   * Applies the X gate to the specified qubit(s).\n   */\n  x(...args: Array<number | ControlOptions>): Simulator {\n    const {targets, controlOptions} = this.processGateArgs(args)\n\n    this.cu(X, targets, controlOptions)\n    return this\n  }\n\n  /**\n   * Applies the Y gate to the specified qubit(s).\n   */\n  y(...args: Array<number | ControlOptions>): Simulator {\n    const {targets, controlOptions} = this.processGateArgs(args)\n\n    this.cu(Y, targets, controlOptions)\n    return this\n  }\n\n  /**\n   * Applies the Z gate to the specified qubit(s).\n   */\n  z(...args: Array<number | ControlOptions>): Simulator {\n    const {targets, controlOptions} = this.processGateArgs(args)\n\n    this.cu(Z, targets, controlOptions)\n    return this\n  }\n\n  /**\n   * Applies the \u221AX gate to the specified qubit(s).\n   */\n  rnot(...args: Array<number | ControlOptions>): Simulator {\n    const {targets, controlOptions} = this.processGateArgs(args)\n\n    this.cu(RNOT, targets, controlOptions)\n    return this\n  }\n\n  /**\n   * Applies the S gate to the specified qubit(s).\n   */\n  s(...args: Array<number | ControlOptions>): Simulator {\n    const {targets, controlOptions} = this.processGateArgs(args)\n\n    this.cu(S, targets, controlOptions)\n    return this\n  }\n\n  /**\n   * Applies the S\u2020 gate to the specified qubit(s).\n   */\n  sDagger(...args: Array<number | ControlOptions>): Simulator {\n    const {targets, controlOptions} = this.processGateArgs(args)\n\n    this.cu(SDagger, targets, controlOptions)\n    return this\n  }\n\n  /**\n   * Applies the T gate to the specified qubit(s).\n   */\n  t(...args: Array<number | ControlOptions>): Simulator {\n    const {targets, controlOptions} = this.processGateArgs(args)\n\n    this.cu(T, targets, controlOptions)\n    return this\n  }\n\n  /**\n   * Applies the T\u2020 gate to the specified qubit(s).\n   */\n  tDagger(...args: Array<number | ControlOptions>): Simulator {\n    const {targets, controlOptions} = this.processGateArgs(args)\n\n    this.cu(TDagger, targets, controlOptions)\n    return this\n  }\n\n  /**\n   * Applies a phase gate to the specified qubit(s).\n   */\n  phase(phi: string, ...args: Array<number | ControlOptions>): Simulator {\n    const {targets, controlOptions} = this.processGateArgs(args)\n\n    this.cu(PHASE(phi), targets, controlOptions)\n    return this\n  }\n\n  /**\n   * Apply an RX gate to the specified qubit(s).\n   */\n  rx(theta: string, ...args: Array<number | ControlOptions>): Simulator {\n    const {targets, controlOptions} = this.processGateArgs(args)\n\n    this.cu(RX(theta), targets, controlOptions)\n    return this\n  }\n\n  /**\n   * Apply an RY gate to the specified qubit(s).\n   */\n  ry(theta: string, ...args: Array<number | ControlOptions>): Simulator {\n    const {targets, controlOptions} = this.processGateArgs(args)\n\n    this.cu(RY(theta), targets, controlOptions)\n    return this\n  }\n\n  /**\n   * Apply an RZ gate to the specified qubit(s).\n   */\n  rz(theta: string, ...args: Array<number | ControlOptions>): Simulator {\n    const {targets, controlOptions} = this.processGateArgs(args)\n\n    this.cu(RZ(theta), targets, controlOptions)\n    return this\n  }\n\n  /**\n   * Swaps the values of two qubits.\n   *\n   * TODO: antiControl \u306B\u5BFE\u5FDC\n   */\n  swap(target0: number, target1: number, controlOptions?: ControlOptions): Simulator {\n    const controls = controlOptions?.controls || []\n\n    this.x(target1, {controls: controls.concat([target0])})\n      .x(target0, {controls: controls.concat([target1])})\n      .x(target1, {controls: controls.concat([target0])})\n    return this\n  }\n\n  /**\n   * Calculates the Bloch vector for the specified qubit.\n   */\n  blochDisplay(target: number): Simulator {\n    const [x, y, z] = this.state.blochVector(target)\n    this.blochVectors[target] = {x, y, z}\n    return this\n  }\n\n  /**\n   * Writes a value zero or one to the specified qubit(s).\n   */\n  write(value: 0 | 1, ...targets: number[]): Simulator {\n    for (const t of targets) {\n      const pZero = round(this.pZero(t), 5)\n\n      if ((value === 0 && pZero === 0) || (value === 1 && pZero === 1)) {\n        this.x(t)\n      }\n    }\n    return this\n  }\n\n  /**\n   * Measures the specified qubits and updates the state accordingly.\n   */\n  measure(...targets: number[]): Simulator {\n    for (const t of targets) {\n      const pZero = this.pZero(t)\n      const rand = Math.random()\n\n      if (rand <= pZero) {\n        for (let bit = 0; bit < 1 << this.state.nqubit; bit++) {\n          if ((bit & (1 << t)) !== 0) this.state.setAmplifier(bit, Complex.ZERO)\n          const res = this.state.amplifier(bit).div(Math.sqrt(pZero))\n          /* istanbul ignore next */\n          if (res.isErr()) {\n            throw Error(res.error.message)\n          }\n          this.state.setAmplifier(bit, res.value)\n        }\n        this.measuredBits[t] = 0\n      } else {\n        for (let bit = 0; bit < 1 << this.state.nqubit; bit++) {\n          if ((bit & (1 << t)) === 0) this.state.setAmplifier(bit, Complex.ZERO)\n          const res = this.state.amplifier(bit).div(Math.sqrt(1 - pZero))\n          /* istanbul ignore next */\n          if (res.isErr()) {\n            throw Error(res.error.message)\n          }\n          this.state.setAmplifier(bit, res.value)\n        }\n        this.measuredBits[t] = 1\n      }\n    }\n    return this\n  }\n\n  /**\n   * Applies the Quantum Fourier Transform (QFT) to the specified targets.\n   */\n  qft(span: ResizeableSpan, ...targets: number[]): Simulator {\n    for (const each of targets) {\n      this.qftSingleTargetBit(span, each)\n    }\n    return this\n  }\n\n  /**\n   * Applies the inverse Quantum Fourier Transform (QFT) to the specified targets.\n   */\n  qftDagger(span: ResizeableSpan, ...targets: number[]): Simulator {\n    for (const each of targets) {\n      this.qftDaggerSingleTargetBit(span, each)\n    }\n    return this\n  }\n\n  private qftSingleTargetBit(span: ResizeableSpan, target: number): Simulator {\n    for (let i = 0; i < span; i++) {\n      this.h(target + i)\n      for (let j = 1; j < span - i; j++) {\n        this.phase(`\u03C0/${2 ** j}`, target + i, {controls: [target + i + j]})\n      }\n    }\n    return this\n  }\n\n  private qftDaggerSingleTargetBit(span: ResizeableSpan, target: number): Simulator {\n    for (let i = span - 1; i >= 0; i--) {\n      for (let j = span - i - 1; j > 0; j--) {\n        this.phase(`-\u03C0/${2 ** j}`, target + i, {controls: [target + i + j]})\n      }\n      this.h(target + i)\n    }\n    return this\n  }\n\n  private processGateArgs(args: Array<number | ControlOptions>): {\n    targets: number[]\n    controlOptions: ControlOptions\n  } {\n    const controlOptions = typeof args[args.length - 1] === 'object' ? (args.pop() as ControlOptions) : {}\n    const targets = args as number[]\n\n    return {targets, controlOptions}\n  }\n\n  private cu(u: Matrix, targets: number[], gateControlOptions: ControlOptions): void {\n    for (const t of targets) {\n      this.state.applyControlledGate(u, t, gateControlOptions.controls, gateControlOptions.antiControls)\n    }\n  }\n\n  private pZero(target: number): number {\n    let p = 0\n    for (let bit = 0; bit < 1 << this.state.nqubit; bit++) {\n      if ((bit & (1 << target)) === 0) {\n        p += Math.pow(this.state.amplifier(bit).abs(), 2)\n      }\n    }\n    return p\n  }\n}\n", "import Fraction from 'fraction.js'\n\nexport function radian(angle: string): number {\n  const coefficient = piCoefficient(angle)\n  const fraction = new Fraction(coefficient).valueOf()\n\n  return fraction * Math.PI\n}\n\n// TODO: neverthrow \u5316\nexport function angleDenominator(angle: string): number {\n  const coefficient = piCoefficient(angle)\n  const split = coefficient.split('/')\n\n  if (split.length === 1) {\n    return 1\n  } else if (split.length === 2) {\n    return parseInt(split[1])\n  } else {\n    throw new Error(`Failed to parse angle '${angle}'`)\n  }\n}\n\n// TODO: neverthrow \u5316\nexport function angleNumerator(angle: string): number {\n  const coefficient = piCoefficient(angle)\n  const split = coefficient.split('/')\n\n  if (split.length === 1) {\n    return parseInt(split[0])\n  } else if (split.length === 2) {\n    return parseInt(split[0])\n  } else {\n    throw new Error(`Failed to parse angle '${angle}'`)\n  }\n}\n\nexport function isAngleLessThan(angle: string, other: string): boolean {\n  return new Fraction(piCoefficient(angle)).valueOf() < new Fraction(piCoefficient(other)).valueOf()\n}\n\nexport function isAngleGreaterThan(angle: string, other: string): boolean {\n  return new Fraction(piCoefficient(angle)).valueOf() > new Fraction(piCoefficient(other)).valueOf()\n}\n\nexport function isValidAngle(angle: string): boolean {\n  if (angle === '0') return true\n  if (!/\u03C0/.test(angle)) return false\n\n  try {\n    const coefficient = piCoefficient(angle)\n    new Fraction(coefficient).valueOf()\n\n    return true\n  } catch (e) {\n    return false\n  }\n}\n\nexport function piCoefficient(angle: string): string {\n  return angle.replace(/(\\d+)\u03C0/g, '$1').replace(/\u03C0/g, '1')\n}\n\nexport function reduceAngle(angle: string): string {\n  try {\n    const coefficient = piCoefficient(angle)\n    const reduced = new Fraction(coefficient).toFraction()\n    const split = reduced.split('/')\n\n    let numerator: string\n    if (split[0] === '0') {\n      numerator = '0'\n    } else if (split[0] === '1') {\n      numerator = `\u03C0`\n    } else if (split[0] === '-1') {\n      numerator = `-\u03C0`\n    } else {\n      numerator = `${split[0]}\u03C0`\n    }\n\n    if (split.length === 1) {\n      return numerator\n    } else {\n      return `${numerator}/${split[1]}`\n    }\n  } catch (e) {\n    throw new Error(`Failed to parse angle '${angle}'`)\n  }\n}\n", "type UnicodeFraction = {character: string; ref: string; value: number}\n\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const UNICODE_FRACTIONS = [\n  {character: '\\u00BD', ref: '\u00BD', expanded: '1/2', value: 1 / 2},\n  {character: '\\u00BC', ref: '\u00BC', expanded: '1/4', value: 1 / 4},\n  {character: '\\u00BE', ref: '\u00BE', expanded: '3/4', value: 3 / 4},\n  {character: '\\u2153', ref: '\u2153', expanded: '1/3', value: 1 / 3},\n  {character: '\\u2154', ref: '\u2154', expanded: '2/3', value: 2 / 3},\n  {character: '\\u2155', ref: '\u2155', expanded: '1/5', value: 1 / 5},\n  {character: '\\u2156', ref: '\u2156', expanded: '2/5', value: 2 / 5},\n  {character: '\\u2157', ref: '\u2157', expanded: '3/5', value: 3 / 5},\n  {character: '\\u2158', ref: '\u2158', expanded: '4/5', value: 4 / 5},\n  {character: '\\u2159', ref: '\u2159', expanded: '1/6', value: 1 / 6},\n  {character: '\\u215A', ref: '\u215A', expanded: '5/6', value: 5 / 6},\n  {character: '\\u2150', ref: '\u2150', expanded: '1/7', value: 1 / 7},\n  {character: '\\u215B', ref: '\u215B', expanded: '1/8', value: 1 / 8},\n  {character: '\\u215C', ref: '\u215C', expanded: '3/8', value: 3 / 8},\n  {character: '\\u215D', ref: '\u215D', expanded: '5/8', value: 5 / 8},\n  {character: '\\u215E', ref: '\u215E', expanded: '7/8', value: 7 / 8},\n  {character: '\\u2151', ref: '\u2151', expanded: '1/9', value: 1 / 9},\n  {character: '\\u2152', ref: '\u2152', expanded: '1/10', value: 1 / 10},\n]\n\n/**\n * Stores formatting options, for determining what string output should look\n * like.\n */\nexport class Format {\n  /**\n   * Returns an approximated result, but with the constraint that when it\n   * changes slightly it should \"look the same\". (It should look good when\n   * varying and animated.)\n   */\n  static readonly CONSISTENT = new Format(false, 0, 2, ', ')\n\n  /**\n   * Returns an accurate result, but favoring looking nice over being small.\n   */\n  static readonly EXACT = new Format(true, 0, undefined, ', ')\n\n  /**\n   * Returns an accurate result, favoring being small over looking nice.\n   */\n  static readonly MINIFIED = new Format(true, 0, undefined, ',')\n\n  /**\n   * Returns an approximated result, strongly favoring looking nice.\n   */\n  static readonly SIMPLIFIED = new Format(true, 0.0005, 3, ', ')\n\n  /**\n   * Parses the given text into a float. Works for text created by\n   * [[formatFloat]].\n   */\n  static parseFloat(text: string): number {\n    if (text.length === 0) {\n      throw new Error(`Not a number: '${text}'`)\n    }\n    if (text[0] === '-') {\n      return -Format.parseFloat(text.substr(1))\n    }\n    if (text[0] === '\\u221A') {\n      return Math.sqrt(Format.parseFloat(text.substr(1)))\n    }\n\n    const fraction = Format.matchUnicodeFraction(e => e.character === text)\n    if (fraction !== undefined) {\n      return fraction.value\n    }\n\n    const result = parseFloat(text)\n    if (isNaN(result)) {\n      throw new Error(`Not a number: '${text}'`)\n    }\n    return result\n  }\n\n  /**\n   * Corrects a value to a nearby simple fraction or root thereof, such as\n   * sqrt(1/2), so it can be printed compactly.\n   *\n   * @param value  The value to round.\n   * @param epsilon  The maximum offset error introduced by the rounding.\n   */\n  static simplifyByRounding(value: number, epsilon: number): number {\n    if (value < 0) {\n      return -Format.simplifyByRounding(-value, epsilon)\n    }\n\n    const r = value % 1\n    if (r <= epsilon || 1 - r <= epsilon) {\n      return Math.round(value)\n    }\n\n    const fraction = Format.matchUnicodeFraction(e => Math.abs(e.value - value) <= epsilon)\n    if (fraction !== undefined) {\n      return fraction.value\n    }\n\n    const rootFraction = Format.matchUnicodeFraction(e => Math.abs(Math.sqrt(e.value) - value) <= epsilon)\n    if (rootFraction !== undefined) {\n      return Math.sqrt(rootFraction.value)\n    }\n\n    return value\n  }\n\n  /**\n   * Returns the first element of an array matching the given predicate, or else\n   * returns undefined.\n   *\n   * @hidden\n   */\n  static matchUnicodeFraction(predicate: (arrayItem: UnicodeFraction) => boolean): UnicodeFraction | undefined {\n    for (const each of UNICODE_FRACTIONS) {\n      if (predicate(each)) return each\n    }\n    return undefined\n  }\n\n  public allowAbbreviation: boolean\n  public maxAbbreviationError: number\n  public fixedDigits: number | undefined\n  public itemSeparator: string\n\n  /**\n   * @param allowAbbreviation  Should outputs be shortened, if possible?\n   * @param maxAbbreviationError  How much error is abbreviating allowed to introduce?\n   * @param fixedDigits  Use toFixed? How many digits?\n   * @param itemSeparator  What should list items be separated by?\n   */\n  constructor(\n    allowAbbreviation: boolean,\n    maxAbbreviationError: number,\n    fixedDigits: number | undefined,\n    itemSeparator: string,\n  ) {\n    this.allowAbbreviation = allowAbbreviation\n    this.maxAbbreviationError = maxAbbreviationError\n    this.fixedDigits = fixedDigits\n    this.itemSeparator = itemSeparator\n  }\n\n  formatFloat(f: number): string {\n    if (this.allowAbbreviation) {\n      return this.abbreviateFloat(f, this.maxAbbreviationError, this.fixedDigits)\n    }\n    if (this.fixedDigits !== undefined) {\n      return f.toFixed(this.fixedDigits)\n    }\n    return String(f)\n  }\n\n  /**\n   * Returns a string representation of a float, taking advantage of unicode\n   * fractions and square roots.\n   *\n   * @param value  The value to represent as a string.\n   * @param epsilon  The maximum error introduced by using an expression.\n   * @param digits  digits The number of digits to use if no expression matches.\n   */\n  private abbreviateFloat(value: number, epsilon = 0, digits: number | undefined = undefined): string {\n    if (Math.abs(value) < epsilon) return '0'\n    if (value < 0) return `-${this.abbreviateFloat(-value, epsilon, digits)}`\n\n    const fraction = Format.matchUnicodeFraction(e => Math.abs(e.value - value) <= epsilon)\n    if (fraction !== undefined) {\n      return fraction.character\n    }\n\n    const rootFraction = Format.matchUnicodeFraction(e => Math.abs(Math.sqrt(e.value) - value) <= epsilon)\n    if (rootFraction !== undefined) {\n      return `\\u221A${rootFraction.character}`\n    }\n\n    if (value % 1 !== 0 && digits !== undefined) {\n      return value.toFixed(digits)\n    }\n\n    return value.toString()\n  }\n}\n", "import {UNICODE_FRACTIONS} from './format'\n\ntype UnicodeFraction = {character: string; ref: string; value: number}\n\nexport class NumberFormatter {\n  public allowAbbreviation: boolean\n  public maxAbbreviationError: number\n  public fixedDigits: number | undefined\n  public itemSeparator: string\n\n  static matchUnicodeFraction(predicate: (arrayItem: UnicodeFraction) => boolean): UnicodeFraction | undefined {\n    for (const each of UNICODE_FRACTIONS) {\n      if (predicate(each)) return each\n    }\n    return undefined\n  }\n\n  constructor(\n    allowAbbreviation: boolean,\n    maxAbbreviationError: number,\n    fixedDigits: number | undefined,\n    itemSeparator = ', ',\n  ) {\n    this.allowAbbreviation = allowAbbreviation\n    this.maxAbbreviationError = maxAbbreviationError\n    this.fixedDigits = fixedDigits\n    this.itemSeparator = itemSeparator\n  }\n\n  format(n: number): string {\n    if (this.allowAbbreviation) {\n      return this.abbreviateNumber(n, this.maxAbbreviationError, this.fixedDigits)\n    }\n    if (this.fixedDigits !== undefined) {\n      return n.toFixed(this.fixedDigits)\n    }\n    return String(n)\n  }\n\n  private abbreviateNumber(value: number, epsilon = 0, digits: number | undefined = undefined): string {\n    if (Math.abs(value) < epsilon) return '0'\n    if (value < 0) return `-${this.abbreviateNumber(-value, epsilon, digits)}`\n\n    const fraction = NumberFormatter.matchUnicodeFraction(e => Math.abs(e.value - value) <= epsilon)\n    if (fraction !== undefined) {\n      return fraction.character\n    }\n\n    const rootFraction = NumberFormatter.matchUnicodeFraction(e => Math.abs(Math.sqrt(e.value) - value) <= epsilon)\n    if (rootFraction !== undefined) {\n      return `\\u221A${rootFraction.character}`\n    }\n\n    if (value % 1 !== 0 && digits !== undefined) {\n      return value.toFixed(digits)\n    }\n\n    return value.toString()\n  }\n}\n", "import {NumberFormatter} from './number-formatter'\nimport {ok, err, Result} from 'neverthrow'\n\ntype FormatOptions = {\n  allowAbbreviation?: boolean\n  maxAbbreviationError?: number\n  fixedDigits?: number | undefined\n}\n\nconst DEFAULT_FORMAT_OPTIONS = {\n  allowAbbreviation: true,\n  maxAbbreviationError: 0,\n  fixedDigits: undefined,\n}\n\nexport class Complex {\n  /**\n   * Complex { real: 0, imag: 0 }\n   */\n  static readonly ZERO = new Complex(0, 0)\n  /**\n   * Complex { real: 1, imag: 0 }\n   */\n  static readonly ONE = new Complex(1, 0)\n  /**\n   * The imaginary unit.\n   */\n  static readonly I = new Complex(0, 1)\n\n  /**\n   * The real part of the Complex number.\n   */\n  public real: number\n  /**\n   * The imaginary part of the Complex number.\n   */\n  public imag: number\n\n  /**\n   * Converts the given value to a Complex value.\n   *\n   * @param value - The value to convert to a Complex value\n   */\n  static from(value: number | Complex): Complex {\n    if (typeof value === 'number') {\n      return new Complex(value, 0)\n    }\n\n    return value\n  }\n\n  /**\n   * Returns the real part of a Complex or a number value.\n   *\n   * @param value - The value to get the real part of\n   */\n  static real(value: number | Complex): number {\n    if (typeof value === 'number') {\n      return value\n    }\n\n    return value.real\n  }\n\n  /**\n   * Returns the imaginary part of a Complex value, or else 0 for number values.\n   *\n   * @param value - The value to get the imaginary part of\n   */\n  static imag(value: number | Complex): number {\n    if (typeof value === 'number') {\n      return 0\n    }\n\n    return value.imag\n  }\n\n  /**\n   * Returns a new Complex number with the given magnitude and phase.\n   *\n   * @param magnitude - The magnitude of the Complex number\n   * @param phase - The phase of the Complex number\n   */\n  static polar(magnitude: number, phase: number): Complex {\n    const [cos, sin] = this.cosAndSin(phase)\n\n    return new Complex(magnitude * cos, magnitude * sin)\n  }\n\n  private static cosAndSin(radians: number): number[] {\n    const unit = Math.PI / 4\n    const i = Math.round(radians / unit)\n    if (i * unit === radians) {\n      const s = Math.sqrt(0.5)\n      const snaps = [\n        [1, 0], // 0\n        [s, s], // \u03C0/4\n        [0, 1], // \u03C0/2\n        [-s, s], // 3\u03C0/4\n        [-1, 0], // \u03C0\n        [-s, -s], // 5\u03C0/4\n        [0, -1], // 3\u03C0/2\n        [s, -s], // 7\u03C0/4\n      ]\n      return snaps[i & 7]\n    }\n    return [Math.cos(radians), Math.sin(radians)]\n  }\n\n  /**\n   * @param real - The real part of the Complex number\n   * @param imag - The imaginary part of the Complex number\n   */\n  constructor(real: number, imag: number) {\n    this.real = real\n    this.imag = imag\n\n    this.isApproximatelyEqualTo = this.nearlyEq // alias for nearlyEq\n    this.isEqualTo = this.eq // alias for eq\n    this.conj = this.conjugate // alias for conjugate\n    this.plus = this.add // alias for add\n    // aliases for sub\n    this.subtract = this.sub\n    this.minus = this.sub\n    // aliases for mult\n    this.multiply = this.mult\n    this.times = this.mult\n    this.dividedBy = this.div // alias for div\n    this.magnitude = this.abs // alias for abs\n    this.norm2 = this.abs2 // alias for abs2\n    // aliases for arg\n    this.angle = this.arg\n    this.phase = this.arg\n  }\n\n  /**\n   * Returns true if complex number is equal to other.\n   *\n   * @param other - The other value to compare with\n   */\n  eq(other: unknown): boolean {\n    if (typeof other === 'number') {\n      return this.real === other && this.imag === 0\n    }\n    if (other instanceof Complex) {\n      return this.real === other.real && this.imag === other.imag\n    }\n    return false\n  }\n\n  isEqualTo = this.eq.bind(this)\n\n  /**\n   * Returns true if the Complex number is close to the value of other.\n   *\n   * @param other - The other value to compare with\n   */\n  nearlyEq(other: number | Complex | unknown, epsilon: number): boolean {\n    if (typeof other === 'number' || other instanceof Complex) {\n      const d = this.sub(Complex.from(other))\n      return Math.abs(d.real) <= epsilon && Math.abs(d.imag) <= epsilon && d.abs() <= epsilon\n    }\n    return false\n  }\n\n  isApproximatelyEqualTo = this.nearlyEq.bind(this)\n\n  /**\n   * Returns the complex conjugate.\n   *\n   * @returns A new Complex representing the complex conjugate of this complex number\n   */\n  conjugate(): Complex {\n    return new Complex(this.real, -this.imag)\n  }\n\n  conj = this.conjugate.bind(this)\n\n  /**\n   * Returns negation of the value.\n   *\n   * @returns A new Complex representing the negation of this complex number.\n   */\n  neg(): Complex {\n    return new Complex(-this.real, -this.imag)\n  }\n\n  /**\n   * Returns the sum of this complex number and value.\n   *\n   * @param value - The addend number.\n   * @returns A new Complex representing the sum of this complex number and value.\n   */\n  add(value: number | Complex): Complex {\n    const c = Complex.from(value)\n\n    return new Complex(this.real + c.real, this.imag + c.imag)\n  }\n\n  plus = this.add.bind(this)\n\n  /**\n   * Returns the subtraction of this complex number and value.\n   *\n   * @param value - The subtrahend number.\n   * @returns A new Complex representing the subtraction of this complex number and value.\n   */\n  sub(value: number | Complex): Complex {\n    const c = Complex.from(value)\n\n    return new Complex(this.real - c.real, this.imag - c.imag)\n  }\n\n  subtract = this.sub.bind(this)\n  minus = this.sub.bind(this)\n\n  /**\n   * Returns the product of this complex number and value.\n   *\n   * @param value - The multiplier number.\n   * @returns A new Complex representing the product of this complex number and value.\n   */\n  mult(value: number | Complex): Complex {\n    const c = Complex.from(value)\n\n    return new Complex(this.real * c.real - this.imag * c.imag, this.real * c.imag + this.imag * c.real)\n  }\n\n  multiply = this.mult.bind(this)\n  times = this.mult.bind(this)\n\n  /**\n   * Returns a complex number divided by value.\n   * If value is zero, returns an error.\n   *\n   * @param value - The divisor number.\n   * @returns A Result object with the result of division or a division-by-zero error.\n   * @example\n   * ```\n   * const res = new Complex(2, 3).div(2)\n   * if (res.isOk()) {\n   *   console.log(res.value) // Complex { real: 1, imag: 1.5 }\n   * } else {\n   *   console.error(res.error)\n   * }\n   * ```\n   */\n  div(value: number | Complex): Result<Complex, Error> {\n    const c = Complex.from(value)\n    const d = c.abs2()\n    if (d === 0) {\n      return err(Error('Division by Zero'))\n    }\n\n    const n = this.mult(c.conjugate())\n    return ok(new Complex(n.real / d, n.imag / d))\n  }\n\n  dividedBy = this.div.bind(this)\n\n  /**\n   * Returns the absolute part of its polar form.\n   *\n   * @returns A number representing the absolute part of its polar form.\n   * @example\n   * ```\n   * new Complex(-1, 0).abs() // 1\n   * new Complex(3, 4).abs() // 5\n   * ```\n   */\n  abs(): number {\n    return Math.sqrt(this.abs2())\n  }\n\n  magnitude = this.abs.bind(this)\n\n  /**\n   * Returns square of the absolute value.\n   *\n   * @returns A number representing the square of the absolute value.\n   * @example\n   * ```\n   * new Complex(-1, 0).abs2() // 1\n   * new Complex(3, 4).abs2() // 25\n   * ```\n   */\n  abs2(): number {\n    return this.real * this.real + this.imag * this.imag\n  }\n\n  norm2 = this.abs2.bind(this)\n\n  /**\n   * Returns the angle part of its polar form.\n   *\n   * @returns A number representing the angle part of its polar form in radians.\n   */\n  arg(): number {\n    return Math.atan2(this.imag, this.real)\n  }\n\n  angle = this.arg.bind(this)\n  phase = this.arg.bind(this)\n\n  /**\n   * Returns the exponentiation of a complex number. That is c.pow(x) = c^x.\n   *\n   * @param exponent - the exponent number\n   * @returns A number representing base taken to the power of exponent\n   */\n  pow(exponent: number | Complex): Complex {\n    if (exponent === 0.5 && this.imag === 0 && this.real >= 0) {\n      return new Complex(Math.sqrt(this.real), 0)\n    }\n    if (this.eq(Complex.ZERO)) {\n      return Complex.ZERO\n    }\n    return this.ln().mult(Complex.from(exponent)).exp()\n  }\n\n  /**\n   * Returns e raised to the c power. That is c.exp() = e^c.\n   */\n  exp(): Complex {\n    return Complex.polar(Math.exp(this.real), this.imag)\n  }\n\n  /**\n   * Returns a string representing this complex number according to the specified format.\n   *\n   * @param options - An object that sets the format options for this complex number.\n   * @returns A string representing this complex number.\n   * @example\n   * ```\n   * new Complex(1, 2).format() // '1+2i'\n   * new Complex(1, 2).format({\n   *   allowAbbreviation: false,\n   *   fixedDigits: 2,\n   * }) // '+1.00+2.00i'\n   * ```\n   */\n  format(options: FormatOptions = DEFAULT_FORMAT_OPTIONS): string {\n    const format = new NumberFormatter(\n      options.allowAbbreviation === undefined ? DEFAULT_FORMAT_OPTIONS.allowAbbreviation : options.allowAbbreviation,\n      options.maxAbbreviationError || 0,\n      options.fixedDigits,\n    )\n    return format.allowAbbreviation ? this.toStringAllowSingleValue(format) : this.toStringBothValues(format)\n  }\n\n  /**\n   * Returns a compact string representing this Complex number.\n   *\n   * @returns A string representing this complex number.\n   * @example\n   * ```\n   * new Complex(1, 2).toString() // '1+2i'\n   * new Complex(Math.sqrt(1 / 2), -1 / 3).toString() // '\u221A\u00BD-\u2153i'\n   * ```\n   */\n  toString(): string {\n    const formatter = new NumberFormatter(\n      DEFAULT_FORMAT_OPTIONS.allowAbbreviation,\n      DEFAULT_FORMAT_OPTIONS.maxAbbreviationError,\n      DEFAULT_FORMAT_OPTIONS.fixedDigits,\n    )\n    return this.toStringAllowSingleValue(formatter)\n  }\n\n  // log(c) = ln|c| + arg(c)i\n  private ln(): Complex {\n    return new Complex(Math.log(this.abs()), this.arg())\n  }\n\n  // If a complex number has only real or imaginary parts,\n  // convert it to a string with only real or imaginary parts, such as '\u2153' or '-3i'.\n  private toStringAllowSingleValue(formatter: NumberFormatter): string {\n    if (this.canImagPartBeOmitted(formatter.maxAbbreviationError)) {\n      return formatter.format(this.real)\n    }\n\n    if (this.canRealPartBeOmitted(formatter.maxAbbreviationError)) {\n      let imagFactor\n\n      if (this.isImagFactorCloseToOne(formatter.maxAbbreviationError)) {\n        imagFactor = ''\n      } else if (this.isImagFactorMinusOne(formatter.maxAbbreviationError)) {\n        imagFactor = '-'\n      } else {\n        imagFactor = formatter.format(this.imag)\n      }\n\n      return `${imagFactor}i`\n    }\n\n    return this.toStringBothValues(formatter)\n  }\n\n  // Convert a complex number whose real and imaginary parts are not both zero into a string like '\u2153-3i'.\n  private toStringBothValues(formatter: NumberFormatter): string {\n    const imagSign = this.imag >= 0 ? '+' : '-'\n    const imagFactor = this.canImagFactorBeOmitted(formatter) ? '' : formatter.format(Math.abs(this.imag))\n    const realPlusSign = formatter.allowAbbreviation || formatter.fixedDigits === undefined || this.real < 0 ? '' : '+'\n\n    return `${realPlusSign + formatter.format(this.real) + imagSign + imagFactor}i`\n  }\n\n  // Returns whether the real part of a complex number can be omitted.\n  private canRealPartBeOmitted(maxAbbreviationError: number): boolean {\n    return Math.abs(this.real) <= maxAbbreviationError\n  }\n\n  // Returns whether the imaginary part of a complex number can be omitted.\n  private canImagPartBeOmitted(maxAbbreviationError: number): boolean {\n    return Math.abs(this.imag) <= maxAbbreviationError\n  }\n\n  // Returns whether the imaginary part of a complex number is close to 1.\n  private isImagFactorCloseToOne(maxAbbreviationError: number): boolean {\n    return Math.abs(this.imag - 1) <= maxAbbreviationError\n  }\n\n  // Returns whether the imaginary part of a complex number is close to -1.\n  private isImagFactorMinusOne(maxAbbreviationError: number): boolean {\n    return Math.abs(this.imag + 1) <= maxAbbreviationError\n  }\n\n  // Returns true if the factor of the imaginary part can be omitted, such as i or -i.\n  private canImagFactorBeOmitted(formatter: NumberFormatter): boolean {\n    return formatter.allowAbbreviation && Math.abs(Math.abs(this.imag) - 1) <= formatter.maxAbbreviationError\n  }\n}\n", "export const Config = {\n  MAX_QUBIT_COUNT: 16,\n} as const\n", "/**\n * Emit a custom event\n *\n * @param type    The event type\n * @param detail  Any details to pass along with the event\n * @param element The element to attach the event to\n */\nexport function emitEvent(type: string, detail = {}, element: Node = document): boolean {\n  const event = new CustomEvent(type, {\n    bubbles: true,\n    cancelable: true,\n    detail,\n  })\n\n  return element.dispatchEvent(event)\n}\n", "import {Config} from './config'\n\nexport type CreateArrayWithLengthX<LENGTH extends number, ACC extends unknown[] = []> = ACC['length'] extends LENGTH\n  ? ACC\n  : CreateArrayWithLengthX<LENGTH, [...ACC, 1]>\n\nexport type NumericRange<\n  START_ARR extends number[],\n  END extends number,\n  ACC extends number = never,\n> = START_ARR['length'] extends END ? ACC | END : NumericRange<[...START_ARR, 1], END, ACC | START_ARR['length']>\n\nexport type ResizeableSpan = NumericRange<CreateArrayWithLengthX<1>, typeof Config.MAX_QUBIT_COUNT>\n\nexport const isResizeableSpan = (arg: unknown): arg is ResizeableSpan =>\n  typeof arg == 'number' && 1 <= arg && arg <= Config.MAX_QUBIT_COUNT\n", "/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Result} from 'neverthrow'\n\ntype ParseError = {message: string}\nconst toParseError = (): ParseError => ({message: 'Parse Error'})\n\nexport class Util {\n  static need(expression: boolean, message: string, args?: unknown[]): asserts expression {\n    if (expression !== true) {\n      const argDesc = args === undefined ? '(not provided)' : `[${Array.prototype.slice.call(args).join(', ')}]`\n      const msgDesc = message === undefined ? '(not provided)' : message\n      const msg = `Precondition failed\\n\\nMessage: ${msgDesc}\\n\\nArgs: ${argDesc}`\n      throw new Error(msg)\n    }\n  }\n\n  static notNull<T>(v: T): asserts v is NonNullable<T> {\n    Util.need(v !== null && v !== undefined, 'notNull')\n  }\n\n  // \u73FE\u5728\u306E URL \u3092\u30D1\u30FC\u30B9\u3057\u3001\u6700\u5F8C\u306E / \u4EE5\u964D\u3092\u30C7\u30B3\u30FC\u30C9\u3057\u305F\u3082\u306E\u3092\u8FD4\u3059\n  static get urlJson(): string {\n    const url = new URL(location.href, window.location.origin)\n    const path = decodeURIComponent(url.pathname)\n    const lastSlashIndex = path.lastIndexOf('/')\n\n    return path.substring(lastSlashIndex + 1)\n  }\n\n  static safeJsonParse = Result.fromThrowable(JSON.parse, toParseError)\n}\n", "export const SerializedAntiControlGateType = '\u25E6'\n\nexport type SerializedAntiControlGate = {\n  type: typeof SerializedAntiControlGateType\n  targets: number[]\n}\n", "export const SerializedBlochDisplayType = 'Bloch'\n\nexport type SerializedBlochDisplay = {\n  type: typeof SerializedBlochDisplayType\n  targets: number[]\n}\n", "export const SerializedControlGateType = '\u2022'\n\nexport type SerializedControlGate = {\n  type: typeof SerializedControlGateType\n  targets: number[]\n}\n", "export const SerializedHGateType = 'H'\n\nexport type SerializedHGate = {\n  type: typeof SerializedHGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedMeasurementGateType = 'Measure'\n\nexport type SerializedMeasurementGate = {\n  type: typeof SerializedMeasurementGateType\n  targets: number[]\n  flag?: string\n}\n", "export const SerializedPhaseGateType = 'P'\n\nexport type SerializedPhaseGate = {\n  type: typeof SerializedPhaseGateType\n  angle?: string\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "import {ResizeableSpan} from './numeric-range'\n\nexport const SerializedQftDaggerGateType = 'QFT\u2020'\n\nexport type SerializedQftDaggerGate = {\n  type: typeof SerializedQftDaggerGateType\n  span: ResizeableSpan\n  targets: number[]\n}\n", "import {ResizeableSpan} from './numeric-range'\n\nexport const SerializedQftGateType = 'QFT'\n\nexport type SerializedQftGate = {\n  type: typeof SerializedQftGateType\n  span: ResizeableSpan\n  targets: number[]\n}\n", "export const SerializedRnotGateType = 'X^\u00BD'\n\nexport type SerializedRnotGate = {\n  type: typeof SerializedRnotGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedRxGateType = 'Rx'\n\nexport type SerializedRxGate = {\n  type: typeof SerializedRxGateType\n  targets: number[]\n  angle?: string\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedRyGateType = 'Ry'\n\nexport type SerializedRyGate = {\n  type: typeof SerializedRyGateType\n  targets: number[]\n  angle?: string\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedRzGateType = 'Rz'\n\nexport type SerializedRzGate = {\n  type: typeof SerializedRzGateType\n  targets: number[]\n  angle?: string\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedSDaggerGateType = 'S\u2020'\n\nexport type SerializedSDaggerGate = {\n  type: typeof SerializedSDaggerGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedSGateType = 'S'\n\nexport type SerializedSGate = {\n  type: typeof SerializedSGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedSpacerGateType = '\u2026'\n\nexport type SerializedSpacerGate = {\n  type: typeof SerializedSpacerGateType\n  targets: number[]\n}\n", "export const SerializedSwapGateType = 'Swap'\n\nexport type SerializedSwapGate = {\n  type: typeof SerializedSwapGateType\n  targets: [number, number]\n  controls?: number[]\n  antiControls?: number[]\n}\n", "export const SerializedTDaggerGateType = 'T\u2020'\n\nexport type SerializedTDaggerGate = {\n  type: typeof SerializedTDaggerGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedTGateType = 'T'\n\nexport type SerializedTGate = {\n  type: typeof SerializedTGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedWrite0GateType = '|0>'\nexport const SerializedWrite1GateType = '|1>'\n\nexport type SerializedWriteGate = {\n  type: typeof SerializedWrite0GateType | typeof SerializedWrite1GateType\n  targets: number[]\n}\n", "export const SerializedXGateType = 'X'\n\nexport type SerializedXGate = {\n  type: typeof SerializedXGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedYGateType = 'Y'\n\nexport type SerializedYGate = {\n  type: typeof SerializedYGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "export const SerializedZGateType = 'Z'\n\nexport type SerializedZGate = {\n  type: typeof SerializedZGateType\n  targets: number[]\n  controls?: number[]\n  antiControls?: number[]\n  if?: string\n}\n", "/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nfunction __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nfunction __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nfunction __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\n\nvar defaultErrorConfig = {\r\n    withStackTrace: false\r\n};\r\n// Custom error object\r\n// Context / discussion: https://github.com/supermacro/neverthrow/pull/215\r\nvar createNeverThrowError = function (message, result, config) {\r\n    if (config === void 0) { config = defaultErrorConfig; }\r\n    var data = result.isOk()\r\n        ? { type: 'Ok', value: result.value }\r\n        : { type: 'Err', value: result.error };\r\n    var maybeStack = config.withStackTrace ? new Error().stack : undefined;\r\n    return {\r\n        data: data,\r\n        message: message,\r\n        stack: maybeStack\r\n    };\r\n};\n\nvar ResultAsync = /** @class */ (function () {\r\n    function ResultAsync(res) {\r\n        this._promise = res;\r\n    }\r\n    ResultAsync.fromSafePromise = function (promise) {\r\n        var newPromise = promise.then(function (value) { return new Ok(value); });\r\n        return new ResultAsync(newPromise);\r\n    };\r\n    ResultAsync.fromPromise = function (promise, errorFn) {\r\n        var newPromise = promise\r\n            .then(function (value) { return new Ok(value); })[\"catch\"](function (e) { return new Err(errorFn(e)); });\r\n        return new ResultAsync(newPromise);\r\n    };\r\n    ResultAsync.combine = function (asyncResultList) {\r\n        return combineResultAsyncList(asyncResultList);\r\n    };\r\n    ResultAsync.combineWithAllErrors = function (asyncResultList) {\r\n        return combineResultAsyncListWithAllErrors(asyncResultList);\r\n    };\r\n    ResultAsync.prototype.map = function (f) {\r\n        var _this = this;\r\n        return new ResultAsync(this._promise.then(function (res) { return __awaiter(_this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (res.isErr()) {\r\n                            return [2 /*return*/, new Err(res.error)];\r\n                        }\r\n                        _a = Ok.bind;\r\n                        return [4 /*yield*/, f(res.value)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(Ok, [void 0, _b.sent()]))()];\r\n                }\r\n            });\r\n        }); }));\r\n    };\r\n    ResultAsync.prototype.mapErr = function (f) {\r\n        var _this = this;\r\n        return new ResultAsync(this._promise.then(function (res) { return __awaiter(_this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (res.isOk()) {\r\n                            return [2 /*return*/, new Ok(res.value)];\r\n                        }\r\n                        _a = Err.bind;\r\n                        return [4 /*yield*/, f(res.error)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(Err, [void 0, _b.sent()]))()];\r\n                }\r\n            });\r\n        }); }));\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\r\n    ResultAsync.prototype.andThen = function (f) {\r\n        return new ResultAsync(this._promise.then(function (res) {\r\n            if (res.isErr()) {\r\n                return new Err(res.error);\r\n            }\r\n            var newValue = f(res.value);\r\n            return newValue instanceof ResultAsync ? newValue._promise : newValue;\r\n        }));\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\r\n    ResultAsync.prototype.orElse = function (f) {\r\n        var _this = this;\r\n        return new ResultAsync(this._promise.then(function (res) { return __awaiter(_this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                if (res.isErr()) {\r\n                    return [2 /*return*/, f(res.error)];\r\n                }\r\n                return [2 /*return*/, new Ok(res.value)];\r\n            });\r\n        }); }));\r\n    };\r\n    ResultAsync.prototype.match = function (ok, _err) {\r\n        return this._promise.then(function (res) { return res.match(ok, _err); });\r\n    };\r\n    ResultAsync.prototype.unwrapOr = function (t) {\r\n        return this._promise.then(function (res) { return res.unwrapOr(t); });\r\n    };\r\n    // Makes ResultAsync implement PromiseLike<Result>\r\n    ResultAsync.prototype.then = function (successCallback, failureCallback) {\r\n        return this._promise.then(successCallback, failureCallback);\r\n    };\r\n    return ResultAsync;\r\n}());\r\nvar okAsync = function (value) {\r\n    return new ResultAsync(Promise.resolve(new Ok(value)));\r\n};\r\nvar errAsync = function (err) {\r\n    return new ResultAsync(Promise.resolve(new Err(err)));\r\n};\r\nvar fromPromise = ResultAsync.fromPromise;\r\nvar fromSafePromise = ResultAsync.fromSafePromise;\n\nvar appendValueToEndOfList = function (value) { return function (list) { return __spreadArray(__spreadArray([], __read(list), false), [value], false); }; };\r\n/**\r\n * Short circuits on the FIRST Err value that we find\r\n */\r\nvar combineResultList = function (resultList) {\r\n    return resultList.reduce(function (acc, result) {\r\n        return acc.isOk()\r\n            ? result.isErr()\r\n                ? err(result.error)\r\n                : acc.map(appendValueToEndOfList(result.value))\r\n            : acc;\r\n    }, ok([]));\r\n};\r\n/* This is the typesafe version of Promise.all\r\n *\r\n * Takes a list of ResultAsync<T, E> and success if all inner results are Ok values\r\n * or fails if one (or more) of the inner results are Err values\r\n */\r\nvar combineResultAsyncList = function (asyncResultList) {\r\n    return ResultAsync.fromSafePromise(Promise.all(asyncResultList)).andThen(combineResultList);\r\n};\r\n/**\r\n * Give a list of all the errors we find\r\n */\r\nvar combineResultListWithAllErrors = function (resultList) {\r\n    return resultList.reduce(function (acc, result) {\r\n        return result.isErr()\r\n            ? acc.isErr()\r\n                ? err(__spreadArray(__spreadArray([], __read(acc.error), false), [result.error], false))\r\n                : err([result.error])\r\n            : acc.isErr()\r\n                ? acc\r\n                : ok(__spreadArray(__spreadArray([], __read(acc.value), false), [result.value], false));\r\n    }, ok([]));\r\n};\r\nvar combineResultAsyncListWithAllErrors = function (asyncResultList) {\r\n    return ResultAsync.fromSafePromise(Promise.all(asyncResultList)).andThen(combineResultListWithAllErrors);\r\n};\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\r\nvar Result;\r\n(function (Result) {\r\n    /**\r\n     * Wraps a function with a try catch, creating a new function with the same\r\n     * arguments but returning `Ok` if successful, `Err` if the function throws\r\n     *\r\n     * @param fn function to wrap with ok on success or err on failure\r\n     * @param errorFn when an error is thrown, this will wrap the error result if provided\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    function fromThrowable(fn, errorFn) {\r\n        return function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            try {\r\n                var result = fn.apply(void 0, __spreadArray([], __read(args), false));\r\n                return ok(result);\r\n            }\r\n            catch (e) {\r\n                return err(errorFn ? errorFn(e) : e);\r\n            }\r\n        };\r\n    }\r\n    Result.fromThrowable = fromThrowable;\r\n    function combine(resultList) {\r\n        return combineResultList(resultList);\r\n    }\r\n    Result.combine = combine;\r\n    function combineWithAllErrors(resultList) {\r\n        return combineResultListWithAllErrors(resultList);\r\n    }\r\n    Result.combineWithAllErrors = combineWithAllErrors;\r\n})(Result || (Result = {}));\r\nvar ok = function (value) { return new Ok(value); };\r\nvar err = function (err) { return new Err(err); };\r\nvar Ok = /** @class */ (function () {\r\n    function Ok(value) {\r\n        this.value = value;\r\n    }\r\n    Ok.prototype.isOk = function () {\r\n        return true;\r\n    };\r\n    Ok.prototype.isErr = function () {\r\n        return !this.isOk();\r\n    };\r\n    Ok.prototype.map = function (f) {\r\n        return ok(f(this.value));\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    Ok.prototype.mapErr = function (_f) {\r\n        return ok(this.value);\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\r\n    Ok.prototype.andThen = function (f) {\r\n        return f(this.value);\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\r\n    Ok.prototype.orElse = function (_f) {\r\n        return ok(this.value);\r\n    };\r\n    Ok.prototype.asyncAndThen = function (f) {\r\n        return f(this.value);\r\n    };\r\n    Ok.prototype.asyncMap = function (f) {\r\n        return ResultAsync.fromSafePromise(f(this.value));\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    Ok.prototype.unwrapOr = function (_v) {\r\n        return this.value;\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    Ok.prototype.match = function (ok, _err) {\r\n        return ok(this.value);\r\n    };\r\n    Ok.prototype._unsafeUnwrap = function (_) {\r\n        return this.value;\r\n    };\r\n    Ok.prototype._unsafeUnwrapErr = function (config) {\r\n        throw createNeverThrowError('Called `_unsafeUnwrapErr` on an Ok', this, config);\r\n    };\r\n    return Ok;\r\n}());\r\nvar Err = /** @class */ (function () {\r\n    function Err(error) {\r\n        this.error = error;\r\n    }\r\n    Err.prototype.isOk = function () {\r\n        return false;\r\n    };\r\n    Err.prototype.isErr = function () {\r\n        return !this.isOk();\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    Err.prototype.map = function (_f) {\r\n        return err(this.error);\r\n    };\r\n    Err.prototype.mapErr = function (f) {\r\n        return err(f(this.error));\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\r\n    Err.prototype.andThen = function (_f) {\r\n        return err(this.error);\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\r\n    Err.prototype.orElse = function (f) {\r\n        return f(this.error);\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    Err.prototype.asyncAndThen = function (_f) {\r\n        return errAsync(this.error);\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    Err.prototype.asyncMap = function (_f) {\r\n        return errAsync(this.error);\r\n    };\r\n    Err.prototype.unwrapOr = function (v) {\r\n        return v;\r\n    };\r\n    Err.prototype.match = function (_ok, err) {\r\n        return err(this.error);\r\n    };\r\n    Err.prototype._unsafeUnwrap = function (config) {\r\n        throw createNeverThrowError('Called `_unsafeUnwrap` on an Err', this, config);\r\n    };\r\n    Err.prototype._unsafeUnwrapErr = function (_) {\r\n        return this.error;\r\n    };\r\n    return Err;\r\n}());\r\nvar fromThrowable = Result.fromThrowable;\r\n//#endregion\n\nexport { Err, Ok, Result, ResultAsync, err, errAsync, fromPromise, fromSafePromise, fromThrowable, ok, okAsync };\n", "import { Simulator } from '@qni/simulator'\nimport { Util } from '@qni/common'\n\nlet resultCache = {}\n\nfunction runSimulator(e) {\n  const circuitJson = e.data.circuitJson\n  const qubitCount = e.data.qubitCount\n  const stepIndex = e.data.stepIndex\n  const steps = e.data.steps\n  const targets = e.data.targets\n  const invalidateCaches = e.data.invalidateCaches\n  const simulator = new Simulator('0'.repeat(qubitCount))\n\n  Util.notNull(qubitCount)\n  Util.notNull(stepIndex)\n  Util.notNull(steps)\n  Util.notNull(targets)\n\n  // const s_time = new Date()\n\n  if (resultCache[circuitJson] === undefined || invalidateCaches) {\n    resultCache = {}\n    resultCache[circuitJson] = {}\n  }\n\n  // let cacheHit = false\n\n  for (const [i, operations] of steps.entries()) {\n    let stepResult = {}\n\n    if (resultCache[circuitJson][i] === undefined) {\n      resultCache[circuitJson][i] = {}\n    }\n    const cachedStepResult = resultCache[circuitJson][i]\n\n    if (\n      cachedStepResult === undefined ||\n      cachedStepResult.targets === undefined ||\n      cachedStepResult.targets.length < targets.length\n    ) {\n      // cacheHit = false\n\n      simulator.runStep(operations)\n\n      const allAmplitudes = simulator.state.matrix.clone()\n      const blochVectors = Object.assign({}, simulator.blochVectors)\n      const measuredBits = Object.assign({}, simulator.measuredBits)\n      const flags = Object.assign({}, simulator.flags)\n\n      resultCache[circuitJson][i] = {\n        type: 'step',\n        step: i,\n        amplitudes: allAmplitudes,\n        targets,\n        blochVectors,\n        measuredBits,\n        flags,\n      }\n\n      if (i === stepIndex) {\n        const amplitudes = pickTargetAmplitudes(targets, allAmplitudes)\n\n        stepResult = {\n          type: 'step',\n          step: i,\n          amplitudes,\n          blochVectors,\n          measuredBits,\n          flags,\n        }\n      } else {\n        stepResult = {\n          type: 'step',\n          step: i,\n          amplitudes: [],\n          blochVectors,\n          measuredBits,\n          flags,\n        }\n      }\n    } else {\n      // cacheHit = true\n\n      stepResult = {\n        type: 'step',\n        step: i,\n        amplitudes: [],\n        blochVectors: cachedStepResult.blochVectors,\n        measuredBits: cachedStepResult.measuredBits,\n        flags: cachedStepResult.flags,\n      }\n\n      if (i === stepIndex) {\n        stepResult.amplitudes = pickTargetAmplitudes(targets, cachedStepResult.amplitudes)\n      }\n    }\n\n    self.postMessage(stepResult)\n  }\n\n  // const e_time = new Date()\n  // const diff = e_time.getTime() - s_time.getTime()\n  // const cacheDesc = cacheHit ? \"\uD83C\uDFAF CACHE HIT\" : \"\uD83D\uDCA6 CACHE MISS\"\n  // console.log(`\u23F1 simulation took ${diff} msec (${cacheDesc})`)\n\n  self.postMessage({ type: 'finish' })\n}\n\nconst pickTargetAmplitudes = (targets, amplitudes) => {\n  return targets.reduce((map, each) => {\n    if (each >= amplitudes.height) {\n      map[each] = [0, 0]\n    } else {\n      const c = amplitudes.element(each, 0).value\n      map[each] = [c.real, c.imag]\n    }\n    return map\n  }, {})\n}\n\nself.addEventListener('message', runSimulator)\n"],
  "mappings": "imBAAA,IAAAA,GAAAC,GAAA,CAAAC,GAAAC,KAAA,EAuCC,SAASC,EAAM,CAEd,aAKA,IAAIC,EAAgB,IAGhBC,EAAI,CACN,EAAK,EACL,EAAK,EACL,EAAK,CACP,EAEA,SAASC,EAAOC,EAAGC,EAAG,CAEpB,GAAI,MAAMD,EAAI,SAASA,EAAG,EAAE,CAAC,EAC3B,MAAME,EAAS,iBAEjB,OAAOF,EAAIC,CACb,CANSE,EAAAJ,EAAA,UAST,SAASK,EAAYJ,EAAGK,EAAG,CAEzB,GAAIA,IAAM,EACR,MAAMH,EAAS,eAGjB,IAAII,EAAI,OAAO,OAAOJ,EAAS,SAAS,EACxCI,EAAE,EAAON,EAAI,EAAI,GAAK,EAEtBA,EAAIA,EAAI,EAAI,CAACA,EAAIA,EAEjB,IAAIO,EAAIC,EAAIR,EAAGK,CAAC,EAEhB,OAAAC,EAAE,EAAON,EAAIO,EACbD,EAAE,EAAOD,EAAIE,EACND,CACT,CAhBSH,EAAAC,EAAA,eAkBT,SAASK,EAAUC,EAAK,CAQtB,QANIC,EAAU,CAAC,EAEXX,EAAIU,EACJE,EAAI,EACJX,EAAI,EAEDA,GAAKD,GAAG,CAEb,KAAOA,EAAIY,IAAM,GACfZ,GAAIY,EACJD,EAAQC,CAAC,GAAKD,EAAQC,CAAC,GAAK,GAAK,EAEnCX,GAAI,EAAI,EAAIW,GACd,CAEA,OAAIZ,IAAMU,EACJV,EAAI,IACNW,EAAQX,CAAC,GAAKW,EAAQX,CAAC,GAAK,GAAK,GAEnCW,EAAQD,CAAG,GAAKC,EAAQD,CAAG,GAAK,GAAK,EAEhCC,CACT,CAxBSR,EAAAM,EAAA,aA0BT,IAAII,EAAQV,EAAA,SAASW,EAAIC,EAAI,CAE3B,IAAIf,EAAI,EAAGK,EAAI,EAAGJ,EAAI,EAClBe,EAAI,EAAGC,EAAI,EAAGC,EAAI,EAAGC,EAAI,EAAGC,EAAI,EAEhCC,EAAI,EAAGC,EAAI,EACXC,EAAI,EAAGC,EAAI,EAEXC,EAAI,IACJC,EAEJ,GAAwBZ,GAAO,KAExB,GAAIC,IAAO,QAKhB,GAJAf,EAAIc,EACJT,EAAIU,EACJd,EAAID,EAAIK,EAEJL,EAAI,IAAM,GAAKK,EAAI,IAAM,EAC3B,MAAMH,EAAS,wBAIjB,QAAQ,OAAOY,EAAI,CAEjB,IAAK,SACH,CACE,GAAI,MAAOA,GAAM,MAAOA,EACtBd,EAAIc,EAAG,EACPT,EAAIS,EAAG,EACH,MAAOA,IACTd,GAAIc,EAAG,WACA,KAAKA,EACdd,EAAIc,EAAG,CAAC,EACJ,KAAKA,IACPT,EAAIS,EAAG,CAAC,OAEV,OAAMZ,EAAS,iBAEjBD,EAAID,EAAIK,EACR,KACF,CACF,IAAK,SACH,CAME,GALIS,EAAK,IACPb,EAAIa,EACJA,EAAK,CAACA,GAGJA,EAAK,IAAM,EACbd,EAAIc,UACKA,EAAK,EAAG,CAUjB,IARIA,GAAM,IACRM,EAAI,KAAK,IAAI,GAAI,KAAK,MAAM,EAAI,KAAK,IAAIN,CAAE,EAAI,KAAK,IAAI,CAAC,EACzDA,GAAKM,GAMAE,GAAKG,GAAKD,GAAKC,GAGpB,GAFAC,GAAKL,EAAIE,IAAMD,EAAIE,GAEfV,IAAOY,EAAG,CACRJ,EAAIE,GAAKC,GACXzB,EAAIqB,EAAIE,EACRlB,EAAIiB,EAAIE,GACCA,EAAIF,GACbtB,EAAIuB,EACJlB,EAAImB,IAEJxB,EAAIqB,EACJhB,EAAIiB,GAEN,KAEF,MAEMR,EAAKY,GACPL,GAAIE,EACJD,GAAIE,IAEJD,GAAIF,EACJG,GAAIF,GAGFA,EAAIG,GACNzB,EAAIuB,EACJlB,EAAImB,IAEJxB,EAAIqB,EACJhB,EAAIiB,GAIVtB,GAAIoB,CACN,MAAW,MAAMN,CAAE,GAAK,MAAMC,CAAE,KAC9BV,EAAIL,EAAI,KAEV,KACF,CACF,IAAK,SACH,CAGE,GAFAsB,EAAIR,EAAG,MAAM,QAAQ,EAEjBQ,IAAM,KACR,MAAMpB,EAAS,iBA2CjB,GAzCIoB,EAAED,CAAC,IAAM,KACXpB,EAAI,GACJoB,KACSC,EAAED,CAAC,IAAM,KAClBA,IAGEC,EAAE,SAAWD,EAAI,EACnBJ,EAAIlB,EAAOuB,EAAED,GAAG,EAAGpB,CAAC,EACXqB,EAAED,EAAI,CAAC,IAAM,KAAOC,EAAED,CAAC,IAAM,KAElCC,EAAED,CAAC,IAAM,MACXL,EAAIjB,EAAOuB,EAAED,GAAG,EAAGpB,CAAC,GAEtBoB,KAGIA,EAAI,IAAMC,EAAE,QAAUA,EAAED,EAAI,CAAC,IAAM,KAAOC,EAAED,EAAI,CAAC,IAAM,KAAOC,EAAED,EAAI,CAAC,IAAM,KAAOC,EAAED,EAAI,CAAC,IAAM,OACjGJ,EAAIlB,EAAOuB,EAAED,CAAC,EAAGpB,CAAC,EAClBkB,EAAI,KAAK,IAAI,GAAIG,EAAED,CAAC,EAAE,MAAM,EAC5BA,MAIEC,EAAED,CAAC,IAAM,KAAOC,EAAED,EAAI,CAAC,IAAM,KAAOC,EAAED,CAAC,IAAM,KAAOC,EAAED,EAAI,CAAC,IAAM,OACnEH,EAAInB,EAAOuB,EAAED,EAAI,CAAC,EAAGpB,CAAC,EACtBmB,EAAI,KAAK,IAAI,GAAIE,EAAED,EAAI,CAAC,EAAE,MAAM,EAAI,EACpCA,GAAI,IAGGC,EAAED,EAAI,CAAC,IAAM,KAAOC,EAAED,EAAI,CAAC,IAAM,KAC1CJ,EAAIlB,EAAOuB,EAAED,CAAC,EAAGpB,CAAC,EAClBkB,EAAIpB,EAAOuB,EAAED,EAAI,CAAC,EAAG,CAAC,EACtBA,GAAI,GACKC,EAAED,EAAI,CAAC,IAAM,KAAOC,EAAED,EAAI,CAAC,IAAM,MAC1CL,EAAIjB,EAAOuB,EAAED,CAAC,EAAGpB,CAAC,EAClBgB,EAAIlB,EAAOuB,EAAED,EAAI,CAAC,EAAGpB,CAAC,EACtBkB,EAAIpB,EAAOuB,EAAED,EAAI,CAAC,EAAG,CAAC,EACtBA,GAAI,GAGFC,EAAE,QAAUD,EAAG,CACjBhB,EAAIc,EAAIC,EACRnB,EACAD,EAAIkB,EAAIb,EAAIW,EAAII,EAAIH,EACpB,KACF,CAGF,CACF,QACE,MAAMf,EAAS,gBACnB,CAEF,GAAIG,IAAM,EACR,MAAMH,EAAS,eAGjBJ,EAAE,EAAOG,EAAI,EAAI,GAAK,EACtBH,EAAE,EAAO,KAAK,IAAIE,CAAC,EACnBF,EAAE,EAAO,KAAK,IAAIO,CAAC,CACrB,EA1KY,SA4KZ,SAASsB,EAAOC,EAAGC,EAAGC,EAAG,CAGvB,QADIC,EAAI,EACDF,EAAI,EAAGD,EAAKA,EAAIA,EAAKE,EAAGD,IAAM,EAE/BA,EAAI,IACNE,EAAKA,EAAIH,EAAKE,GAGlB,OAAOC,CACT,CAVS5B,EAAAwB,EAAA,UAaT,SAASK,EAAShC,EAAGK,EAAG,CAEtB,KAAOA,EAAI,IAAM,EACfA,GAAI,EAAG,CAGT,KAAOA,EAAI,IAAM,EACfA,GAAI,EAAG,CAGT,GAAIA,IAAM,EACR,MAAO,GAUT,QAHI4B,EAAM,GAAK5B,EACX6B,EAAI,EAEDD,IAAQ,EAAGC,IAGhB,GAFAD,EAAMA,EAAM,GAAK5B,EAEb6B,EAAIrC,EACN,MAAO,GAEX,OAAOqC,CACT,CA5BS/B,EAAA6B,EAAA,YA+BT,SAASG,EAAWnC,EAAGK,EAAG+B,EAAK,CAK7B,QAHIC,EAAO,EACPC,EAAOX,EAAO,GAAIS,EAAK/B,CAAC,EAEnB6B,EAAI,EAAGA,EAAI,IAAKA,IAAK,CAG5B,GAAIG,IAASC,EACX,OAAOJ,EAETG,EAAOA,EAAO,GAAKhC,EACnBiC,EAAOA,EAAO,GAAKjC,CACrB,CACA,MAAO,EACT,CAfSF,EAAAgC,EAAA,cAiBT,SAAS3B,EAAID,EAAGqB,EAAG,CAEjB,GAAI,CAACrB,EACH,OAAOqB,EACT,GAAI,CAACA,EACH,OAAOrB,EAET,OAAU,CAER,GADAA,GAAIqB,EACA,CAACrB,EACH,OAAOqB,EAET,GADAA,GAAIrB,EACA,CAACqB,EACH,OAAOrB,CACX,CACF,CAfSJ,EAAAK,EAAA,OAwBT,SAASN,EAASK,EAAGqB,EAAG,CAItB,GAFAf,EAAMN,EAAGqB,CAAC,EAEN,gBAAgB1B,EAClBK,EAAIC,EAAIV,EAAE,EAAMA,EAAE,CAAI,EACtB,KAAK,EAAOA,EAAE,EACd,KAAK,EAAOA,EAAE,EAAOS,EACrB,KAAK,EAAOT,EAAE,EAAOS,MAErB,QAAOH,EAAYN,EAAE,EAAOA,EAAE,EAAMA,EAAE,CAAI,CAE9C,CAZSK,EAAAD,EAAA,YAcTA,EAAS,eAAoB,IAAI,MAAM,kBAAkB,EACzDA,EAAS,iBAAsB,IAAI,MAAM,kBAAkB,EAC3DA,EAAS,oBAAyB,IAAI,MAAM,4BAA4B,EAExEA,EAAS,UAAY,CAEnB,EAAK,EACL,EAAK,EACL,EAAK,EAOL,IAAO,UAAW,CAEhB,OAAOE,EAAY,KAAK,EAAM,KAAK,CAAI,CACzC,EAOA,IAAO,UAAW,CAEhB,OAAOA,EAAY,CAAC,KAAK,EAAO,KAAK,EAAM,KAAK,CAAI,CACtD,EAOA,IAAO,SAASG,EAAGqB,EAAG,CAEpB,OAAAf,EAAMN,EAAGqB,CAAC,EACHxB,EACL,KAAK,EAAO,KAAK,EAAON,EAAE,EAAOA,EAAE,EAAO,KAAK,EAAOA,EAAE,EACxD,KAAK,EAAOA,EAAE,CAChB,CACF,EAOA,IAAO,SAASS,EAAGqB,EAAG,CAEpB,OAAAf,EAAMN,EAAGqB,CAAC,EACHxB,EACL,KAAK,EAAO,KAAK,EAAON,EAAE,EAAOA,EAAE,EAAO,KAAK,EAAOA,EAAE,EACxD,KAAK,EAAOA,EAAE,CAChB,CACF,EAOA,IAAO,SAASS,EAAGqB,EAAG,CAEpB,OAAAf,EAAMN,EAAGqB,CAAC,EACHxB,EACL,KAAK,EAAON,EAAE,EAAO,KAAK,EAAOA,EAAE,EACnC,KAAK,EAAOA,EAAE,CAChB,CACF,EAOA,IAAO,SAASS,EAAGqB,EAAG,CAEpB,OAAAf,EAAMN,EAAGqB,CAAC,EACHxB,EACL,KAAK,EAAON,EAAE,EAAO,KAAK,EAAOA,EAAE,EACnC,KAAK,EAAOA,EAAE,CAChB,CACF,EAOA,MAAS,UAAW,CAClB,OAAOM,EAAY,KAAK,EAAO,KAAK,EAAM,KAAK,CAAI,CACrD,EAOA,IAAO,SAASG,EAAGqB,EAAG,CAEpB,GAAI,MAAM,KAAK,CAAI,GAAK,MAAM,KAAK,CAAI,EACrC,OAAO,IAAI1B,EAAS,GAAG,EAGzB,GAAIK,IAAM,OACR,OAAOH,EAAY,KAAK,EAAO,KAAK,EAAO,KAAK,EAAM,CAAC,EAIzD,GADAS,EAAMN,EAAGqB,CAAC,EACA9B,EAAE,IAAR,GAAsB,KAAK,IAAX,EAClB,MAAMI,EAAS,eAiBjB,OAAOE,EACL,KAAK,GAAQN,EAAE,EAAO,KAAK,IAASA,EAAE,EAAO,KAAK,GAClDA,EAAE,EAAO,KAAK,CAChB,CACF,EAOA,IAAO,SAASS,EAAGqB,EAAG,CAEpB,OAAAf,EAAMN,EAAGqB,CAAC,EAIHxB,EAAYI,EAAIV,EAAE,EAAM,KAAK,CAAI,EAAIU,EAAIV,EAAE,EAAM,KAAK,CAAI,EAAGA,EAAE,EAAO,KAAK,CAAI,CACxF,EAOA,IAAO,SAASS,EAAGqB,EAAG,CAMpB,OAJAf,EAAMN,EAAGqB,CAAC,EAIN9B,EAAE,IAAS,GAAK,KAAK,IAAS,EACzBM,EAAY,EAAG,CAAC,EAElBA,EAAYN,EAAE,EAAO,KAAK,EAAMU,EAAIV,EAAE,EAAM,KAAK,CAAI,EAAIU,EAAIV,EAAE,EAAM,KAAK,CAAI,CAAC,CACxF,EAOA,KAAQ,SAASyC,EAAQ,CAIvB,OAFAA,EAAS,KAAK,IAAI,GAAIA,GAAU,CAAC,EAE7B,MAAM,KAAK,CAAI,GAAK,MAAM,KAAK,CAAI,EAC9B,IAAIrC,EAAS,GAAG,EAElBE,EAAY,KAAK,KAAKmC,EAAS,KAAK,EAAO,KAAK,EAAO,KAAK,CAAI,EAAGA,CAAM,CAClF,EAOA,MAAS,SAASA,EAAQ,CAIxB,OAFAA,EAAS,KAAK,IAAI,GAAIA,GAAU,CAAC,EAE7B,MAAM,KAAK,CAAI,GAAK,MAAM,KAAK,CAAI,EAC9B,IAAIrC,EAAS,GAAG,EAElBE,EAAY,KAAK,MAAMmC,EAAS,KAAK,EAAO,KAAK,EAAO,KAAK,CAAI,EAAGA,CAAM,CACnF,EAOA,MAAS,SAASA,EAAQ,CAIxB,OAFAA,EAAS,KAAK,IAAI,GAAIA,GAAU,CAAC,EAE7B,MAAM,KAAK,CAAI,GAAK,MAAM,KAAK,CAAI,EAC9B,IAAIrC,EAAS,GAAG,EAElBE,EAAY,KAAK,MAAMmC,EAAS,KAAK,EAAO,KAAK,EAAO,KAAK,CAAI,EAAGA,CAAM,CACnF,EAOA,QAAW,UAAW,CAEpB,OAAOnC,EAAY,KAAK,EAAO,KAAK,EAAM,KAAK,CAAI,CACrD,EAOA,IAAO,SAASG,EAAGqB,EAAG,CAMpB,GAJAf,EAAMN,EAAGqB,CAAC,EAIN9B,EAAE,IAAS,EAEb,OAAIA,EAAE,EAAO,EACJM,EAAY,KAAK,IAAI,KAAK,EAAO,KAAK,EAAMN,EAAE,CAAI,EAAG,KAAK,IAAI,KAAK,EAAMA,EAAE,CAAI,CAAC,EAEhFM,EAAY,KAAK,IAAI,KAAK,EAAO,KAAK,EAAMN,EAAE,CAAI,EAAG,KAAK,IAAI,KAAK,EAAMA,EAAE,CAAI,CAAC,EAU3F,GAAI,KAAK,EAAO,EAAG,OAAO,KAG1B,IAAI2B,EAAIhB,EAAU,KAAK,CAAI,EACvBe,EAAIf,EAAU,KAAK,CAAI,EAGvBT,EAAI,EACJ,EAAI,EACR,QAASwC,KAAKf,EACZ,GAAIe,IAAM,IACV,IAAIA,IAAM,IAAK,CACbxC,EAAI,EACJ,KACF,CAGA,GAFAyB,EAAEe,CAAC,GAAI1C,EAAE,EAEL2B,EAAEe,CAAC,EAAI1C,EAAE,IAAS,EACpB2B,EAAEe,CAAC,GAAI1C,EAAE,MACJ,QAAO,KACdE,GAAI,KAAK,IAAIwC,EAAGf,EAAEe,CAAC,CAAC,EAGtB,QAASA,KAAKhB,EACZ,GAAIgB,IAAM,IAGV,IAFAhB,EAAEgB,CAAC,GAAI1C,EAAE,EAEL0B,EAAEgB,CAAC,EAAI1C,EAAE,IAAS,EACpB0B,EAAEgB,CAAC,GAAI1C,EAAE,MACJ,QAAO,KACd,GAAI,KAAK,IAAI0C,EAAGhB,EAAEgB,CAAC,CAAC,EAGtB,OAAI1C,EAAE,EAAO,EACJM,EAAY,EAAGJ,CAAC,EAElBI,EAAYJ,EAAG,CAAC,CACzB,EAOA,OAAU,SAASO,EAAGqB,EAAG,CAEvB,OAAAf,EAAMN,EAAGqB,CAAC,EACH,KAAK,EAAO,KAAK,EAAO9B,EAAE,IAASA,EAAE,EAAOA,EAAE,EAAO,KAAK,CACnE,EAOA,QAAW,SAASS,EAAGqB,EAAG,CAExBf,EAAMN,EAAGqB,CAAC,EACV,IAAIM,EAAK,KAAK,EAAO,KAAK,EAAOpC,EAAE,EAAOA,EAAE,EAAOA,EAAE,EAAO,KAAK,EACjE,OAAQ,EAAIoC,IAAMA,EAAI,EACxB,EAEA,SAAY,SAASO,EAAK,CAExB,GAAI,MAAM,KAAK,CAAI,GAAK,MAAM,KAAK,CAAI,EACrC,OAAO,KAGTA,EAAMA,GAAO,KAKb,QAHIC,EAAU,KAAK,IAAO,EACtBC,EAAOD,EAAQ,YAAe,EAEzB9B,EAAI,EAAGA,EAAI+B,EAAK,OAAQ/B,IAAK,CAGpC,QADIX,EAAIG,EAAYuC,EAAK/B,EAAI,CAAC,EAAG,CAAC,EACzB4B,EAAI5B,EAAI,EAAG4B,GAAK,EAAGA,IAC1BvC,EAAIA,EAAE,QAAW,EAAE,IAAO0C,EAAKH,CAAC,CAAC,EAGnC,GAAIvC,EAAE,IAAOyC,CAAO,EAAE,IAAO,EAAE,QAAQ,EAAID,EACzC,OAAOxC,EAAE,IAAO,KAAK,CAAI,CAE7B,CACA,OAAO,IACT,EAOA,UAAa,SAASM,EAAGqB,EAAG,CAE1B,OAAAf,EAAMN,EAAGqB,CAAC,EACH,EAAE,EAAE9B,EAAE,EAAO,KAAK,IAAW,KAAK,EAAOA,EAAE,GAASA,EAAE,EAAO,KAAK,GAC3E,EAOA,QAAW,UAAW,CAEpB,OAAO,KAAK,EAAO,KAAK,EAAO,KAAK,CACtC,EAOA,WAAc,SAAS8C,EAAc,CAEnC,IAAIC,EAAOC,EAAM,GACb9C,EAAI,KAAK,EACTK,EAAI,KAAK,EACb,OAAI,KAAK,EAAO,IACdyC,GAAM,KAGJzC,IAAM,EACRyC,GAAM9C,GAGF4C,IAAiBC,EAAQ,KAAK,MAAM7C,EAAIK,CAAC,GAAK,IAChDyC,GAAMD,EACNC,GAAM,IACN9C,GAAIK,GAGNyC,GAAM9C,EACN8C,GAAM,IACNA,GAAMzC,GAEDyC,CACT,EAOA,QAAW,SAASF,EAAc,CAEhC,IAAIC,EAAOC,EAAM,GACb9C,EAAI,KAAK,EACTK,EAAI,KAAK,EACb,OAAI,KAAK,EAAO,IACdyC,GAAM,KAGJzC,IAAM,EACRyC,GAAM9C,GAGF4C,IAAiBC,EAAQ,KAAK,MAAM7C,EAAIK,CAAC,GAAK,IAChDyC,GAAMD,EACN7C,GAAIK,GAGNyC,GAAM,UACNA,GAAM9C,EACN8C,GAAM,KACNA,GAAMzC,EACNyC,GAAM,KAEDA,CACT,EAOA,YAAe,UAAW,CAExB,IAAIZ,EACA3B,EAAI,KAAK,EACTqB,EAAI,KAAK,EACTmB,EAAM,CAAC,EAEX,GAAI,MAAMxC,CAAC,GAAK,MAAMqB,CAAC,EACrB,OAAOmB,EAGT,GACEA,EAAI,KAAK,KAAK,MAAMxC,EAAIqB,CAAC,CAAC,EAC1BM,EAAI3B,EAAIqB,EACRrB,EAAIqB,EACJA,EAAIM,QACG3B,IAAM,GAEf,OAAOwC,CACT,EAOA,SAAY,SAASC,EAAK,CAExB,IAAIvB,EAAI,KAAK,EACTD,EAAI,KAAK,EAEb,GAAI,MAAMC,CAAC,GAAK,MAAMD,CAAC,EACrB,MAAO,MAGTwB,EAAMA,GAAO,GAEb,IAAIC,EAASjB,EAASP,EAAGD,CAAC,EACtB0B,EAASf,EAAWV,EAAGD,EAAGyB,CAAM,EAEhCH,EAAM,KAAK,EAAO,EAAI,IAAM,GAUhC,GARAA,GAAMrB,EAAID,EAAI,EAEdC,GAAID,EACJC,GAAI,GAEAA,IACFqB,GAAM,KAEJG,EAAQ,CAEV,QAASrC,EAAIsC,EAAQtC,KACnBkC,GAAMrB,EAAID,EAAI,EACdC,GAAID,EACJC,GAAI,GAENqB,GAAM,IACN,QAASlC,EAAIqC,EAAQrC,KACnBkC,GAAMrB,EAAID,EAAI,EACdC,GAAID,EACJC,GAAI,GAENqB,GAAM,GACR,KACE,SAASlC,EAAIoC,EAAKvB,GAAKb,KACrBkC,GAAMrB,EAAID,EAAI,EACdC,GAAID,EACJC,GAAI,GAGR,OAAOqB,CACT,CACF,EAEI,OAAO,QAAW,YAAc,OAAO,IACzC,OAAO,CAAC,EAAG,UAAW,CACpB,OAAO5C,CACT,CAAC,EACQ,OAAOR,IAAY,UAC5B,OAAO,eAAeQ,EAAU,aAAc,CAAE,MAAS,EAAK,CAAC,EAC/DA,EAAS,QAAaA,EACtBA,EAAS,SAAcA,EACvBP,GAAO,QAAaO,GAEpBN,EAAK,SAAcM,CAGvB,GAAGR,EAAI,ICrrBA,IAAIyD,GAASC,EAAA,SAAUC,EAAG,CAAE,OAAO,SAAUC,EAAG,CAGnD,QAFIC,EAAI,KAAK,IAAI,EAAG,KAAK,MAAMD,CAAC,CAAC,EAC7BE,EAAM,CAACH,EAAE,CAAC,CAAC,EACNI,EAAI,EAAGA,EAAIF,EAAGE,IACnBD,EAAI,KAAKH,EAAEI,CAAC,CAAC,EAEjB,OAAOD,CACX,CAAG,EAPiB,UAkCb,IAAIE,GAAQC,EAAA,SAAUC,EAAOC,EAAK,CACrC,OAAOD,GAASC,EAAMC,GAAO,SAAUC,EAAG,CAAE,OAAOH,EAAQG,CAAG,CAAC,EAAEF,EAAMD,EAAQ,CAAC,EAAI,CAACA,CAAK,CAC9F,EAFmB,+hBCvOnBI,GAAAC,GAAA,CAAAC,EAAAC,IAAA,EAuCC,SAASC,EAAM,CAEd,aAKA,IAAIC,EAAgB,IAGhBC,EAAI,CACN,EAAK,EACL,EAAK,EACL,EAAK,CACP,EAEA,SAASC,EAAOC,EAAGC,EAAG,CAEpB,GAAI,MAAMD,EAAI,SAASA,EAAG,EAAE,CAAC,EAC3B,MAAME,EAAS,iBAEjB,OAAOF,EAAIC,CACb,CANSF,EAAAA,EAAAA,KAST,SAASI,EAAYH,EAAGI,EAAG,CAEzB,GAAIA,IAAM,EACR,MAAMF,EAAS,eAGjB,IAAIG,EAAI,OAAO,OAAOH,EAAS,SAAS,EACxCG,EAAE,EAAOL,EAAI,EAAI,GAAK,EAEtBA,EAAIA,EAAI,EAAI,CAACA,EAAIA,EAEjB,IAAIM,EAAIC,EAAIP,EAAGI,CAAC,EAEhB,OAAAC,EAAE,EAAOL,EAAIM,EACbD,EAAE,EAAOD,EAAIE,EACND,CACT,CAhBSF,EAAAA,EAAAA,KAkBT,SAASK,EAAUC,EAAK,CAQtB,QANIC,EAAU,CAAC,EAEXV,EAAIS,EACJE,EAAI,EACJV,EAAI,EAEDA,GAAKD,GAAG,CAEb,KAAOA,EAAIW,IAAM,GACfX,GAAIW,EACJD,EAAQC,CAAC,GAAKD,EAAQC,CAAC,GAAK,GAAK,EAEnCV,GAAI,EAAI,EAAIU,GACd,CAEA,OAAIX,IAAMS,EACJT,EAAI,IACNU,EAAQV,CAAC,GAAKU,EAAQV,CAAC,GAAK,GAAK,GAEnCU,EAAQD,CAAG,GAAKC,EAAQD,CAAG,GAAK,GAAK,EAEhCC,CACT,CAxBSF,EAAAA,EAAAA,KA0BT,IAAII,EAAQC,EAAA,SAASC,EAAIC,EAAI,CAE3B,IAAIf,EAAI,EAAGI,EAAI,EAAGH,EAAI,EAClBe,EAAI,EAAGC,EAAI,EAAGC,EAAI,EAAGC,EAAI,EAAGC,EAAI,EAEhCC,EAAI,EAAGC,EAAI,EACXC,EAAI,EAAGC,EAAI,EAEXC,EAAI,IACJC,GAEJ,GAAwBZ,GAAO,KAExB,GAAIC,IAAO,QAKhB,GAJAf,EAAIc,EACJV,EAAIW,EACJd,EAAID,EAAII,EAEJJ,EAAI,IAAM,GAAKI,EAAI,IAAM,EAC3B,MAAMF,EAAS,wBAIjB,QAAQ,OAAOY,EAAI,CAEjB,IAAK,SACH,CACE,GAAI,MAAOA,GAAM,MAAOA,EACtBd,EAAIc,EAAG,EACPV,EAAIU,EAAG,EACH,MAAOA,IACTd,GAAIc,EAAG,WACA,KAAKA,EACdd,EAAIc,EAAG,CAAC,EACJ,KAAKA,IACPV,EAAIU,EAAG,CAAC,OAEV,OAAMZ,EAAS,iBAEjBD,EAAID,EAAII,EACR,KACF,CACF,IAAK,SACH,CAME,GALIU,EAAK,IACPb,EAAIa,EACJA,EAAK,CAACA,GAGJA,EAAK,IAAM,EACbd,EAAIc,UACKA,EAAK,EAAG,CAUjB,IARIA,GAAM,IACRM,EAAI,KAAK,IAAI,GAAI,KAAK,MAAM,EAAI,KAAK,IAAIN,CAAE,EAAI,KAAK,IAAI,CAAC,EACzDA,GAAKM,GAMAE,GAAKG,GAAKD,GAAKC,GAGpB,GAFAC,IAAKL,EAAIE,IAAMD,EAAIE,GAEfV,IAAOY,GAAG,CACRJ,EAAIE,GAAKC,GACXzB,EAAIqB,EAAIE,EACRnB,EAAIkB,EAAIE,GACCA,EAAIF,GACbtB,EAAIuB,EACJnB,EAAIoB,IAEJxB,EAAIqB,EACJjB,EAAIkB,GAEN,KAEF,MAEMR,EAAKY,IACPL,GAAIE,EACJD,GAAIE,IAEJD,GAAIF,EACJG,GAAIF,GAGFA,EAAIG,GACNzB,EAAIuB,EACJnB,EAAIoB,IAEJxB,EAAIqB,EACJjB,EAAIkB,GAIVtB,GAAIoB,CACN,MAAW,MAAMN,CAAE,GAAK,MAAMC,CAAE,KAC9BX,EAAIJ,EAAI,KAEV,KACF,CACF,IAAK,SACH,CAGE,GAFAsB,EAAIR,EAAG,MAAM,QAAQ,EAEjBQ,IAAM,KACR,MAAMpB,EAAS,iBA2CjB,GAzCIoB,EAAED,CAAC,IAAM,KACXpB,EAAI,GACJoB,KACSC,EAAED,CAAC,IAAM,KAClBA,IAGEC,EAAE,SAAWD,EAAI,EACnBJ,EAAIlB,EAAOuB,EAAED,GAAG,EAAGpB,CAAC,EACXqB,EAAED,EAAI,CAAC,IAAM,KAAOC,EAAED,CAAC,IAAM,KAElCC,EAAED,CAAC,IAAM,MACXL,EAAIjB,EAAOuB,EAAED,GAAG,EAAGpB,CAAC,GAEtBoB,KAGIA,EAAI,IAAMC,EAAE,QAAUA,EAAED,EAAI,CAAC,IAAM,KAAOC,EAAED,EAAI,CAAC,IAAM,KAAOC,EAAED,EAAI,CAAC,IAAM,KAAOC,EAAED,EAAI,CAAC,IAAM,OACjGJ,EAAIlB,EAAOuB,EAAED,CAAC,EAAGpB,CAAC,EAClBkB,EAAI,KAAK,IAAI,GAAIG,EAAED,CAAC,EAAE,MAAM,EAC5BA,MAIEC,EAAED,CAAC,IAAM,KAAOC,EAAED,EAAI,CAAC,IAAM,KAAOC,EAAED,CAAC,IAAM,KAAOC,EAAED,EAAI,CAAC,IAAM,OACnEH,EAAInB,EAAOuB,EAAED,EAAI,CAAC,EAAGpB,CAAC,EACtBmB,EAAI,KAAK,IAAI,GAAIE,EAAED,EAAI,CAAC,EAAE,MAAM,EAAI,EACpCA,GAAI,IAGGC,EAAED,EAAI,CAAC,IAAM,KAAOC,EAAED,EAAI,CAAC,IAAM,KAC1CJ,EAAIlB,EAAOuB,EAAED,CAAC,EAAGpB,CAAC,EAClBkB,EAAIpB,EAAOuB,EAAED,EAAI,CAAC,EAAG,CAAC,EACtBA,GAAI,GACKC,EAAED,EAAI,CAAC,IAAM,KAAOC,EAAED,EAAI,CAAC,IAAM,MAC1CL,EAAIjB,EAAOuB,EAAED,CAAC,EAAGpB,CAAC,EAClBgB,EAAIlB,EAAOuB,EAAED,EAAI,CAAC,EAAGpB,CAAC,EACtBkB,EAAIpB,EAAOuB,EAAED,EAAI,CAAC,EAAG,CAAC,EACtBA,GAAI,GAGFC,EAAE,QAAUD,EAAG,CACjBjB,EAAIe,EAAIC,EACRnB,EACAD,EAAIkB,EAAId,EAAIY,EAAII,EAAIH,EACpB,KACF,CAGF,CACF,QACE,MAAMf,EAAS,gBACnB,CAEF,GAAIE,IAAM,EACR,MAAMF,EAAS,eAGjBJ,EAAE,EAAOG,EAAI,EAAI,GAAK,EACtBH,EAAE,EAAO,KAAK,IAAIE,CAAC,EACnBF,EAAE,EAAO,KAAK,IAAIM,CAAC,CACrB,EA1KY,KA4KZ,SAASuB,EAAOC,EAAGC,EAAGC,EAAG,CAGvB,QADIC,EAAI,EACDF,EAAI,EAAGD,EAAKA,EAAIA,EAAKE,EAAGD,IAAM,EAE/BA,EAAI,IACNE,EAAKA,EAAIH,EAAKE,GAGlB,OAAOC,CACT,CAVSJ,EAAAA,EAAAA,KAaT,SAASK,EAAShC,EAAGI,EAAG,CAEtB,KAAOA,EAAI,IAAM,EACfA,GAAI,EAAG,CAGT,KAAOA,EAAI,IAAM,EACfA,GAAI,EAAG,CAGT,GAAIA,IAAM,EACR,MAAO,GAUT,QAHI6B,EAAM,GAAK7B,EACX8B,EAAI,EAEDD,IAAQ,EAAGC,IAGhB,GAFAD,EAAMA,EAAM,GAAK7B,EAEb8B,EAAIrC,EACN,MAAO,GAEX,OAAOqC,CACT,CA5BSF,EAAAA,OA+BT,SAASG,EAAWnC,EAAGI,EAAGgC,EAAK,CAK7B,QAHIC,EAAO,EACPC,EAAOX,EAAO,GAAIS,EAAKhC,CAAC,EAEnB8B,EAAI,EAAGA,EAAI,IAAKA,IAAK,CAG5B,GAAIG,IAASC,EACX,OAAOJ,EAETG,EAAOA,EAAO,GAAKjC,EACnBkC,EAAOA,EAAO,GAAKlC,CACrB,CACA,MAAO,EACT,CAfS+B,EAAAA,EAAAA,KAiBT,SAAS5B,EAAI,EAAGqB,EAAG,CAEjB,GAAI,CAAC,EACH,OAAOA,EACT,GAAI,CAACA,EACH,OAAO,EAET,OAAU,CAER,GADA,GAAIA,EACA,CAAC,EACH,OAAOA,EAET,GADAA,GAAI,EACA,CAACA,EACH,OAAO,CACX,CACF,CAfSrB,EAAAA,EAAAA,KAwBT,SAASL,EAAS,EAAG0B,EAAG,CAItB,GAFAhB,EAAM,EAAGgB,CAAC,EAEN,gBAAgB1B,EAClB,EAAIK,EAAIT,EAAE,EAAMA,EAAE,CAAI,EACtB,KAAK,EAAOA,EAAE,EACd,KAAK,EAAOA,EAAE,EAAO,EACrB,KAAK,EAAOA,EAAE,EAAO,MAErB,QAAOK,EAAYL,EAAE,EAAOA,EAAE,EAAMA,EAAE,CAAI,CAE9C,CAZSI,EAAAA,EAAAA,KAcTA,EAAS,eAAoB,IAAI,MAAM,kBAAkB,EACzDA,EAAS,iBAAsB,IAAI,MAAM,kBAAkB,EAC3DA,EAAS,oBAAyB,IAAI,MAAM,4BAA4B,EAExEA,EAAS,UAAY,CAEnB,EAAK,EACL,EAAK,EACL,EAAK,EAOL,IAAO,UAAW,CAEhB,OAAOC,EAAY,KAAK,EAAM,KAAK,CAAI,CACzC,EAOA,IAAO,UAAW,CAEhB,OAAOA,EAAY,CAAC,KAAK,EAAO,KAAK,EAAM,KAAK,CAAI,CACtD,EAOA,IAAO,SAAS,EAAGyB,EAAG,CAEpB,OAAAhB,EAAM,EAAGgB,CAAC,EACHzB,EACL,KAAK,EAAO,KAAK,EAAOL,EAAE,EAAOA,EAAE,EAAO,KAAK,EAAOA,EAAE,EACxD,KAAK,EAAOA,EAAE,CAChB,CACF,EAOA,IAAO,SAAS,EAAG8B,EAAG,CAEpB,OAAAhB,EAAM,EAAGgB,CAAC,EACHzB,EACL,KAAK,EAAO,KAAK,EAAOL,EAAE,EAAOA,EAAE,EAAO,KAAK,EAAOA,EAAE,EACxD,KAAK,EAAOA,EAAE,CAChB,CACF,EAOA,IAAO,SAAS,EAAG8B,EAAG,CAEpB,OAAAhB,EAAM,EAAGgB,CAAC,EACHzB,EACL,KAAK,EAAOL,EAAE,EAAO,KAAK,EAAOA,EAAE,EACnC,KAAK,EAAOA,EAAE,CAChB,CACF,EAOA,IAAO,SAAS,EAAG8B,EAAG,CAEpB,OAAAhB,EAAM,EAAGgB,CAAC,EACHzB,EACL,KAAK,EAAOL,EAAE,EAAO,KAAK,EAAOA,EAAE,EACnC,KAAK,EAAOA,EAAE,CAChB,CACF,EAOA,MAAS,UAAW,CAClB,OAAOK,EAAY,KAAK,EAAO,KAAK,EAAM,KAAK,CAAI,CACrD,EAOA,IAAO,SAAS,EAAGyB,EAAG,CAEpB,GAAI,MAAM,KAAK,CAAI,GAAK,MAAM,KAAK,CAAI,EACrC,OAAO,IAAI1B,EAAS,GAAG,EAGzB,GAAI,IAAM,OACR,OAAOC,EAAY,KAAK,EAAO,KAAK,EAAO,KAAK,EAAM,CAAC,EAIzD,GADAS,EAAM,EAAGgB,CAAC,EACA9B,EAAE,IAAR,GAAsB,KAAK,IAAX,EAClB,MAAMI,EAAS,eAiBjB,OAAOC,EACL,KAAK,GAAQL,EAAE,EAAO,KAAK,IAASA,EAAE,EAAO,KAAK,GAClDA,EAAE,EAAO,KAAK,CAChB,CACF,EAOA,IAAO,SAAS,EAAG8B,EAAG,CAEpB,OAAAhB,EAAM,EAAGgB,CAAC,EAIHzB,EAAYI,EAAIT,EAAE,EAAM,KAAK,CAAI,EAAIS,EAAIT,EAAE,EAAM,KAAK,CAAI,EAAGA,EAAE,EAAO,KAAK,CAAI,CACxF,EAOA,IAAO,SAAS,EAAG8B,EAAG,CAMpB,OAJAhB,EAAM,EAAGgB,CAAC,EAIN9B,EAAE,IAAS,GAAK,KAAK,IAAS,EACzBK,EAAY,EAAG,CAAC,EAElBA,EAAYL,EAAE,EAAO,KAAK,EAAMS,EAAIT,EAAE,EAAM,KAAK,CAAI,EAAIS,EAAIT,EAAE,EAAM,KAAK,CAAI,CAAC,CACxF,EAOA,KAAQ,SAASyC,EAAQ,CAIvB,OAFAA,EAAS,KAAK,IAAI,GAAIA,GAAU,CAAC,EAE7B,MAAM,KAAK,CAAI,GAAK,MAAM,KAAK,CAAI,EAC9B,IAAIrC,EAAS,GAAG,EAElBC,EAAY,KAAK,KAAKoC,EAAS,KAAK,EAAO,KAAK,EAAO,KAAK,CAAI,EAAGA,CAAM,CAClF,EAOA,MAAS,SAASA,EAAQ,CAIxB,OAFAA,EAAS,KAAK,IAAI,GAAIA,GAAU,CAAC,EAE7B,MAAM,KAAK,CAAI,GAAK,MAAM,KAAK,CAAI,EAC9B,IAAIrC,EAAS,GAAG,EAElBC,EAAY,KAAK,MAAMoC,EAAS,KAAK,EAAO,KAAK,EAAO,KAAK,CAAI,EAAGA,CAAM,CACnF,EAOA,MAAS,SAASA,EAAQ,CAIxB,OAFAA,EAAS,KAAK,IAAI,GAAIA,GAAU,CAAC,EAE7B,MAAM,KAAK,CAAI,GAAK,MAAM,KAAK,CAAI,EAC9B,IAAIrC,EAAS,GAAG,EAElBC,EAAY,KAAK,MAAMoC,EAAS,KAAK,EAAO,KAAK,EAAO,KAAK,CAAI,EAAGA,CAAM,CACnF,EAOA,QAAW,UAAW,CAEpB,OAAOpC,EAAY,KAAK,EAAO,KAAK,EAAM,KAAK,CAAI,CACrD,EAOA,IAAO,SAAS,EAAGyB,EAAG,CAMpB,GAJAhB,EAAM,EAAGgB,CAAC,EAIN9B,EAAE,IAAS,EAEb,OAAIA,EAAE,EAAO,EACJK,EAAY,KAAK,IAAI,KAAK,EAAO,KAAK,EAAML,EAAE,CAAI,EAAG,KAAK,IAAI,KAAK,EAAMA,EAAE,CAAI,CAAC,EAEhFK,EAAY,KAAK,IAAI,KAAK,EAAO,KAAK,EAAML,EAAE,CAAI,EAAG,KAAK,IAAI,KAAK,EAAMA,EAAE,CAAI,CAAC,EAU3F,GAAI,KAAK,EAAO,EAAG,OAAO,KAG1B,IAAI2B,EAAIjB,EAAU,KAAK,CAAI,EACvBgB,EAAIhB,EAAU,KAAK,CAAI,EAGvBR,EAAI,EACJI,EAAI,EACR,QAASoC,KAAKf,EACZ,GAAIe,IAAM,IACV,CAAA,GAAIA,IAAM,IAAK,CACbxC,EAAI,EACJ,KACF,CAGA,GAFAyB,EAAEe,CAAC,GAAI1C,EAAE,EAEL2B,EAAEe,CAAC,EAAI1C,EAAE,IAAS,EACpB2B,EAAEe,CAAC,GAAI1C,EAAE,MACJ,QAAO,KACdE,GAAI,KAAK,IAAIwC,EAAGf,EAAEe,CAAC,CAAC,CAAA,CAGtB,QAASA,KAAKhB,EACZ,GAAIgB,IAAM,IAGV,CAAA,GAFAhB,EAAEgB,CAAC,GAAI1C,EAAE,EAEL0B,EAAEgB,CAAC,EAAI1C,EAAE,IAAS,EACpB0B,EAAEgB,CAAC,GAAI1C,EAAE,MACJ,QAAO,KACdM,GAAI,KAAK,IAAIoC,EAAGhB,EAAEgB,CAAC,CAAC,CAAA,CAGtB,OAAI1C,EAAE,EAAO,EACJK,EAAYC,EAAGJ,CAAC,EAElBG,EAAYH,EAAGI,CAAC,CACzB,EAOA,OAAU,SAAS,EAAGwB,EAAG,CAEvB,OAAAhB,EAAM,EAAGgB,CAAC,EACH,KAAK,EAAO,KAAK,EAAO9B,EAAE,IAASA,EAAE,EAAOA,EAAE,EAAO,KAAK,CACnE,EAOA,QAAW,SAAS,EAAG8B,EAAG,CAExBhB,EAAM,EAAGgB,CAAC,EACV,IAAIM,EAAK,KAAK,EAAO,KAAK,EAAOpC,EAAE,EAAOA,EAAE,EAAOA,EAAE,EAAO,KAAK,EACjE,OAAQ,EAAIoC,IAAMA,EAAI,EACxB,EAEA,SAAY,SAASO,EAAK,CAExB,GAAI,MAAM,KAAK,CAAI,GAAK,MAAM,KAAK,CAAI,EACrC,OAAO,KAGTA,EAAMA,GAAO,KAKb,QAHIC,EAAU,KAAK,IAAO,EACtBC,EAAOD,EAAQ,YAAe,EAEzB/B,EAAI,EAAGA,EAAIgC,EAAK,OAAQhC,IAAK,CAGpC,QADIV,EAAIE,EAAYwC,EAAKhC,EAAI,CAAC,EAAG,CAAC,EACzB6B,EAAI7B,EAAI,EAAG6B,GAAK,EAAGA,IAC1BvC,EAAIA,EAAE,QAAW,EAAE,IAAO0C,EAAKH,CAAC,CAAC,EAGnC,GAAIvC,EAAE,IAAOyC,CAAO,EAAE,IAAO,EAAE,QAAQ,EAAID,EACzC,OAAOxC,EAAE,IAAO,KAAK,CAAI,CAE7B,CACA,OAAO,IACT,EAOA,UAAa,SAAS,EAAG2B,EAAG,CAE1B,OAAAhB,EAAM,EAAGgB,CAAC,EACH,EAAE,EAAE9B,EAAE,EAAO,KAAK,IAAW,KAAK,EAAOA,EAAE,GAASA,EAAE,EAAO,KAAK,GAC3E,EAOA,QAAW,UAAW,CAEpB,OAAO,KAAK,EAAO,KAAK,EAAO,KAAK,CACtC,EAOA,WAAc,SAAS8C,EAAc,CAEnC,IAAIC,EAAOC,EAAM,GACb9C,EAAI,KAAK,EACTI,EAAI,KAAK,EACb,OAAI,KAAK,EAAO,IACd0C,GAAM,KAGJ1C,IAAM,EACR0C,GAAM9C,GAGF4C,IAAiBC,EAAQ,KAAK,MAAM7C,EAAII,CAAC,GAAK,IAChD0C,GAAMD,EACNC,GAAM,IACN9C,GAAII,GAGN0C,GAAM9C,EACN8C,GAAM,IACNA,GAAM1C,GAED0C,CACT,EAOA,QAAW,SAASF,EAAc,CAEhC,IAAIC,EAAOC,EAAM,GACb9C,EAAI,KAAK,EACTI,EAAI,KAAK,EACb,OAAI,KAAK,EAAO,IACd0C,GAAM,KAGJ1C,IAAM,EACR0C,GAAM9C,GAGF4C,IAAiBC,EAAQ,KAAK,MAAM7C,EAAII,CAAC,GAAK,IAChD0C,GAAMD,EACN7C,GAAII,GAGN0C,GAAM,UACNA,GAAM9C,EACN8C,GAAM,KACNA,GAAM1C,EACN0C,GAAM,KAEDA,CACT,EAOA,YAAe,UAAW,CAExB,IAAIZ,EACA5B,EAAI,KAAK,EACTsB,EAAI,KAAK,EACTmB,EAAM,CAAC,EAEX,GAAI,MAAMzC,CAAC,GAAK,MAAMsB,CAAC,EACrB,OAAOmB,EAGT,GACEA,EAAI,KAAK,KAAK,MAAMzC,EAAIsB,CAAC,CAAC,EAC1BM,EAAI5B,EAAIsB,EACRtB,EAAIsB,EACJA,EAAIM,QACG5B,IAAM,GAEf,OAAOyC,CACT,EAOA,SAAY,SAASC,EAAK,CAExB,IAAIvB,EAAI,KAAK,EACTD,EAAI,KAAK,EAEb,GAAI,MAAMC,CAAC,GAAK,MAAMD,CAAC,EACrB,MAAO,MAGTwB,EAAMA,GAAO,GAEb,IAAIC,EAASjB,EAASP,EAAGD,CAAC,EACtB0B,EAASf,EAAWV,EAAGD,EAAGyB,CAAM,EAEhCH,EAAM,KAAK,EAAO,EAAI,IAAM,GAUhC,GARAA,GAAMrB,EAAID,EAAI,EAEdC,GAAID,EACJC,GAAI,GAEAA,IACFqB,GAAM,KAEJG,EAAQ,CAEV,QAAStC,EAAIuC,EAAQvC,KACnBmC,GAAMrB,EAAID,EAAI,EACdC,GAAID,EACJC,GAAI,GAENqB,GAAM,IACN,QAASnC,EAAIsC,EAAQtC,KACnBmC,GAAMrB,EAAID,EAAI,EACdC,GAAID,EACJC,GAAI,GAENqB,GAAM,GACR,KACE,SAASnC,EAAIqC,EAAKvB,GAAKd,KACrBmC,GAAMrB,EAAID,EAAI,EACdC,GAAID,EACJC,GAAI,GAGR,OAAOqB,CACT,CACF,EAEI,OAAO,QAAW,YAAc,OAAO,IACzC,OAAO,CAAC,EAAG,UAAW,CACpB,OAAO5C,CACT,CAAC,EACQ,OAAOR,GAAY,UAC5B,OAAO,eAAeQ,EAAU,aAAc,CAAE,MAAS,EAAK,CAAC,EAC/DA,EAAS,QAAaA,EACtBA,EAAS,SAAcA,EACvBP,EAAO,QAAaO,GAEpBN,EAAK,SAAcM,CAGvB,GAAGR,CAAI,CAAA,CAAA,EC13BPyD,GAAqBC,GAAAC,GAAA,CAAA,E8BerB,SAASC,GAAUC,EAASC,EAAY1D,EAAG2D,EAAW,CAClD,SAASC,EAAMC,EAAO,CAAE,OAAOA,aAAiB7D,EAAI6D,EAAQ,IAAI7D,EAAE,SAAU8D,EAAS,CAAEA,EAAQD,CAAK,CAAG,CAAC,CAAG,CAAlGD,OAAAA,EAAAA,EAAAA,KACF,IAAK5D,IAAMA,EAAI,UAAU,SAAU8D,EAASC,EAAQ,CACvD,SAASC,EAAUH,EAAO,CAAE,GAAI,CAAEI,EAAKN,EAAU,KAAKE,CAAK,CAAC,CAAG,OAAS9B,EAAG,CAAEgC,EAAOhC,CAAC,CAAG,CAAE,CAAjFiC,EAAAA,EAAAA,KACT,SAASE,EAASL,EAAO,CAAE,GAAI,CAAEI,EAAKN,EAAU,MAASE,CAAK,CAAC,CAAG,OAAS9B,EAAG,CAAEgC,EAAOhC,CAAC,CAAG,CAAE,CAApFmC,EAAAA,EAAAA,KACT,SAASD,EAAKE,EAAQ,CAAEA,EAAO,KAAOL,EAAQK,EAAO,KAAK,EAAIP,EAAMO,EAAO,KAAK,EAAE,KAAKH,EAAWE,CAAQ,CAAG,CAApGD,EAAAA,EAAAA,KACTA,GAAMN,EAAYA,EAAU,MAAMF,EAASC,GAAc,CAAC,CAAC,GAAG,KAAK,CAAC,CACxE,CAAC,CACL,CARSF,EAAAA,GAAAA,KAUT,SAASY,GAAYX,EAASY,EAAM,CAChC,IAAIC,EAAI,CAAE,MAAO,EAAG,KAAM,UAAW,CAAE,GAAIlC,EAAE,CAAC,EAAI,EAAG,MAAMA,EAAE,CAAC,EAAG,OAAOA,EAAE,CAAC,CAAG,EAAG,KAAM,CAAC,EAAG,IAAK,CAAC,CAAE,EAAG7B,EAAGc,EAAGe,EAAGmC,EAC/G,OAAOA,EAAI,CAAE,KAAMC,EAAK,CAAC,EAAG,MAASA,EAAK,CAAC,EAAG,OAAUA,EAAK,CAAC,CAAE,EAAG,OAAO,QAAW,aAAeD,EAAE,OAAO,QAAQ,EAAI,UAAW,CAAE,OAAO,IAAM,GAAIA,EACvJ,SAASC,EAAKtE,EAAG,CAAE,OAAO,SAAUgB,EAAG,CAAE,OAAO+C,EAAK,CAAC/D,EAAGgB,CAAC,CAAC,CAAG,CAAG,CACjE,SAAS+C,EAAKQ,EAAI,CACd,GAAIlE,EAAG,MAAM,IAAI,UAAU,iCAAiC,EAC5D,KAAO+D,GAAG,GAAI,CACV,GAAI/D,EAAI,EAAGc,IAAMe,EAAIqC,EAAG,CAAC,EAAI,EAAIpD,EAAE,OAAYoD,EAAG,CAAC,EAAIpD,EAAE,SAAce,EAAIf,EAAE,SAAce,EAAE,KAAKf,CAAC,EAAG,GAAKA,EAAE,OAAS,EAAEe,EAAIA,EAAE,KAAKf,EAAGoD,EAAG,CAAC,CAAC,GAAG,KAAM,OAAOrC,EAE3J,OADIf,EAAI,EAAGe,IAAGqC,EAAK,CAACA,EAAG,CAAC,EAAI,EAAGrC,EAAE,KAAK,GAC9BqC,EAAG,CAAC,EAAG,CACX,IAAK,GAAG,IAAK,GAAGrC,EAAIqC,EAAI,MACxB,IAAK,GAAG,OAAAH,EAAE,QAAgB,CAAE,MAAOG,EAAG,CAAC,EAAG,KAAM,EAAM,EACtD,IAAK,GAAGH,EAAE,QAASjD,EAAIoD,EAAG,CAAC,EAAGA,EAAK,CAAC,CAAC,EAAG,SACxC,IAAK,GAAGA,EAAKH,EAAE,IAAI,IAAI,EAAGA,EAAE,KAAK,IAAI,EAAG,SACxC,QACI,GAAMlC,EAAIkC,EAAE,KAAM,EAAAlC,EAAIA,EAAE,OAAS,GAAKA,EAAEA,EAAE,OAAS,CAAC,KAAOqC,EAAG,CAAC,IAAM,GAAKA,EAAG,CAAC,IAAM,GAAI,CAAEH,EAAI,EAAG,QAAU,CAC3G,GAAIG,EAAG,CAAC,IAAM,IAAM,CAACrC,GAAMqC,EAAG,CAAC,EAAIrC,EAAE,CAAC,GAAKqC,EAAG,CAAC,EAAIrC,EAAE,CAAC,GAAK,CAAEkC,EAAE,MAAQG,EAAG,CAAC,EAAG,KAAO,CACrF,GAAIA,EAAG,CAAC,IAAM,GAAKH,EAAE,MAAQlC,EAAE,CAAC,EAAG,CAAEkC,EAAE,MAAQlC,EAAE,CAAC,EAAGA,EAAIqC,EAAI,KAAO,CACpE,GAAIrC,GAAKkC,EAAE,MAAQlC,EAAE,CAAC,EAAG,CAAEkC,EAAE,MAAQlC,EAAE,CAAC,EAAGkC,EAAE,IAAI,KAAKG,CAAE,EAAG,KAAO,CAC9DrC,EAAE,CAAC,GAAGkC,EAAE,IAAI,IAAI,EACpBA,EAAE,KAAK,IAAI,EAAG,QACtB,CACAG,EAAKJ,EAAK,KAAKZ,EAASa,CAAC,CAC7B,OAASvC,EAAG,CAAE0C,EAAK,CAAC,EAAG1C,CAAC,EAAGV,EAAI,CAAG,QAAA,CAAYd,EAAI6B,EAAI,CAAG,CACzD,GAAIqC,EAAG,CAAC,EAAI,EAAG,MAAMA,EAAG,CAAC,EAAG,MAAO,CAAE,MAAOA,EAAG,CAAC,EAAIA,EAAG,CAAC,EAAI,OAAQ,KAAM,EAAK,CACnF,CACJ,CA1BSL,EAAAA,GAAAA,KA4BT,SAASM,GAAOC,EAAGzE,EAAG,CAClB,IAAI8B,EAAI,OAAO,QAAW,YAAc2C,EAAE,OAAO,QAAQ,EACzD,GAAI,CAAC3C,EAAG,OAAO2C,EACf,IAAI9D,EAAImB,EAAE,KAAK2C,CAAC,EAAG1C,EAAG2C,EAAK,CAAC,EAAG7C,EAC/B,GAAI,CACA,MAAQ7B,IAAM,QAAUA,KAAM,IAAM,EAAE+B,EAAIpB,EAAE,KAAK,GAAG,MAAM+D,EAAG,KAAK3C,EAAE,KAAK,CAC7E,OACO4C,EAAO,CAAE9C,EAAI,CAAE,MAAO8C,CAAM,CAAG,QAAA,CAElC,GAAI,CACI5C,GAAK,CAACA,EAAE,OAASD,EAAInB,EAAE,SAAYmB,EAAE,KAAKnB,CAAC,CACnD,QAAA,CACU,GAAIkB,EAAG,MAAMA,EAAE,KAAO,CACpC,CACA,OAAO6C,CACX,CAfSF,EAAAA,GAAAA,KAiBT,SAASI,EAAcC,EAAIC,EAAMC,EAAM,CACnC,GAAIA,GAAQ,UAAU,SAAW,EAAG,QAASpE,EAAI,EAAGqE,EAAIF,EAAK,OAAQJ,EAAI/D,EAAIqE,EAAGrE,KACxE+D,GAAM,EAAE/D,KAAKmE,MACRJ,IAAIA,EAAK,MAAM,UAAU,MAAM,KAAKI,EAAM,EAAGnE,CAAC,GACnD+D,EAAG/D,CAAC,EAAImE,EAAKnE,CAAC,GAGtB,OAAOkE,EAAG,OAAOH,GAAM,MAAM,UAAU,MAAM,KAAKI,CAAI,CAAC,CAC3D,CARSF,EAAAA,EAAAA,KAUT,IAAIK,GAAqB,CACrB,eAAgB,EACpB,EAGIC,GAAwBrE,EAAA,SAAUsE,EAASlB,EAAQmB,EAAQ,CACvDA,IAAW,SAAUA,EAASH,IAClC,IAAII,EAAOpB,EAAO,KAAK,EACjB,CAAE,KAAM,KAAM,MAAOA,EAAO,KAAM,EAClC,CAAE,KAAM,MAAO,MAAOA,EAAO,KAAM,EACrCqB,EAAaF,EAAO,eAAiB,IAAI,MAAM,EAAE,MAAQ,OAC7D,MAAO,CACH,KAAMC,EACN,QAASF,EACT,MAAOG,CACX,CACJ,EAX4B,MAaxBC,GAA6B,UAAY,CACzC,SAASA,EAAYxC,EAAK,CACtB,KAAK,SAAWA,CACpB,CAFSwC,OAAAA,EAAAA,EAAAA,KAGTA,EAAY,gBAAkB,SAAUC,EAAS,CAC7C,IAAIC,EAAaD,EAAQ,KAAK,SAAU7B,EAAO,CAAE,OAAO,IAAI+B,EAAG/B,CAAK,CAAG,CAAC,EACxE,OAAO,IAAI4B,EAAYE,CAAU,CACrC,EACAF,EAAY,YAAc,SAAUC,EAASG,EAAS,CAClD,IAAIF,EAAaD,EACZ,KAAK,SAAU7B,EAAO,CAAE,OAAO,IAAI+B,EAAG/B,CAAK,CAAG,CAAC,EAAE,MAAS,SAAU9B,EAAG,CAAE,OAAO,IAAI+D,EAAID,EAAQ9D,CAAC,CAAC,CAAG,CAAC,EAC3G,OAAO,IAAI0D,EAAYE,CAAU,CACrC,EACAF,EAAY,QAAU,SAAUM,EAAiB,CAC7C,OAAOC,GAAuBD,CAAe,CACjD,EACAN,EAAY,qBAAuB,SAAUM,EAAiB,CAC1D,OAAOE,GAAoCF,CAAe,CAC9D,EACAN,EAAY,UAAU,IAAM,SAAUlF,EAAG,CACrC,IAAI2F,EAAQ,KACZ,OAAO,IAAIT,EAAY,KAAK,SAAS,KAAK,SAAUxC,EAAK,CAAE,OAAOO,GAAU0C,EAAO,OAAQ,OAAQ,UAAY,CAC3G,IAAIC,EACJ,OAAO/B,GAAY,KAAM,SAAUgC,EAAI,CACnC,OAAQA,EAAG,MAAO,CACd,IAAK,GACD,OAAInD,EAAI,MAAM,EACH,CAAC,EAAc,IAAI6C,EAAI7C,EAAI,KAAK,CAAC,GAE5CkD,EAAKP,EAAG,KACD,CAAC,EAAarF,EAAE0C,EAAI,KAAK,CAAC,GACrC,IAAK,GAAG,MAAO,CAAC,EAAc,IAAKkD,EAAG,MAAMP,EAAI,CAAC,OAAQQ,EAAG,KAAK,CAAC,CAAC,EAAI,CAC3E,CACJ,CAAC,CACL,CAAC,CAAG,CAAC,CAAC,CACV,EACAX,EAAY,UAAU,OAAS,SAAUlF,EAAG,CACxC,IAAI2F,EAAQ,KACZ,OAAO,IAAIT,EAAY,KAAK,SAAS,KAAK,SAAUxC,EAAK,CAAE,OAAOO,GAAU0C,EAAO,OAAQ,OAAQ,UAAY,CAC3G,IAAIC,EACJ,OAAO/B,GAAY,KAAM,SAAUgC,EAAI,CACnC,OAAQA,EAAG,MAAO,CACd,IAAK,GACD,OAAInD,EAAI,KAAK,EACF,CAAC,EAAc,IAAI2C,EAAG3C,EAAI,KAAK,CAAC,GAE3CkD,EAAKL,EAAI,KACF,CAAC,EAAavF,EAAE0C,EAAI,KAAK,CAAC,GACrC,IAAK,GAAG,MAAO,CAAC,EAAc,IAAKkD,EAAG,MAAML,EAAK,CAAC,OAAQM,EAAG,KAAK,CAAC,CAAC,EAAI,CAC5E,CACJ,CAAC,CACL,CAAC,CAAG,CAAC,CAAC,CACV,EAEAX,EAAY,UAAU,QAAU,SAAUlF,EAAG,CACzC,OAAO,IAAIkF,EAAY,KAAK,SAAS,KAAK,SAAUxC,EAAK,CACrD,GAAIA,EAAI,MAAM,EACV,OAAO,IAAI6C,EAAI7C,EAAI,KAAK,EAE5B,IAAIoD,EAAW9F,EAAE0C,EAAI,KAAK,EAC1B,OAAOoD,aAAoBZ,EAAcY,EAAS,SAAWA,CACjE,CAAC,CAAC,CACN,EAEAZ,EAAY,UAAU,OAAS,SAAUlF,EAAG,CACxC,IAAI2F,EAAQ,KACZ,OAAO,IAAIT,EAAY,KAAK,SAAS,KAAK,SAAUxC,EAAK,CAAE,OAAOO,GAAU0C,EAAO,OAAQ,OAAQ,UAAY,CAC3G,OAAO9B,GAAY,KAAM,SAAU+B,EAAI,CACnC,OAAIlD,EAAI,MAAM,EACH,CAAC,EAAc1C,EAAE0C,EAAI,KAAK,CAAC,EAE/B,CAAC,EAAc,IAAI2C,EAAG3C,EAAI,KAAK,CAAC,CAC3C,CAAC,CACL,CAAC,CAAG,CAAC,CAAC,CACV,EACAwC,EAAY,UAAU,MAAQ,SAAUa,EAAIC,EAAM,CAC9C,OAAO,KAAK,SAAS,KAAK,SAAUtD,EAAK,CAAE,OAAOA,EAAI,MAAMqD,EAAIC,CAAI,CAAG,CAAC,CAC5E,EACAd,EAAY,UAAU,SAAW,SAAUrD,EAAG,CAC1C,OAAO,KAAK,SAAS,KAAK,SAAUa,EAAK,CAAE,OAAOA,EAAI,SAASb,CAAC,CAAG,CAAC,CACxE,EAEAqD,EAAY,UAAU,KAAO,SAAUe,EAAiBC,EAAiB,CACrE,OAAO,KAAK,SAAS,KAAKD,EAAiBC,CAAe,CAC9D,EACOhB,CACX,EAAE,EAIEiB,GAAW3F,EAAA,SAAU4F,EAAK,CAC1B,OAAO,IAAIlB,GAAY,QAAQ,QAAQ,IAAIK,EAAIa,CAAG,CAAC,CAAC,CACxD,EAFe,MAGXC,GAAcnB,GAAY,YAC1BoB,GAAkBpB,GAAY,gBAE9BqB,GAAyB/F,EAAA,SAAU8C,EAAO,CAAE,OAAO,SAAUkD,EAAM,CAAE,OAAOjC,EAAcA,EAAc,CAAC,EAAGJ,GAAOqC,CAAI,EAAG,EAAK,EAAG,CAAClD,CAAK,EAAG,EAAK,CAAG,CAAG,EAA7H,MAIzBmD,GAAoBjG,EAAA,SAAUkG,EAAY,CAC1C,OAAOA,EAAW,OAAO,SAAUC,EAAK/C,EAAQ,CAC5C,OAAO+C,EAAI,KAAK,EACV/C,EAAO,MAAM,EACTwC,EAAIxC,EAAO,KAAK,EAChB+C,EAAI,IAAIJ,GAAuB3C,EAAO,KAAK,CAAC,EAChD+C,CACV,EAAGZ,EAAG,CAAC,CAAC,CAAC,CACb,EARwB,MAcpBN,GAAyBjF,EAAA,SAAUgF,EAAiB,CACpD,OAAON,GAAY,gBAAgB,QAAQ,IAAIM,CAAe,CAAC,EAAE,QAAQiB,EAAiB,CAC9F,EAF6B,MAMzBG,GAAiCpG,EAAA,SAAUkG,EAAY,CACvD,OAAOA,EAAW,OAAO,SAAUC,EAAK/C,EAAQ,CAC5C,OAAOA,EAAO,MAAM,EACd+C,EAAI,MAAM,EACNP,EAAI7B,EAAcA,EAAc,CAAC,EAAGJ,GAAOwC,EAAI,KAAK,EAAG,EAAK,EAAG,CAAC/C,EAAO,KAAK,EAAG,EAAK,CAAC,EACrFwC,EAAI,CAACxC,EAAO,KAAK,CAAC,EACtB+C,EAAI,MAAM,EACNA,EACAZ,EAAGxB,EAAcA,EAAc,CAAC,EAAGJ,GAAOwC,EAAI,KAAK,EAAG,EAAK,EAAG,CAAC/C,EAAO,KAAK,EAAG,EAAK,CAAC,CAClG,EAAGmC,EAAG,CAAC,CAAC,CAAC,CACb,EAVqC,MAWjCL,GAAsClF,EAAA,SAAUgF,EAAiB,CACjE,OAAON,GAAY,gBAAgB,QAAQ,IAAIM,CAAe,CAAC,EAAE,QAAQoB,EAA8B,CAC3G,EAF0C,MAKtCC,IACH,SAAUA,EAAQ,CASf,SAASC,EAAcC,EAAIzB,EAAS,CAChC,OAAO,UAAY,CAEf,QADI0B,EAAO,CAAC,EACHC,EAAK,EAAGA,EAAK,UAAU,OAAQA,IACpCD,EAAKC,CAAE,EAAI,UAAUA,CAAE,EAE3B,GAAI,CACA,IAAIrD,EAASmD,EAAG,MAAM,OAAQxC,EAAc,CAAC,EAAGJ,GAAO6C,CAAI,EAAG,EAAK,CAAC,EACpE,OAAOjB,EAAGnC,CAAM,CACpB,OACOpC,EAAG,CACN,OAAO4E,EAAId,EAAUA,EAAQ9D,CAAC,EAAIA,CAAC,CACvC,CACJ,CACJ,CAdSsF,EAAAA,EAAAA,KAeTD,EAAO,cAAgBC,EACvB,SAASI,EAAQR,EAAY,CACzB,OAAOD,GAAkBC,CAAU,CACvC,CAFSQ,EAAAA,EAAAA,KAGTL,EAAO,QAAUK,EACjB,SAASC,EAAqBT,EAAY,CACtC,OAAOE,GAA+BF,CAAU,CACpD,CAFSS,EAAAA,OAGTN,EAAO,qBAAuBM,CAClC,GAAGN,KAAWA,GAAS,CAAC,EAAE,EAC1B,IAAId,EAAKvF,EAAA,SAAU8C,EAAO,CAAE,OAAO,IAAI+B,EAAG/B,CAAK,CAAG,EAAzC,KACL8C,EAAM5F,EAAA,SAAU4F,EAAK,CAAE,OAAO,IAAIb,EAAIa,CAAG,CAAG,EAAtC,KACNf,EAAoB,UAAY,CAChC,SAASA,EAAG/B,EAAO,CACf,KAAK,MAAQA,CACjB,CAFS+B,OAAAA,EAAAA,EAAAA,KAGTA,EAAG,UAAU,KAAO,UAAY,CAC5B,MAAO,EACX,EACAA,EAAG,UAAU,MAAQ,UAAY,CAC7B,MAAO,CAAC,KAAK,KAAK,CACtB,EACAA,EAAG,UAAU,IAAM,SAAUrF,EAAG,CAC5B,OAAO+F,EAAG/F,EAAE,KAAK,KAAK,CAAC,CAC3B,EAEAqF,EAAG,UAAU,OAAS,SAAU+B,EAAI,CAChC,OAAOrB,EAAG,KAAK,KAAK,CACxB,EAEAV,EAAG,UAAU,QAAU,SAAUrF,EAAG,CAChC,OAAOA,EAAE,KAAK,KAAK,CACvB,EAEAqF,EAAG,UAAU,OAAS,SAAU+B,EAAI,CAChC,OAAOrB,EAAG,KAAK,KAAK,CACxB,EACAV,EAAG,UAAU,aAAe,SAAUrF,EAAG,CACrC,OAAOA,EAAE,KAAK,KAAK,CACvB,EACAqF,EAAG,UAAU,SAAW,SAAUrF,EAAG,CACjC,OAAOkF,GAAY,gBAAgBlF,EAAE,KAAK,KAAK,CAAC,CACpD,EAEAqF,EAAG,UAAU,SAAW,SAAUgC,EAAI,CAClC,OAAO,KAAK,KAChB,EAEAhC,EAAG,UAAU,MAAQ,SAAUU,EAAIC,EAAM,CACrC,OAAOD,EAAG,KAAK,KAAK,CACxB,EACAV,EAAG,UAAU,cAAgB,SAAUtB,EAAG,CACtC,OAAO,KAAK,KAChB,EACAsB,EAAG,UAAU,iBAAmB,SAAUN,EAAQ,CAC9C,MAAMF,GAAsB,qCAAsC,KAAME,CAAM,CAClF,EACOM,CACX,EAAE,EACEE,EAAqB,UAAY,CACjC,SAASA,EAAIjB,EAAO,CAChB,KAAK,MAAQA,CACjB,CAFSiB,OAAAA,EAAAA,EAAAA,KAGTA,EAAI,UAAU,KAAO,UAAY,CAC7B,MAAO,EACX,EACAA,EAAI,UAAU,MAAQ,UAAY,CAC9B,MAAO,CAAC,KAAK,KAAK,CACtB,EAEAA,EAAI,UAAU,IAAM,SAAU6B,EAAI,CAC9B,OAAOhB,EAAI,KAAK,KAAK,CACzB,EACAb,EAAI,UAAU,OAAS,SAAUvF,EAAG,CAChC,OAAOoG,EAAIpG,EAAE,KAAK,KAAK,CAAC,CAC5B,EAEAuF,EAAI,UAAU,QAAU,SAAU6B,EAAI,CAClC,OAAOhB,EAAI,KAAK,KAAK,CACzB,EAEAb,EAAI,UAAU,OAAS,SAAUvF,EAAG,CAChC,OAAOA,EAAE,KAAK,KAAK,CACvB,EAEAuF,EAAI,UAAU,aAAe,SAAU6B,EAAI,CACvC,OAAOjB,GAAS,KAAK,KAAK,CAC9B,EAEAZ,EAAI,UAAU,SAAW,SAAU6B,EAAI,CACnC,OAAOjB,GAAS,KAAK,KAAK,CAC9B,EACAZ,EAAI,UAAU,SAAW,SAAU5E,EAAG,CAClC,OAAOA,CACX,EACA4E,EAAI,UAAU,MAAQ,SAAU+B,EAAKlB,EAAK,CACtC,OAAOA,EAAI,KAAK,KAAK,CACzB,EACAb,EAAI,UAAU,cAAgB,SAAUR,EAAQ,CAC5C,MAAMF,GAAsB,mCAAoC,KAAME,CAAM,CAChF,EACAQ,EAAI,UAAU,iBAAmB,SAAUxB,EAAG,CAC1C,OAAO,KAAK,KAChB,EACOwB,CACX,EAAE,EACEuB,GAAgBD,GAAO,c9B3WpB,SAASU,GAAOC,EAAuB,CAC5C,IAAMC,EAAcC,GAAcF,CAAK,EAGvC,OAFiB,IAAI3H,GAAAA,QAAS4H,CAAW,EAAE,QAAQ,EAEjC,KAAK,EACzB,CALgBF,EAAAA,GAAAA,KAyDT,SAASG,GAAcF,EAAuB,CACnD,OAAOA,EAAM,QAAQ,UAAW,IAAI,EAAE,QAAQ,KAAM,GAAG,CACzD,CAFgBE,EAAAA,GAAAA,MCzCT,IAAMC,GAAoB,CAC/B,CAAC,UAAW,OAAU,IAAK,OAAK,SAAU,MAAO,MAAO,EAAK,EAC7D,CAAC,UAAW,OAAU,IAAK,OAAK,SAAU,MAAO,MAAO,GAAK,EAC7D,CAAC,UAAW,OAAU,IAAK,OAAK,SAAU,MAAO,MAAO,GAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,iBAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,iBAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,EAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,EAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,EAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,EAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,kBAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,iBAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,kBAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,IAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,IAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,IAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,IAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,iBAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,OAAQ,MAAO,EAAM,CACjE,EAMaC,EAAN,MAAMA,CAAO,OAAA,CAAApH,EAAA,UA2BlB,OAAO,WAAWqH,EAAsB,CACtC,GAAIA,EAAK,SAAW,EAClB,MAAM,IAAI,MAAM,kBAAkBA,CAAI,GAAG,EAE3C,GAAIA,EAAK,CAAC,IAAM,IACd,MAAO,CAACD,EAAO,WAAWC,EAAK,OAAO,CAAC,CAAC,EAE1C,GAAIA,EAAK,CAAC,IAAM,SACd,OAAO,KAAK,KAAKD,EAAO,WAAWC,EAAK,OAAO,CAAC,CAAC,CAAC,EAGpD,IAAMC,EAAWF,EAAO,qBAAqBpG,GAAKA,EAAE,YAAcqG,CAAI,EACtE,GAAIC,IAAa,OACf,OAAOA,EAAS,MAGlB,IAAMlE,EAAS,WAAWiE,CAAI,EAC9B,GAAI,MAAMjE,CAAM,EACd,MAAM,IAAI,MAAM,kBAAkBiE,CAAI,GAAG,EAE3C,OAAOjE,CACT,CASA,OAAO,mBAAmBN,EAAeyE,EAAyB,CAChE,GAAIzE,EAAQ,EACV,MAAO,CAACsE,EAAO,mBAAmB,CAACtE,EAAOyE,CAAO,EAGnD,IAAMrG,EAAI4B,EAAQ,EAClB,GAAI5B,GAAKqG,GAAW,EAAIrG,GAAKqG,EAC3B,OAAO,KAAK,MAAMzE,CAAK,EAGzB,IAAMwE,EAAWF,EAAO,qBAAqBpG,GAAK,KAAK,IAAIA,EAAE,MAAQ8B,CAAK,GAAKyE,CAAO,EACtF,GAAID,IAAa,OACf,OAAOA,EAAS,MAGlB,IAAME,EAAeJ,EAAO,qBAAqBpG,GAAK,KAAK,IAAI,KAAK,KAAKA,EAAE,KAAK,EAAI8B,CAAK,GAAKyE,CAAO,EACrG,OAAIC,IAAiB,OACZ,KAAK,KAAKA,EAAa,KAAK,EAG9B1E,CACT,CAQA,OAAO,qBAAqB2E,EAAiF,CAC3G,QAAWC,KAAQP,GACjB,GAAIM,EAAUC,CAAI,EAAG,OAAOA,CAGhC,CAaA,YACEC,EACAC,EACAC,EACAC,EACA,CACA,KAAK,kBAAoBH,EACzB,KAAK,qBAAuBC,EAC5B,KAAK,YAAcC,EACnB,KAAK,cAAgBC,CACvB,CAEA,YAAYtI,EAAmB,CAC7B,OAAI,KAAK,kBACA,KAAK,gBAAgBA,EAAG,KAAK,qBAAsB,KAAK,WAAW,EAExE,KAAK,cAAgB,OAChBA,EAAE,QAAQ,KAAK,WAAW,EAE5B,OAAOA,CAAC,CACjB,CAUQ,gBAAgBsD,EAAeyE,EAAU,EAAGQ,EAA6B,OAAmB,CAClG,GAAI,KAAK,IAAIjF,CAAK,EAAIyE,EAAS,MAAO,IACtC,GAAIzE,EAAQ,EAAG,MAAO,IAAI,KAAK,gBAAgB,CAACA,EAAOyE,EAASQ,CAAM,CAAC,GAEvE,IAAMT,EAAWF,EAAO,qBAAqBpG,GAAK,KAAK,IAAIA,EAAE,MAAQ8B,CAAK,GAAKyE,CAAO,EACtF,GAAID,IAAa,OACf,OAAOA,EAAS,UAGlB,IAAME,EAAeJ,EAAO,qBAAqBpG,GAAK,KAAK,IAAI,KAAK,KAAKA,EAAE,KAAK,EAAI8B,CAAK,GAAKyE,CAAO,EACrG,OAAIC,IAAiB,OACZ,SAASA,EAAa,SAAS,GAGpC1E,EAAQ,IAAM,GAAKiF,IAAW,OACzBjF,EAAM,QAAQiF,CAAM,EAGtBjF,EAAM,SAAS,CACxB,CACF,EA1JasE,EAMK,WAAa,IAAIA,EAAO,GAAO,EAAG,EAAG,IAAI,EAN9CA,EAWK,MAAQ,IAAIA,EAAO,GAAM,EAAG,OAAW,IAAI,EAXhDA,EAgBK,SAAW,IAAIA,EAAO,GAAM,EAAG,OAAW,GAAG,EAhBlDA,EAqBK,WAAa,IAAIA,EAAO,GAAM,KAAQ,EAAG,IAAI,EArBxD,IAAMY,GAANZ,ECvCMa,GAAN,MAAMC,EAAgB,OAAA,CAAAlI,EAAA,UAM3B,OAAO,qBAAqByH,EAAiF,CAC3G,QAAWC,KAAQP,GACjB,GAAIM,EAAUC,CAAI,EAAG,OAAOA,CAGhC,CAEA,YACEC,EACAC,EACAC,EACAC,EAAgB,KAChB,CACA,KAAK,kBAAoBH,EACzB,KAAK,qBAAuBC,EAC5B,KAAK,YAAcC,EACnB,KAAK,cAAgBC,CACvB,CAEA,OAAO3I,EAAmB,CACxB,OAAI,KAAK,kBACA,KAAK,iBAAiBA,EAAG,KAAK,qBAAsB,KAAK,WAAW,EAEzE,KAAK,cAAgB,OAChBA,EAAE,QAAQ,KAAK,WAAW,EAE5B,OAAOA,CAAC,CACjB,CAEQ,iBAAiB2D,EAAeyE,EAAU,EAAGQ,EAA6B,OAAmB,CACnG,GAAI,KAAK,IAAIjF,CAAK,EAAIyE,EAAS,MAAO,IACtC,GAAIzE,EAAQ,EAAG,MAAO,IAAI,KAAK,iBAAiB,CAACA,EAAOyE,EAASQ,CAAM,CAAC,GAExE,IAAMT,EAAWY,GAAgB,qBAAqBlH,GAAK,KAAK,IAAIA,EAAE,MAAQ8B,CAAK,GAAKyE,CAAO,EAC/F,GAAID,IAAa,OACf,OAAOA,EAAS,UAGlB,IAAME,EAAeU,GAAgB,qBAAqBlH,GAAK,KAAK,IAAI,KAAK,KAAKA,EAAE,KAAK,EAAI8B,CAAK,GAAKyE,CAAO,EAC9G,OAAIC,IAAiB,OACZ,SAASA,EAAa,SAAS,GAGpC1E,EAAQ,IAAM,GAAKiF,IAAW,OACzBjF,EAAM,QAAQiF,CAAM,EAGtBjF,EAAM,SAAS,CACxB,CACF,EClDMqF,GAAyB,CAC7B,kBAAmB,GACnB,qBAAsB,EACtB,YAAa,MACf,EAEaC,EAAN,MAAMA,CAAQ,OAAA,CAAApI,EAAA,UAkGnB,YAAYqI,EAAcC,EAAc,CAqCxC,KAAA,UAAY,KAAK,GAAG,KAAK,IAAI,EAe7B,KAAA,uBAAyB,KAAK,SAAS,KAAK,IAAI,EAWhD,KAAA,KAAO,KAAK,UAAU,KAAK,IAAI,EAuB/B,KAAA,KAAO,KAAK,IAAI,KAAK,IAAI,EAczB,KAAA,SAAW,KAAK,IAAI,KAAK,IAAI,EAC7B,KAAA,MAAQ,KAAK,IAAI,KAAK,IAAI,EAc1B,KAAA,SAAW,KAAK,KAAK,KAAK,IAAI,EAC9B,KAAA,MAAQ,KAAK,KAAK,KAAK,IAAI,EA6B3B,KAAA,UAAY,KAAK,IAAI,KAAK,IAAI,EAgB9B,KAAA,UAAY,KAAK,IAAI,KAAK,IAAI,EAgB9B,KAAA,MAAQ,KAAK,KAAK,KAAK,IAAI,EAW3B,KAAA,MAAQ,KAAK,IAAI,KAAK,IAAI,EAC1B,KAAA,MAAQ,KAAK,IAAI,KAAK,IAAI,EA5LxB,KAAK,KAAOD,EACZ,KAAK,KAAOC,EAEZ,KAAK,uBAAyB,KAAK,SACnC,KAAK,UAAY,KAAK,GACtB,KAAK,KAAO,KAAK,UACjB,KAAK,KAAO,KAAK,IAEjB,KAAK,SAAW,KAAK,IACrB,KAAK,MAAQ,KAAK,IAElB,KAAK,SAAW,KAAK,KACrB,KAAK,MAAQ,KAAK,KAClB,KAAK,UAAY,KAAK,IACtB,KAAK,UAAY,KAAK,IACtB,KAAK,MAAQ,KAAK,KAElB,KAAK,MAAQ,KAAK,IAClB,KAAK,MAAQ,KAAK,GACpB,CA1FA,OAAO,KAAKxF,EAAkC,CAC5C,OAAI,OAAOA,GAAU,SACZ,IAAIsF,EAAQtF,EAAO,CAAC,EAGtBA,CACT,CAOA,OAAO,KAAKA,EAAiC,CAC3C,OAAI,OAAOA,GAAU,SACZA,EAGFA,EAAM,IACf,CAOA,OAAO,KAAKA,EAAiC,CAC3C,OAAI,OAAOA,GAAU,SACZ,EAGFA,EAAM,IACf,CAQA,OAAO,MAAMyF,EAAmBC,EAAwB,CACtD,GAAM,CAACC,EAAKC,CAAG,EAAI,KAAK,UAAUF,CAAK,EAEvC,OAAO,IAAIJ,EAAQG,EAAYE,EAAKF,EAAYG,CAAG,CACrD,CAEA,OAAe,UAAUC,EAA2B,CAClD,IAAMC,EAAO,KAAK,GAAK,EACjB9I,EAAI,KAAK,MAAM6I,EAAUC,CAAI,EACnC,GAAI9I,EAAI8I,IAASD,EAAS,CACxB,IAAMvJ,EAAI,KAAK,KAAK,EAAG,EAWvB,MAVc,CACZ,CAAC,EAAG,CAAC,EACL,CAACA,EAAGA,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,CAACA,EAAGA,CAAC,EACN,CAAC,GAAI,CAAC,EACN,CAAC,CAACA,EAAG,CAACA,CAAC,EACP,CAAC,EAAG,EAAE,EACN,CAACA,EAAG,CAACA,CAAC,CACR,EACaU,EAAI,CAAC,CACpB,CACA,MAAO,CAAC,KAAK,IAAI6I,CAAO,EAAG,KAAK,IAAIA,CAAO,CAAC,CAC9C,CAiCA,GAAGE,EAAyB,CAC1B,OAAI,OAAOA,GAAU,SACZ,KAAK,OAASA,GAAS,KAAK,OAAS,EAE1CA,aAAiBT,EACZ,KAAK,OAASS,EAAM,MAAQ,KAAK,OAASA,EAAM,KAElD,EACT,CASA,SAASA,EAAmCtB,EAA0B,CACpE,GAAI,OAAOsB,GAAU,UAAYA,aAAiBT,EAAS,CACzD,IAAM7I,EAAI,KAAK,IAAI6I,EAAQ,KAAKS,CAAK,CAAC,EACtC,OAAO,KAAK,IAAItJ,EAAE,IAAI,GAAKgI,GAAW,KAAK,IAAIhI,EAAE,IAAI,GAAKgI,GAAWhI,EAAE,IAAI,GAAKgI,CAClF,CACA,MAAO,EACT,CASA,WAAqB,CACnB,OAAO,IAAIa,EAAQ,KAAK,KAAM,CAAC,KAAK,IAAI,CAC1C,CASA,KAAe,CACb,OAAO,IAAIA,EAAQ,CAAC,KAAK,KAAM,CAAC,KAAK,IAAI,CAC3C,CAQA,IAAItF,EAAkC,CACpC,IAAMgG,EAAIV,EAAQ,KAAKtF,CAAK,EAE5B,OAAO,IAAIsF,EAAQ,KAAK,KAAOU,EAAE,KAAM,KAAK,KAAOA,EAAE,IAAI,CAC3D,CAUA,IAAIhG,EAAkC,CACpC,IAAMgG,EAAIV,EAAQ,KAAKtF,CAAK,EAE5B,OAAO,IAAIsF,EAAQ,KAAK,KAAOU,EAAE,KAAM,KAAK,KAAOA,EAAE,IAAI,CAC3D,CAWA,KAAKhG,EAAkC,CACrC,IAAMgG,EAAIV,EAAQ,KAAKtF,CAAK,EAE5B,OAAO,IAAIsF,EAAQ,KAAK,KAAOU,EAAE,KAAO,KAAK,KAAOA,EAAE,KAAM,KAAK,KAAOA,EAAE,KAAO,KAAK,KAAOA,EAAE,IAAI,CACrG,CAqBA,IAAIhG,EAAiD,CACnD,IAAMgG,EAAIV,EAAQ,KAAKtF,CAAK,EACtBvD,EAAIuJ,EAAE,KAAK,EACjB,GAAIvJ,IAAM,EACR,OAAOqG,EAAI,MAAM,kBAAkB,CAAC,EAGtC,IAAMzG,EAAI,KAAK,KAAK2J,EAAE,UAAU,CAAC,EACjC,OAAOvD,EAAG,IAAI6C,EAAQjJ,EAAE,KAAOI,EAAGJ,EAAE,KAAOI,CAAC,CAAC,CAC/C,CAcA,KAAc,CACZ,OAAO,KAAK,KAAK,KAAK,KAAK,CAAC,CAC9B,CAcA,MAAe,CACb,OAAO,KAAK,KAAO,KAAK,KAAO,KAAK,KAAO,KAAK,IAClD,CASA,KAAc,CACZ,OAAO,KAAK,MAAM,KAAK,KAAM,KAAK,IAAI,CACxC,CAWA,IAAIwJ,EAAqC,CACvC,OAAIA,IAAa,IAAO,KAAK,OAAS,GAAK,KAAK,MAAQ,EAC/C,IAAIX,EAAQ,KAAK,KAAK,KAAK,IAAI,EAAG,CAAC,EAExC,KAAK,GAAGA,EAAQ,IAAI,EACfA,EAAQ,KAEV,KAAK,GAAG,EAAE,KAAKA,EAAQ,KAAKW,CAAQ,CAAC,EAAE,IAAI,CACpD,CAKA,KAAe,CACb,OAAOX,EAAQ,MAAM,KAAK,IAAI,KAAK,IAAI,EAAG,KAAK,IAAI,CACrD,CAgBA,OAAOY,EAAyBb,GAAgC,CAC9D,IAAMc,EAAS,IAAIhB,GACjBe,EAAQ,oBAAsB,OAAYb,GAAuB,kBAAoBa,EAAQ,kBAC7FA,EAAQ,sBAAwB,EAChCA,EAAQ,WACV,EACA,OAAOC,EAAO,kBAAoB,KAAK,yBAAyBA,CAAM,EAAI,KAAK,mBAAmBA,CAAM,CAC1G,CAYA,UAAmB,CACjB,IAAMC,EAAY,IAAIjB,GACpBE,GAAuB,kBACvBA,GAAuB,qBACvBA,GAAuB,WACzB,EACA,OAAO,KAAK,yBAAyBe,CAAS,CAChD,CAGQ,IAAc,CACpB,OAAO,IAAId,EAAQ,KAAK,IAAI,KAAK,IAAI,CAAC,EAAG,KAAK,IAAI,CAAC,CACrD,CAIQ,yBAAyBc,EAAoC,CACnE,GAAI,KAAK,qBAAqBA,EAAU,oBAAoB,EAC1D,OAAOA,EAAU,OAAO,KAAK,IAAI,EAGnC,GAAI,KAAK,qBAAqBA,EAAU,oBAAoB,EAAG,CAC7D,IAAIC,EAEJ,OAAI,KAAK,uBAAuBD,EAAU,oBAAoB,EAC5DC,EAAa,GACJ,KAAK,qBAAqBD,EAAU,oBAAoB,EACjEC,EAAa,IAEbA,EAAaD,EAAU,OAAO,KAAK,IAAI,EAGlC,GAAGC,CAAU,GACtB,CAEA,OAAO,KAAK,mBAAmBD,CAAS,CAC1C,CAGQ,mBAAmBA,EAAoC,CAC7D,IAAME,EAAW,KAAK,MAAQ,EAAI,IAAM,IAClCD,EAAa,KAAK,uBAAuBD,CAAS,EAAI,GAAKA,EAAU,OAAO,KAAK,IAAI,KAAK,IAAI,CAAC,EAGrG,MAAO,IAFcA,EAAU,mBAAqBA,EAAU,cAAgB,QAAa,KAAK,KAAO,EAAI,GAAK,KAEvFA,EAAU,OAAO,KAAK,IAAI,EAAIE,EAAWD,CAAU,GAC9E,CAGQ,qBAAqBvB,EAAuC,CAClE,OAAO,KAAK,IAAI,KAAK,IAAI,GAAKA,CAChC,CAGQ,qBAAqBA,EAAuC,CAClE,OAAO,KAAK,IAAI,KAAK,IAAI,GAAKA,CAChC,CAGQ,uBAAuBA,EAAuC,CACpE,OAAO,KAAK,IAAI,KAAK,KAAO,CAAC,GAAKA,CACpC,CAGQ,qBAAqBA,EAAuC,CAClE,OAAO,KAAK,IAAI,KAAK,KAAO,CAAC,GAAKA,CACpC,CAGQ,uBAAuBsB,EAAqC,CAClE,OAAOA,EAAU,mBAAqB,KAAK,IAAI,KAAK,IAAI,KAAK,IAAI,EAAI,CAAC,GAAKA,EAAU,oBACvF,CACF,EAhaad,EAIK,KAAO,IAAIA,EAAQ,EAAG,CAAC,EAJ5BA,EAQK,IAAM,IAAIA,EAAQ,EAAG,CAAC,EAR3BA,EAYK,EAAI,IAAIA,EAAQ,EAAG,CAAC,EAZ/B,IAAMiB,EAANjB,EIIDkB,GAAetJ,EAAA,KAAmB,CAAC,QAAS,aAAa,GAA1C,MAERuJ,GAAN,MAAMA,EAAK,OAAA,CAAAvJ,EAAA,WAChB,OAAO,KAAKwJ,EAAqBlF,EAAiBkC,EAAsC,CACtF,GAAIgD,IAAe,GAAM,CACvB,IAAMC,EAAUjD,IAAS,OAAY,iBAAmB,IAAI,MAAM,UAAU,MAAM,KAAKA,CAAI,EAAE,KAAK,IAAI,CAAC,IAEjGkD,EAAM;;WADIpF,IAAY,OAAY,iBAAmBA,CACL;;QAAamF,CAAO,GAC1E,MAAM,IAAI,MAAMC,CAAG,CACrB,CACF,CAEA,OAAO,QAAWvJ,EAAmC,CACnDoJ,GAAK,KAAKpJ,GAAM,KAAyB,SAAS,CACpD,CAGA,WAAW,SAAkB,CAC3B,IAAMwJ,EAAM,IAAI,IAAI,SAAS,KAAM,OAAO,SAAS,MAAM,EACnDC,EAAO,mBAAmBD,EAAI,QAAQ,EACtCE,EAAiBD,EAAK,YAAY,GAAG,EAE3C,OAAOA,EAAK,UAAUC,EAAiB,CAAC,CAC1C,CAGF,EAxBaN,GAuBJ,cAAgBlD,GAAO,cAAc,KAAK,MAAOiD,EAAY,EAvB/D,IAAMQ,EAANP,GErBMQ,GAA6B,QCA7BC,GAA4B,SCA5BC,GAAsB,ICAtBC,GAAgC,UCAhCC,GAA0B,ICE1BC,GAA8B,YCA9BC,GAAwB,MCFxBC,GAAyB,SCAzBC,GAAuB,KCAvBC,GAAuB,KCAvBC,GAAuB,KCAvBC,GAA4B,UCA5BC,GAAsB,ICAtBC,GAA2B,SCA3BC,GAAyB,OCAzBC,GAA4B,UCA5BC,GAAsB,ICAtBC,GAA2B,MAC3BC,GAA2B,MCD3BC,GAAsB,ICAtBC,GAAsB,ICAtBC,GAAsB,IEW7BjD,GAAwC,CAC5C,kBAAmB,GACnB,qBAAsB,KACtB,YAAa,OACb,cAAe,IACjB,EAEakD,EAAN,MAAMC,CAAO,OAAA,CAAAtL,EAAA,UAyEV,YAAYuL,EAAgBC,EAAeC,EAAsB,CA4EzE,KAAA,KAAO,KAAK,IAAI,KAAK,IAAI,EA3EvB,KAAK,OAASF,EACd,KAAK,MAAQC,EACb,KAAK,OAASC,EAEd,KAAK,KAAO,KAAK,GACnB,CAvEA,OAAO,KAAKC,EAA6D,CACvE,IAAMH,EAASG,EAAK,OACpB,GAAIH,IAAW,EACb,OAAO3F,EAAI,MAAM,eAAe,CAAC,EAEnC,IAAM4F,EAAQE,EAAK,CAAC,EAAE,OACtB,OAAIA,EAAK,CAAC,EAAE,SAAW,EACd9F,EAAI,MAAM,kBAAkB,CAAC,EAG/B0F,EAAO,MAAMC,EAAQC,EAAO,CAACG,EAAKC,IAAQF,EAAKC,CAAG,EAAEC,CAAG,CAAC,CACjE,CAKA,OAAO,iBAAiBC,EAA0D,CAChF,OAAOP,EAAO,MAAMO,EAAS,OAAQ,EAAGF,GAAOE,EAASF,CAAG,CAAC,CAC9D,CAMA,OAAO,MACLJ,EACAC,EACAM,EACuB,CACvB,IAAMC,EAAM,IAAI,aAAaP,EAAQD,EAAS,CAAC,EAE/C,QAASI,EAAM,EAAGA,EAAMJ,EAAQI,IAC9B,QAASC,EAAM,EAAGA,EAAMJ,EAAOI,IAAO,CACpC,IAAMI,GAAML,EAAMH,EAAQI,GAAO,EAC3BK,EAAKD,EAAK,EAEZ7L,EACA2L,EACF3L,EAAI+L,EAAQ,KAAKJ,EAAuBH,EAAKC,CAAG,CAAC,EAEjDzL,EAAI+L,EAAQ,KAAK,CAAC,EAGpBH,EAAIC,CAAE,EAAI7L,EAAE,KACZ4L,EAAIE,CAAE,EAAI9L,EAAE,IACd,CAGF,OAAOmL,EAAO,OAAOC,EAAQC,EAAOO,CAAG,CACzC,CAEA,OAAe,OAAOR,EAAgBC,EAAeC,EAA6C,CAChG,OAAID,EAAQ,EACH5F,EAAI,MAAM,SAAS4F,CAAK,OAAO,CAAC,EAErCD,EAAS,EACJ3F,EAAI,MAAM,UAAU2F,CAAM,OAAO,CAAC,EAEvCC,EAAQD,EAAS,IAAME,EAAO,OACzB7F,EAAI,MAAM,SAAS4F,CAAK,YAAYD,CAAM,yBAAyBE,EAAO,MAAM,GAAG,CAAC,EAGtFlG,EAAG,IAAI+F,EAAOC,EAAQC,EAAOC,CAAM,CAAC,CAC7C,CAaA,QAAQE,EAAaC,EAAqC,CACxD,GAAID,EAAM,GAAKC,EAAM,GAAKD,GAAO,KAAK,QAAUC,GAAO,KAAK,MAC1D,OAAOhG,EAAI,MAAM,sBAAsB,CAAC,EAG1C,IAAMoG,GAAM,KAAK,MAAQL,EAAMC,GAAO,EAChCK,EAAKD,EAAK,EAEhB,OAAOzG,EAAG,IAAI2G,EAAQ,KAAK,OAAOF,CAAE,EAAG,KAAK,OAAOC,CAAE,CAAC,CAAC,CACzD,CAKA,IAAIN,EAAaC,EAAa9I,EAAuC,CACnE,GAAI6I,EAAM,GAAKC,EAAM,GAAKD,GAAO,KAAK,QAAUC,GAAO,KAAK,MAC1D,OAAOhG,EAAI,MAAM,sBAAsB,CAAC,EAG1C,IAAMoG,GAAM,KAAK,MAAQL,EAAMC,GAAO,EAChCK,EAAKD,EAAK,EAEhB,OAAA,KAAK,OAAOA,CAAE,EAAIlJ,EAAM,KACxB,KAAK,OAAOmJ,CAAE,EAAInJ,EAAM,KAEjByC,EAAG,IAAI,CAChB,CAKA,OAAO4G,EAA4C,CACjD,GAAIA,EAAW,EACb,OAAOvG,EAAI,MAAM,cAAc,CAAC,EAElC,GAAIuG,EAAW,KAAK,MAClB,OAAOvG,EAAI,MAAM,uBAAuB,CAAC,EAG3C,IAAMgG,EAAM,CAAC,EACb,QAASD,EAAM,EAAGA,EAAM,KAAK,OAAQA,IAAO,CAC1C,IAAMS,EAAU,KAAK,QAAQT,EAAKQ,CAAQ,EAC1C,GAAIC,EAAQ,MAAM,EAChB,OAAOxG,EAAIwG,EAAQ,KAAK,EAE1BR,EAAI,KAAKQ,EAAQ,KAAK,CACxB,CACA,OAAO7G,EAAGqG,CAAG,CACf,CAKA,IAAI/C,EAAsC,CACxC,GAAIA,EAAM,QAAU,KAAK,OAASA,EAAM,SAAW,KAAK,OACtD,OAAOjD,EAAI,MAAM,oBAAoB,CAAC,EAGxC,IAAMyG,EAAY,IAAI,aAAa,KAAK,OAAO,MAAM,EACrD,QAASvM,EAAI,EAAGA,EAAIuM,EAAU,OAAQvM,IACpCuM,EAAUvM,CAAC,EAAI,KAAK,OAAOA,CAAC,EAAI+I,EAAM,OAAO/I,CAAC,EAGhD,OAAOyF,EAAG,IAAI+F,EAAO,KAAK,OAAQ,KAAK,MAAOe,CAAS,CAAC,CAC1D,CAMA,IAAIxD,EAAsC,CACxC,GAAIA,EAAM,QAAU,KAAK,OAASA,EAAM,SAAW,KAAK,OACtD,OAAOjD,EAAI,MAAM,oBAAoB,CAAC,EAGxC,IAAMyG,EAAY,IAAI,aAAa,KAAK,OAAO,MAAM,EACrD,QAASvM,EAAI,EAAGA,EAAIuM,EAAU,OAAQvM,IACpCuM,EAAUvM,CAAC,EAAI,KAAK,OAAOA,CAAC,EAAI+I,EAAM,OAAO/I,CAAC,EAGhD,OAAOyF,EAAG,IAAI+F,EAAO,KAAK,OAAQ,KAAK,MAAOe,CAAS,CAAC,CAC1D,CAEA,KAAKxD,EAAyD,CAC5D,OAAOA,aAAiByC,EAAS,KAAK,WAAWzC,CAAK,EAAItD,EAAG,KAAK,WAAWsD,CAAK,CAAC,CACrF,CAEA,oBACEyD,EACAC,EACAC,EAAqB,CAAC,EACtBC,EAAyB,CAAC,EAClB,CACR,GAAM,CAAC,MAAOrM,EAAG,OAAQ8L,EAAG,OAAQQ,CAAG,EAAI,KAE3C,QAAWhF,KAAQ8E,EACjBnM,EAAK,KAAKqH,GAAQ,EAAG,0BAA0B,EAC/CrH,EAAK,KAAK6L,GAAK,GAAKxE,EAAM,0BAA0B,EAEtD,QAAWA,KAAQ+E,EACjBpM,EAAK,KAAKqH,GAAQ,EAAG,+BAA+B,EACpDrH,EAAK,KAAK6L,GAAK,GAAKxE,EAAM,+BAA+B,EAG3D,IAAMiF,EAAcH,EAAS,OAAOC,CAAY,EAAE,OAAO,CAACrJ,EAAQsE,IACzDtE,EAAU,GAAKsE,EACrB,CAAC,EACEkF,EAAmBJ,EAAS,OAAO,CAACpJ,EAAQsE,IACzCtE,EAAU,GAAKsE,EACrB,CAAC,EAEJrH,EAAK,MAAMuM,EAAoB,GAAKL,KAAgB,EAAG,6CAA6C,EACpGlM,EAAK,KAAKiM,EAAa,QAAU,GAAKA,EAAa,SAAW,EAAG,qCAAqC,EAEtG,GAAM,CAACzI,EAAIgJ,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,CAAE,EAAIb,EAAa,OAEtDjM,EAAK,KAAKkM,GAAa,EAAG,yBAAyB,EACnDlM,EAAK,KAAK6L,GAAK,GAAKK,EAAW,yBAAyB,EAExD,IAAMR,EAAM,IAAI,aAAaW,CAAG,EAC5B5M,EAAI,EACR,QAASoB,EAAI,EAAGA,EAAIgL,EAAGhL,IAAK,CAC1B,IAAMkM,GAAgBlM,EAAK,GAAKqL,KAAgB,EAC1Cc,GAA2BV,EAAczL,EAAK0L,KAAsB,EAE1E,QAAS9D,EAAI,EAAGA,EAAI1I,EAAG0I,IAAK,CAC1B,GAAIuE,GAA0B,CAACD,EAAc,CAC3C,IAAME,EAAIxN,GAAK,GAAKyM,GAAa,EAAInM,EAC/BmN,EAAKxB,EAAIjM,CAAC,EACV0N,EAAKzB,EAAIjM,EAAI,CAAC,EACd2N,EAAK1B,EAAIuB,CAAC,EACVI,EAAK3B,EAAIuB,EAAI,CAAC,EAEpBvB,EAAIjM,CAAC,EAAIyN,EAAK1J,EAAK2J,EAAKX,EAAKY,EAAKX,EAAKY,EAAKX,EAC5ChB,EAAIjM,EAAI,CAAC,EAAIyN,EAAKV,EAAKW,EAAK3J,EAAK4J,EAAKV,EAAKW,EAAKZ,EAChDf,EAAIuB,CAAC,EAAIC,EAAKP,EAAKQ,EAAKP,EAAKQ,EAAKP,EAAKQ,EAAKP,EAC5CpB,EAAIuB,EAAI,CAAC,EAAIC,EAAKN,EAAKO,EAAKR,EAAKS,EAAKN,EAAKO,EAAKR,CAClD,CACApN,GAAK,CACP,CACF,CAEA,OAAOwL,EAAO,OAAOY,EAAG9L,EAAG2L,CAAG,EAAE,cAAc,CAChD,CAEA,oBAAoBO,EAAsBqB,EAAoBhB,EAA6B,CACzFtM,EAAK,MAAMsM,EAAe,GAAKgB,KAAiB,EAAG,6CAA6C,EAChGtN,EAAK,KAAKiM,EAAa,QAAU,GAAKA,EAAa,SAAW,EAAG,qCAAqC,EAEtG,GAAM,CAAC,MAAOlM,EAAG,OAAQ8L,EAAG,OAAQQ,CAAG,EAAI,KACrC,CAAC7I,EAAIgJ,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,CAAE,EAAIb,EAAa,OAEtDjM,EAAK,KAAK6L,GAAK,GAAKyB,EAAY,sDAAsD,EAEtF,IAAM5B,EAAM,IAAI,aAAaW,CAAG,EAC5B5M,EAAI,EACR,QAASoB,EAAI,EAAGA,EAAIgL,EAAGhL,IAAK,CAC1B,IAAM0M,GAAiBjB,EAAczL,EAAKyL,KAAiB,EACrDkB,GAAY3M,EAAK,GAAKyM,KAAiB,EAC7C,QAAS7E,EAAI,EAAGA,EAAI1I,EAAG0I,IAAK,CAC1B,GAAI,CAAC8E,GAAgB,CAACC,EAAU,CAC9B,IAAMP,EAAIxN,GAAK,GAAK6N,GAAc,EAAIvN,EAChCmN,EAAKxB,EAAIjM,CAAC,EACV0N,EAAKzB,EAAIjM,EAAI,CAAC,EACd2N,EAAK1B,EAAIuB,CAAC,EACVI,EAAK3B,EAAIuB,EAAI,CAAC,EAEpBvB,EAAIjM,CAAC,EAAIyN,EAAK1J,EAAK2J,EAAKX,EAAKY,EAAKX,EAAKY,EAAKX,EAC5ChB,EAAIjM,EAAI,CAAC,EAAIyN,EAAKV,EAAKW,EAAK3J,EAAK4J,EAAKV,EAAKW,EAAKZ,EAChDf,EAAIuB,CAAC,EAAIC,EAAKP,EAAKQ,EAAKP,EAAKQ,EAAKP,EAAKQ,EAAKP,EAC5CpB,EAAIuB,EAAI,CAAC,EAAIC,EAAKN,EAAKO,EAAKR,EAAKS,EAAKN,EAAKO,EAAKR,CAClD,CACApN,GAAK,CACP,CACF,CAEA,OAAOwL,EAAO,OAAOY,EAAG9L,EAAG2L,CAAG,EAAE,cAAc,CAChD,CAOA,MAAoB,CAClB,OAAO+B,GAAM,EAAG,KAAK,OAAS,CAAC,EAAE,IAAenC,GAC9CmC,GAAM,EAAG,KAAK,MAAQ,CAAC,EAAE,IAAalC,GAAO,KAAK,QAAQD,EAAKC,CAAG,EAAE,cAAc,CAAC,CACrF,CACF,CAQA,YAAYrE,EAAU,EAAY,CAChC,GAAI,KAAK,QAAU,KAAK,OACtB,MAAO,GAGT,QAASqE,EAAM,EAAGA,EAAM,KAAK,MAAOA,IAClC,QAASD,EAAM,EAAGA,EAAM,KAAK,OAAQA,IAAO,CAC1C,IAAM7L,GAAK,KAAK,MAAQ6L,EAAMC,GAAO,EAC/B0B,GAAK,KAAK,MAAQ1B,EAAMD,GAAO,EAKrC,GAHI,KAAK,IAAI,KAAK,OAAO7L,CAAC,EAAI,KAAK,OAAOwN,CAAC,CAAC,EAAI/F,GAG5C,KAAK,IAAI,KAAK,OAAOzH,EAAI,CAAC,EAAI,KAAK,OAAOwN,EAAI,CAAC,CAAC,EAAI/F,EACtD,MAAO,EAEX,CAGF,MAAO,EACT,CAOA,OAAiB,CACf,IAAIwG,EAAO,EACPC,EAAO,EACLzO,EAAI,KAAK,MAAQ,EAAI,EAE3B,QAASO,EAAI,EAAGA,EAAI,KAAK,OAAO,OAAQA,GAAKP,EAC3CwO,GAAQ,KAAK,OAAOjO,CAAC,EACrBkO,GAAQ,KAAK,OAAOlO,EAAI,CAAC,EAG3B,OAAO,IAAIoM,EAAQ6B,EAAMC,CAAI,CAC/B,CAOA,SAAkB,CAChB,IAAM5N,EAAI,KAAK,OACT8L,EAAI,KAAK,MACT+B,EAAS,IAAI,aAAa7N,EAAI8L,EAAI,CAAC,EAEzC,QAASP,EAAM,EAAGA,EAAMO,EAAGP,IACzB,QAASC,EAAM,EAAGA,EAAMxL,EAAGwL,IAAO,CAChC,IAAMsC,GAAOtC,EAAM,KAAK,MAAQD,GAAO,EACjCwC,GAAQxC,EAAMvL,EAAIwL,GAAO,EAE/BqC,EAAOE,CAAI,EAAI,KAAK,OAAOD,CAAG,EAC9BD,EAAOE,EAAO,CAAC,EAAI,CAAC,KAAK,OAAOD,EAAM,CAAC,CACzC,CAGF,OAAO,IAAI5C,EAAOY,EAAG9L,EAAG6N,CAAM,CAChC,CAOA,cAAcpF,EAAuB,CACnC,IAAMuF,EAAK,KAAK,MACVC,EAAK,KAAK,OACVC,EAAKzF,EAAM,MACX0F,EAAK1F,EAAM,OACXzI,EAAIgO,EAAKE,EACTpC,EAAImC,EAAKE,EACTlC,EAAY,IAAI,aAAajM,EAAI8L,EAAI,CAAC,EAE5C,QAASsC,EAAK,EAAGA,EAAKH,EAAIG,IACxB,QAASC,EAAK,EAAGA,EAAKF,EAAIE,IACxB,QAASC,EAAK,EAAGA,EAAKN,EAAIM,IACxB,QAASC,EAAK,EAAGA,EAAKL,EAAIK,IAAM,CAC9B,IAAMC,GAAMJ,EAAKJ,EAAKM,GAAM,EACtBG,GAAMJ,EAAKH,EAAKK,GAAM,EACtBG,IAAON,EAAKD,EAAKE,GAAMrO,GAAKsO,EAAKJ,EAAKK,IAAO,EAC7CI,EAAM,KAAK,OAAOH,CAAE,EACpBI,EAAM,KAAK,OAAOJ,EAAK,CAAC,EACxBK,EAAMpG,EAAM,OAAOgG,CAAE,EACrBK,EAAMrG,EAAM,OAAOgG,EAAK,CAAC,EACzBM,EAAMJ,EAAME,EAAMD,EAAME,EACxBE,EAAML,EAAMG,EAAMF,EAAMC,EAE9B5C,EAAUyC,CAAE,EAAIK,EAChB9C,EAAUyC,EAAK,CAAC,EAAIM,CACtB,CAKN,OAAO,IAAI9D,EAAOY,EAAG9L,EAAGiM,CAAS,CACnC,CAOA,GAAGgD,EAAgC,CACjC,GAAI,OAASA,EAAK,MAAO,GACzB,GAAI,EAAEA,aAAe/D,GAAS,MAAO,GAErC,IAAMzC,EAAQwG,EACd,OACE,KAAK,QAAUxG,EAAM,OACrB,KAAK,SAAWA,EAAM,QACtBiF,GAAM,EAAG,KAAK,OAAO,OAAS,CAAC,EAAE,MAAMhO,GAAK,KAAK,OAAOA,CAAC,IAAM+I,EAAM,OAAO/I,CAAC,CAAC,CAElF,CAOA,SAAS+I,EAAyBtB,EAA0B,CAC1D,OACEsB,aAAiByC,GACjB,KAAK,QAAUzC,EAAM,OACrB,KAAK,SAAWA,EAAM,QACtB,KAAK,KAAK,KAAK,IAAIA,CAAK,EAAE,cAAc,EAAE,MAAM,CAAC,GAAKtB,CAE1D,CAEA,OAAOyB,EAAUb,GAAgC,CAC/C,IAAMc,EAAS,IAAIzJ,GACjBwJ,EAAQ,oBAAsB,OAAY,GAAOA,EAAQ,kBACzDA,EAAQ,sBAAwB,EAChCA,EAAQ,YACRA,EAAQ,eAAiB,IAC3B,EAMA,MAAO,KAJM,KAAK,KAAK,EACpB,IAAI2C,GAAOA,EAAI,IAAI3K,GAAKA,EAAE,OAAOiI,CAAM,CAAC,EAAE,KAAKA,EAAO,aAAa,CAAC,EACpE,KAAK,IAAIA,EAAO,aAAa,GAAG,CAEnB,IAClB,CAEA,UAAmB,CACjB,OAAO,KAAK,OAAO,CACrB,CAEA,iCAA4D,CAC1D,GAAI,KAAK,QAAU,GAAK,KAAK,SAAW,EACtC,MAAM,IAAI,MAAM,4BAA4B,EAE9C,GAAI,CAAC,KAAK,YAAY,GAAI,EACxB,MAAM,IAAI,MAAM,qCAAqC,EAEvD,GAAI,CAAC,KAAK,MAAM,EAAE,SAAS,EAAG,GAAI,EAChC,MAAM,IAAI,MAAM,wCAAwC,EAK1D,GAAM,CAACpF,EAAIgJ,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,CAAE,EAAI,KAAK,OACxC9M,EAAI2M,EAAKF,EACTxM,EAAI2M,EAAKF,EACTxM,EAAIsD,EAAKqJ,EACf,MAAO,CAAC7M,EAAGC,EAAGC,CAAC,CACjB,CAEA,OAAgB,CACd,OAAO,IAAI+K,EAAO,KAAK,OAAQ,KAAK,MAAO,KAAK,OAAO,MAAM,CAAC,CAChE,CAEQ,OAAgB,CACtB,IAAIjK,EAAI,EACR,QAAWL,KAAK,KAAK,OACnBK,GAAKL,EAAIA,EAEX,OAAOK,CACT,CAEQ,WAAWwH,EAAsC,CACvD,GAAI,KAAK,QAAUA,EAAM,OACvB,OAAOjD,EAAI,MAAM,qBAAqB,CAAC,EAGzC,IAAMxF,EAAIyI,EAAM,MACVqD,EAAI,KAAK,OACT/M,EAAI,KAAK,MACTkN,EAAY,IAAI,aAAajM,EAAI8L,EAAI,CAAC,EAE5C,QAAShL,EAAI,EAAGA,EAAIgL,EAAGhL,IACrB,QAAS4H,EAAI,EAAGA,EAAI1I,EAAG0I,IAAK,CAC1B,IAAMgG,GAAM5N,EAAId,EAAI0I,GAAK,EACzB,QAASnH,EAAI,EAAGA,EAAIxC,EAAGwC,IAAK,CAC1B,IAAMiN,GAAM1N,EAAI/B,EAAIwC,GAAK,EACnBkN,GAAMlN,EAAIvB,EAAI0I,GAAK,EACnB0F,EAAK,KAAK,OAAOI,CAAE,EACnBU,EAAK,KAAK,OAAOV,EAAK,CAAC,EACvBH,EAAK5F,EAAM,OAAOgG,CAAE,EACpBU,EAAK1G,EAAM,OAAOgG,EAAK,CAAC,EACxBW,EAAKhB,EAAKC,EAAKa,EAAKC,EACpBE,EAAKjB,EAAKe,EAAKd,EAAKa,EAC1BjD,EAAUyC,CAAE,GAAKU,EACjBnD,EAAUyC,EAAK,CAAC,GAAKW,CACvB,CACF,CAGF,OAAOlK,EAAG,IAAI+F,EAAOY,EAAG9L,EAAGiM,CAAS,CAAC,CACvC,CAEQ,WAAWlM,EAA6B,CAC9C,IAAMkM,EAAY,IAAI,aAAa,KAAK,OAAO,MAAM,EAC/CqD,EAAKxD,EAAQ,KAAK/L,CAAC,EACnBwP,EAAKzD,EAAQ,KAAK/L,CAAC,EAEzB,QAASL,EAAI,EAAGA,EAAIuM,EAAU,OAAQvM,GAAK,EAAG,CAC5C,IAAM8P,EAAK,KAAK,OAAO9P,CAAC,EAClB+P,EAAK,KAAK,OAAO/P,EAAI,CAAC,EAC5BuM,EAAUvM,CAAC,EAAI8P,EAAKF,EAAKG,EAAKF,EAC9BtD,EAAUvM,EAAI,CAAC,EAAI8P,EAAKD,EAAKE,EAAKH,CACpC,CAEA,OAAO,IAAIpE,EAAO,KAAK,OAAQ,KAAK,MAAOe,CAAS,CACtD,CACF,EC3gBMvM,EAAIoM,EAAQ,EACZ4D,EAAKhQ,EAAE,IAAI,EAUJiQ,GAAI1E,EAAO,KAAK,CAC3B,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,EAAE,CACR,CAAC,EACE,cAAc,EACd,KAAK,KAAK,KAAK,EAAG,CAAC,EACnB,cAAc,EAUJ2E,GAAI3E,EAAO,KAAK,CAC3B,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,CAAC,CACP,CAAC,EAAE,cAAc,EAUJ4E,GAAI5E,EAAO,KAAK,CAC3B,CAAC,EAAGyE,CAAE,EACN,CAAChQ,EAAG,CAAC,CACP,CAAC,EAAE,cAAc,EAUJoQ,GAAI7E,EAAO,KAAK,CAC3B,CAAC,EAAG,CAAC,EACL,CAAC,EAAG,EAAE,CACR,CAAC,EAAE,cAAc,EAUJ8E,GAAI9E,EAAO,KAAK,CAC3B,CAAC,EAAG,CAAC,EACL,CAAC,EAAGvL,CAAC,CACP,CAAC,EAAE,cAAc,EAUJsQ,GAAUD,GAAE,QAAQ,EAUpBE,GAAIhF,EAAO,KAAK,CAC3B,CAAC,EAAG,CAAC,EACL,CAAC,EAAGvL,EAAE,MAAM,KAAK,GAAK,CAAC,EAAE,IAAI,CAAC,CAChC,CAAC,EAAE,cAAc,EAUJwQ,GAAUD,GAAE,QAAQ,EAU1B,SAASE,GAAMC,EAAqB,CACzC,IAAMC,EAAI/P,GAAO8P,CAAG,EAEpB,OAAOnF,EAAO,KAAK,CACjB,CAAC,EAAG,CAAC,EACL,CAAC,EAAGvL,EAAE,MAAM2Q,CAAC,EAAE,IAAI,CAAC,CACtB,CAAC,EAAE,cAAc,CACnB,CAPgBF,EAAAA,GAAAA,MAiBT,IAAMG,GAAOrF,EAAO,KAAK,CAC9B,CAACvL,EAAE,KAAK,CAAC,EAAGgQ,EAAG,KAAK,CAAC,CAAC,EACtB,CAACA,EAAG,KAAK,CAAC,EAAGhQ,EAAE,KAAK,CAAC,CAAC,CACxB,CAAC,EACE,cAAc,EACd,KAAK,EAAG,EACR,cAAc,EAiBV,SAAS6Q,GAAGC,EAAuB,CACxC,IAAMC,EAAInQ,GAAOkQ,CAAK,EAChBE,EAAQ,KAAK,IAAID,EAAI,CAAC,EACtBE,EAAQ,KAAK,IAAIF,EAAI,CAAC,EAE5B,OAAOxF,EAAO,KAAK,CACjB,CAACyF,EAAOhB,EAAG,MAAMiB,CAAK,CAAC,EACvB,CAACjB,EAAG,MAAMiB,CAAK,EAAGD,CAAK,CACzB,CAAC,EAAE,cAAc,CACnB,CATgBH,EAAAA,GAAAA,MA0BT,SAASK,GAAGJ,EAAuB,CACxC,IAAMC,EAAInQ,GAAOkQ,CAAK,EAChBE,EAAQ,KAAK,IAAID,EAAI,CAAC,EACtBE,EAAQ,KAAK,IAAIF,EAAI,CAAC,EAE5B,OAAOxF,EAAO,KAAK,CACjB,CAACyF,EAAO,CAACC,CAAK,EACd,CAACA,EAAOD,CAAK,CACf,CAAC,EAAE,cAAc,CACnB,CATgBE,EAAAA,GAAAA,MA0BT,SAASC,GAAGL,EAAuB,CACxC,IAAMC,EAAInQ,GAAOkQ,CAAK,EAEtB,OAAOvF,EAAO,KAAK,CACjB,CAACyE,EAAG,MAAMe,EAAI,CAAC,EAAE,IAAI,EAAG,CAAC,EACzB,CAAC,EAAG/Q,EAAE,MAAM+Q,EAAI,CAAC,EAAE,IAAI,CAAC,CAC1B,CAAC,EAAE,cAAc,CACnB,CAPgBI,EAAAA,GAAAA,MC3MT,IAAMC,GAAN,MAAMC,EAAY,OAAA,CAAAnR,EAAA,UAavB,YAAYoR,EAAuB,CAyDnC,KAAA,UAAY,KAAK,SAAS,KAAK,IAAI,EAxDhB,OAAOA,GAApB,SACiB,YACJ,KAAKA,CAAI,EACtB,KAAK,OAAS,KAAK,kBAAkBA,CAAI,EAEzC,KAAK,OAAS,KAAK,kBAAkBA,CAAI,EAG3C,KAAK,OAASA,EAGhB,KAAK,KAAO,KAAK,OAAO,OACxB,KAAK,OAAS,KAAK,KAAK,KAAK,IAAI,EAEjC,KAAK,UAAY,KAAK,QACxB,CAxBA,IAAI,KAAc,CAChB,OAAO,KAAK,OAAO,QAAQ,CAC7B,CAEA,IAAI,KAAc,CAChB,OAAO,KAAK,MACd,CAoBA,UAAUC,EAAwB,CAChC,OAAO,KAAK,OAAO,QAAQA,EAAO,CAAC,EAAE,cAAc,CACrD,CAEA,aAAaA,EAAevO,EAA4C,CACtE,IAAMZ,EAAM,KAAK,OAAO,IAAImP,EAAO,EAAGvO,CAAK,EAC3C,OAAIZ,EAAI,MAAM,EACL0D,EAAI,MAAM1D,EAAI,MAAM,OAAO,CAAC,EAG9BqD,EAAG,IAAI,CAChB,CAEA,YAAY+L,EAAuC,CACjD,OAAO,KAAK,mBAAmBA,CAAG,EAAE,gCAAgC,CACtE,CAEA,uBAAuBzI,EAA8BtB,EAA0B,CAC7E,OAAOsB,aAAiBsI,IAAe,KAAK,OAAO,SAAStI,EAAM,OAAQtB,CAAO,CACnF,CAEA,oBACE+E,EACAqB,EACAnB,EAAqB,CAAC,EACtBC,EAAyB,CAAC,EAClB,CACR,OAAA,KAAK,OAAS,KAAK,OAAO,oBAAoBH,EAAcqB,EAAYnB,EAAUC,CAAY,EACvF,KAAK,MACd,CAEA,oBAAoBH,EAAsBqB,EAAoBhB,EAA6B,CACzF,OAAA,KAAK,OAAS,KAAK,OAAO,oBAAoBL,EAAcqB,EAAYhB,CAAW,EAC5E,KAAK,MACd,CAEA,UAAmB,CACjB,OAAO,KAAK,OAAO,SAAS,CAC9B,CAGQ,kBAAkB4E,EAA2B,CACnD,IAAIC,EAAQ,GACRC,EAAa,GACXC,EAAO,CAAC,EACRC,EAAwB,IAAI,MAAM,mCAAmCJ,CAAS,EAAE,EAEtF,QAAWK,KAAQL,EAAU,MAAM,EAAE,EACnC,OAAQK,EAAM,CACZ,IAAK,IAAK,CACR,GAAIJ,EAAO,MAAMG,EACjBD,EAAK,KAAKrG,EAAO,cAAc,EAAG,CAAC,EAAE,cAAc,CAAC,EACpD,KACF,CACA,IAAK,IAAK,CACR,GAAImG,EAAO,MAAMG,EACjBD,EAAK,KAAKrG,EAAO,cAAc,EAAG,CAAC,EAAE,cAAc,CAAC,EACpD,KACF,CACA,IAAK,IAAK,CACR,GAAImG,EAAO,MAAMG,EACjBD,EAAK,KAAKrG,EAAO,cAAc,EAAG,CAAC,EAAE,cAAc,EAAE,KAAK,KAAK,KAAK,EAAG,CAAC,EAAE,cAAc,CAAC,EACzF,KACF,CACA,IAAK,IAAK,CACJmG,EACFC,GAAc,IAEdC,EAAK,KAAKrG,EAAO,cAAc,EAAG,EAAE,EAAE,cAAc,EAAE,KAAK,KAAK,KAAK,EAAG,CAAC,EAAE,cAAc,CAAC,EAE5F,KACF,CACA,IAAK,IAAK,CACJmG,EACFC,GAAc,IAEdC,EAAK,KAAKrG,EAAO,cAAc,EAAG,IAAIa,EAAQ,EAAG,CAAC,CAAC,EAAE,cAAc,EAAE,KAAK,KAAK,KAAK,EAAG,CAAC,EAAE,cAAc,CAAC,EAE3G,KACF,CACA,IAAK,IAAK,CACR,GAAIsF,EAAO,MAAMG,EACjBH,EAAQ,GACRC,EAAa,GACb,KACF,CACA,IAAK,IAAK,CAER,GADI,CAACD,GACDC,IAAe,KAAM,MAAME,EAC/BD,EAAK,KAAKrG,EAAO,cAAc,EAAG,IAAIa,EAAQ,EAAG,EAAE,CAAC,EAAE,cAAc,EAAE,KAAK,KAAK,KAAK,EAAG,CAAC,EAAE,cAAc,CAAC,EAC1GsF,EAAQ,GACR,KACF,CACA,QACE,MAAMG,CACV,CAGF,GAAID,EAAK,SAAW,EAAG,MAAMC,EAC7B,OAAOD,EAAK,OAAO,CAACtO,EAAQsE,IAAStE,EAAO,cAAcsE,CAAI,CAAC,CACjE,CAEQ,kBAAkBmK,EAAqB,CAC7C,IAAMC,EAAQD,EAAI,MAAM,eAAe,EACvC,GAAIC,IAAU,KACZ,MAAM,IAAI,MAAM,0BAA0BD,CAAG,EAAE,EAEjD,IAAME,EAAYD,EAAM,CAAC,EACnBE,EAAWF,EAAM,CAAC,EAExB,GAAIC,IAAc,GAChB,OAAO,KAAK,kBAAkBC,CAAQ,EACjC,CACL,IAAIC,EACJ,GAAIF,IAAc,IAChBE,EAAO,WACEF,IAAc,IACvBE,EAAO/F,EAAQ,UACN6F,IAAc,KACvBE,EAAO/F,EAAQ,EAAE,MAAM,EAAE,MAEzB,OAAM,IAAI,MAAM,2BAA2B6F,CAAS,EAAE,EAGxD,IAAMG,EAAS,IAAIf,GAAYa,CAAQ,EAAE,OAAO,KAAKC,CAAI,EAEzD,GAAIC,EAAO,MAAM,EACf,MAAM,IAAI,MAAM,0BAA0BF,CAAQ,EAAE,EAGtD,OAAOE,EAAO,KAChB,CACF,CAEA,mBAAmBvE,EAA4B,CAC7C,GAAIA,EAAa,GAAKA,GAAc,KAAK,OACvC,MAAM,IAAI,MAAM,6BAA6BA,CAAU,EAAE,EAG3D,IAAMwE,EAAY,CAAC,GAAG,MAAM,KAAK,KAAK,KAAK,OAAO,MAAM,CAAC,EAAE,KAAK,CAAC,EAAE,OAAOzK,GAAQA,IAASiG,CAAU,EAC/FyE,EAAapS,EAAA,CAACJ,EAAawR,IACxBA,EACJ,KAAK,EACL,QAAQ,EACR,OAAO,CAAChO,EAAQsE,IAAS,CACxB,IAAI2K,EAAOjP,GAAWsE,EAAO,EAC7B2K,EAAOA,GAAQ3K,EACf,IAAM4K,GAAU,GAAK5K,GAAQ,EAAKtE,EAElC,OAAOiP,EAAOC,CAChB,EAAG1S,CAAG,EAVS,KAaf2S,EAAgBlH,EAAO,MAAM,EAAG,CAAC,EAAE,cAAc,EAErD,QAASmH,EAAM,EAAGA,EAAM,KAAK,OAAO,OAAQA,IAC1C,QAASX,EAAM,EAAGA,EAAM,KAAK,OAAO,OAAQA,IAAO,CAIjD,GAAI,CAHaM,EAAU,MAAMpR,IACtByR,GAAOzR,EAAK,MAAS8Q,GAAO9Q,EAAK,EAC3C,EACc,SAEf,IAAM0R,EAAM,KAAK,OACd,QAAQZ,EAAK,CAAC,EACd,cAAc,EACd,MAAM,KAAK,OAAO,QAAQW,EAAK,CAAC,EAAE,cAAc,EAAE,UAAU,CAAC,EAChE,GAAIC,EAAI,UAAU,CAAC,EAAG,SAEtB,IAAMC,EACJN,EAAWP,EAAKM,CAAS,IAAM,EAC3B9G,EAAO,cAAc,EAAG,CAAC,EAAE,cAAc,EACzCA,EAAO,cAAc,EAAG,CAAC,EAAE,cAAc,EACzCsH,EACJP,EAAWI,EAAKL,CAAS,IAAM,EAC3B9G,EAAO,KAAK,CAAC,CAAC,EAAG,CAAC,CAAC,CAAC,EAAE,cAAc,EACpCA,EAAO,KAAK,CAAC,CAAC,EAAG,CAAC,CAAC,CAAC,EAAE,cAAc,EACpCuH,EAASF,EAAO,KAAKC,CAAM,EAAE,cAAc,EAEjDJ,EAAgBA,EAAc,IAAIK,EAAO,KAAKH,CAAG,EAAE,cAAc,CAAC,EAAE,cAAc,CACpF,CAGF,OAAOF,CACT,CACF,EC3NO,SAASM,GAAM1T,EAAW2T,EAAyB,CACxD,OAAO,KAAK,MAAM3T,EAAI,KAAK,IAAI,GAAI2T,CAAO,CAAC,EAAI,KAAK,IAAI,GAAIA,CAAO,CACrE,CAFgBD,EAAAA,GAAAA,MCqCT,IAAME,GAAN,KAAgB,OAAA,CAAA/S,EAAA,WAMrB,YAAYoR,EAAc,CACxB,KAAK,MAAQ,IAAIF,GAAYE,CAAI,EACjC,KAAK,aAAe,CAAC,EACrB,KAAK,MAAQ,CAAC,EACd,KAAK,aAAe,CAAC,CACvB,CAEA,QAAQ4B,EAA8C,CACpD,KAAK,aAAe,CAAC,EAErB,QAAWtL,KAAQsL,EACjB,OAAQtL,EAAK,KAAM,CACjB,KAAKnE,GACH,GAAImE,EAAK,IAAM,CAAC,KAAK,MAAMA,EAAK,EAAE,EAAG,MACrC,KAAK,EAAE,GAAGA,EAAK,QAAS,CAAC,SAAUA,EAAK,SAAU,aAAcA,EAAK,YAAY,CAAC,EAClF,MACF,KAAKuL,GACH,GAAIvL,EAAK,IAAM,CAAC,KAAK,MAAMA,EAAK,EAAE,EAAG,MACrC,KAAK,EAAE,GAAGA,EAAK,QAAS,CAAC,SAAUA,EAAK,SAAU,aAAcA,EAAK,YAAY,CAAC,EAClF,MACF,KAAKwL,GACH,GAAIxL,EAAK,IAAM,CAAC,KAAK,MAAMA,EAAK,EAAE,EAAG,MACrC,KAAK,EAAE,GAAGA,EAAK,QAAS,CAAC,SAAUA,EAAK,SAAU,aAAcA,EAAK,YAAY,CAAC,EAClF,MACF,KAAKyL,GACH,GAAIzL,EAAK,IAAM,CAAC,KAAK,MAAMA,EAAK,EAAE,EAAG,MACrC,KAAK,EAAE,GAAGA,EAAK,QAAS,CAAC,SAAUA,EAAK,SAAU,aAAcA,EAAK,YAAY,CAAC,EAClF,MACF,KAAK0L,GACH,GAAI1L,EAAK,IAAM,CAAC,KAAK,MAAMA,EAAK,EAAE,EAAG,MACrC,KAAK,KAAK,GAAGA,EAAK,QAAS,CAAC,SAAUA,EAAK,SAAU,aAAcA,EAAK,YAAY,CAAC,EACrF,MACF,KAAK2L,GAAqB,CACxB,GAAI3L,EAAK,IAAM,CAAC,KAAK,MAAMA,EAAK,EAAE,EAAG,MACrC,KAAK,EAAE,GAAGA,EAAK,QAAS,CAAC,SAAUA,EAAK,SAAU,aAAcA,EAAK,YAAY,CAAC,EAClF,KACF,CACA,KAAK4L,GAA2B,CAC9B,GAAI5L,EAAK,IAAM,CAAC,KAAK,MAAMA,EAAK,EAAE,EAAG,MACrC,KAAK,QAAQ,GAAGA,EAAK,QAAS,CAAC,SAAUA,EAAK,SAAU,aAAcA,EAAK,YAAY,CAAC,EACxF,KACF,CACA,KAAK6L,GAAqB,CACxB,GAAI7L,EAAK,IAAM,CAAC,KAAK,MAAMA,EAAK,EAAE,EAAG,MACrC,KAAK,EAAE,GAAGA,EAAK,QAAS,CAAC,SAAUA,EAAK,SAAU,aAAcA,EAAK,YAAY,CAAC,EAClF,KACF,CACA,KAAK8L,GAA2B,CAC9B,GAAI9L,EAAK,IAAM,CAAC,KAAK,MAAMA,EAAK,EAAE,EAAG,MACrC,KAAK,QAAQ,GAAGA,EAAK,QAAS,CAAC,SAAUA,EAAK,SAAU,aAAcA,EAAK,YAAY,CAAC,EACxF,KACF,CACA,KAAK+L,GAAyB,CAC5B,GAAI,CAAC/L,EAAK,MAAO,MAAM,IAAI,MAAM,kBAAkB,EACnD,GAAIA,EAAK,IAAM,CAAC,KAAK,MAAMA,EAAK,EAAE,EAAG,MACrC,KAAK,MAAMA,EAAK,MAAO,GAAGA,EAAK,QAAS,CAAC,SAAUA,EAAK,SAAU,aAAcA,EAAK,YAAY,CAAC,EAClG,KACF,CACA,KAAKgM,GACH,GAAI,CAAChM,EAAK,MAAO,MAAM,IAAI,MAAM,kBAAkB,EACnD,GAAIA,EAAK,IAAM,CAAC,KAAK,MAAMA,EAAK,EAAE,EAAG,MACrC,KAAK,GAAGA,EAAK,MAAO,GAAGA,EAAK,QAAS,CAAC,SAAUA,EAAK,SAAU,aAAcA,EAAK,YAAY,CAAC,EAC/F,MACF,KAAKiM,GACH,GAAI,CAACjM,EAAK,MAAO,MAAM,IAAI,MAAM,kBAAkB,EACnD,GAAIA,EAAK,IAAM,CAAC,KAAK,MAAMA,EAAK,EAAE,EAAG,MACrC,KAAK,GAAGA,EAAK,MAAO,GAAGA,EAAK,QAAS,CAAC,SAAUA,EAAK,SAAU,aAAcA,EAAK,YAAY,CAAC,EAC/F,MACF,KAAKkM,GACH,GAAI,CAAClM,EAAK,MAAO,MAAM,IAAI,MAAM,kBAAkB,EACnD,GAAIA,EAAK,IAAM,CAAC,KAAK,MAAMA,EAAK,EAAE,EAAG,MACrC,KAAK,GAAGA,EAAK,MAAO,GAAGA,EAAK,QAAS,CAAC,SAAUA,EAAK,SAAU,aAAcA,EAAK,YAAY,CAAC,EAC/F,MACF,KAAKmM,GAAwB,CAC3B,KAAK,KAAKnM,EAAK,QAAQ,CAAC,EAAGA,EAAK,QAAQ,CAAC,EAAG,CAAC,SAAUA,EAAK,QAAQ,CAAC,EACrE,KACF,CACA,KAAKoM,GAA2B,CAC9B,KAAK,EAAEpM,EAAK,QAAQ,CAAC,EAAG,CAAC,SAAUA,EAAK,QAAQ,MAAM,CAAC,CAAC,CAAC,EACzD,KACF,CACA,KAAK/F,GACH,QAAWoS,KAAUrM,EAAK,QACxB,KAAK,aAAaqM,CAAM,EAE1B,MACF,KAAKC,GACH,KAAK,MAAM,EAAG,GAAGtM,EAAK,OAAO,EAC7B,MACF,KAAKuM,GACH,KAAK,MAAM,EAAG,GAAGvM,EAAK,OAAO,EAC7B,MACF,KAAKwM,GACH,QAAWH,KAAUrM,EAAK,QACxB,KAAK,QAAQqM,CAAM,EACfrM,EAAK,OACP,KAAK,MAAMA,EAAK,IAAI,EAAI,KAAK,aAAaqM,CAAM,IAAM,GAG1D,MACF,KAAKI,GACH,MACF,KAAKC,GACH,KAAK,IAAI1M,EAAK,KAAM,GAAGA,EAAK,OAAO,EACnC,MACF,KAAK2M,GACH,KAAK,UAAU3M,EAAK,KAAM,GAAGA,EAAK,OAAO,EACzC,MAEF,QACE,MAAM,IAAI,MAAM,qBAAqB,CACzC,CAGF,OAAO,IACT,CAKA,KAAKlB,EAAiD,CACpD,GAAM,CAAC,QAAA8N,EAAS,eAAAC,CAAc,EAAI,KAAK,gBAAgB/N,CAAI,EAE3D,OAAA,KAAK,GAAGuJ,GAAGuE,EAASC,CAAc,EAC3B,IACT,CAKA,KAAK/N,EAAiD,CACpD,GAAM,CAAC,QAAA8N,EAAS,eAAAC,CAAc,EAAI,KAAK,gBAAgB/N,CAAI,EAE3D,OAAA,KAAK,GAAGwJ,GAAGsE,EAASC,CAAc,EAC3B,IACT,CAKA,KAAK/N,EAAiD,CACpD,GAAM,CAAC,QAAA8N,EAAS,eAAAC,CAAc,EAAI,KAAK,gBAAgB/N,CAAI,EAE3D,OAAA,KAAK,GAAGyJ,GAAGqE,EAASC,CAAc,EAC3B,IACT,CAKA,KAAK/N,EAAiD,CACpD,GAAM,CAAC,QAAA8N,EAAS,eAAAC,CAAc,EAAI,KAAK,gBAAgB/N,CAAI,EAE3D,OAAA,KAAK,GAAG0J,GAAGoE,EAASC,CAAc,EAC3B,IACT,CAKA,QAAQ/N,EAAiD,CACvD,GAAM,CAAC,QAAA8N,EAAS,eAAAC,CAAc,EAAI,KAAK,gBAAgB/N,CAAI,EAE3D,OAAA,KAAK,GAAGkK,GAAM4D,EAASC,CAAc,EAC9B,IACT,CAKA,KAAK/N,EAAiD,CACpD,GAAM,CAAC,QAAA8N,EAAS,eAAAC,CAAc,EAAI,KAAK,gBAAgB/N,CAAI,EAE3D,OAAA,KAAK,GAAG2J,GAAGmE,EAASC,CAAc,EAC3B,IACT,CAKA,WAAW/N,EAAiD,CAC1D,GAAM,CAAC,QAAA8N,EAAS,eAAAC,CAAc,EAAI,KAAK,gBAAgB/N,CAAI,EAE3D,OAAA,KAAK,GAAG4J,GAASkE,EAASC,CAAc,EACjC,IACT,CAKA,KAAK/N,EAAiD,CACpD,GAAM,CAAC,QAAA8N,EAAS,eAAAC,CAAc,EAAI,KAAK,gBAAgB/N,CAAI,EAE3D,OAAA,KAAK,GAAG6J,GAAGiE,EAASC,CAAc,EAC3B,IACT,CAKA,WAAW/N,EAAiD,CAC1D,GAAM,CAAC,QAAA8N,EAAS,eAAAC,CAAc,EAAI,KAAK,gBAAgB/N,CAAI,EAE3D,OAAA,KAAK,GAAG8J,GAASgE,EAASC,CAAc,EACjC,IACT,CAKA,MAAM/D,KAAgBhK,EAAiD,CACrE,GAAM,CAAC,QAAA8N,EAAS,eAAAC,CAAc,EAAI,KAAK,gBAAgB/N,CAAI,EAE3D,OAAA,KAAK,GAAG+J,GAAMC,CAAG,EAAG8D,EAASC,CAAc,EACpC,IACT,CAKA,GAAG3D,KAAkBpK,EAAiD,CACpE,GAAM,CAAC,QAAA8N,EAAS,eAAAC,CAAc,EAAI,KAAK,gBAAgB/N,CAAI,EAE3D,OAAA,KAAK,GAAGmK,GAAGC,CAAK,EAAG0D,EAASC,CAAc,EACnC,IACT,CAKA,GAAG3D,KAAkBpK,EAAiD,CACpE,GAAM,CAAC,QAAA8N,EAAS,eAAAC,CAAc,EAAI,KAAK,gBAAgB/N,CAAI,EAE3D,OAAA,KAAK,GAAGwK,GAAGJ,CAAK,EAAG0D,EAASC,CAAc,EACnC,IACT,CAKA,GAAG3D,KAAkBpK,EAAiD,CACpE,GAAM,CAAC,QAAA8N,EAAS,eAAAC,CAAc,EAAI,KAAK,gBAAgB/N,CAAI,EAE3D,OAAA,KAAK,GAAGyK,GAAGL,CAAK,EAAG0D,EAASC,CAAc,EACnC,IACT,CAOA,KAAKC,EAAiBC,EAAiBF,EAA4C,CACjF,IAAM/H,EAAW+H,GAAgB,UAAY,CAAC,EAE9C,OAAA,KAAK,EAAEE,EAAS,CAAC,SAAUjI,EAAS,OAAO,CAACgI,CAAO,CAAC,CAAC,CAAC,EACnD,EAAEA,EAAS,CAAC,SAAUhI,EAAS,OAAO,CAACiI,CAAO,CAAC,CAAC,CAAC,EACjD,EAAEA,EAAS,CAAC,SAAUjI,EAAS,OAAO,CAACgI,CAAO,CAAC,CAAC,CAAC,EAC7C,IACT,CAKA,aAAaT,EAA2B,CACtC,GAAM,CAAC1T,EAAGC,EAAGC,CAAC,EAAI,KAAK,MAAM,YAAYwT,CAAM,EAC/C,OAAA,KAAK,aAAaA,CAAM,EAAI,CAAC,EAAA1T,EAAG,EAAAC,EAAG,EAAAC,CAAC,EAC7B,IACT,CAKA,MAAMuC,KAAiBwR,EAA8B,CACnD,QAAWjT,KAAKiT,EAAS,CACvB,IAAMI,EAAQ7B,GAAM,KAAK,MAAMxR,CAAC,EAAG,CAAC,GAE/ByB,IAAU,GAAK4R,IAAU,GAAO5R,IAAU,GAAK4R,IAAU,IAC5D,KAAK,EAAErT,CAAC,CAEZ,CACA,OAAO,IACT,CAKA,WAAWiT,EAA8B,CACvC,QAAW,KAAKA,EAAS,CACvB,IAAMI,EAAQ,KAAK,MAAM,CAAC,EAG1B,GAFa,KAAK,OAAO,GAEbA,EAAO,CACjB,QAASpD,EAAM,EAAGA,EAAM,GAAK,KAAK,MAAM,OAAQA,IAAO,CAChDA,EAAO,GAAK,GAAW,KAAK,MAAM,aAAaA,EAAKpF,EAAQ,IAAI,EACrE,IAAMhK,EAAM,KAAK,MAAM,UAAUoP,CAAG,EAAE,IAAI,KAAK,KAAKoD,CAAK,CAAC,EAE1D,GAAIxS,EAAI,MAAM,EACZ,MAAM,MAAMA,EAAI,MAAM,OAAO,EAE/B,KAAK,MAAM,aAAaoP,EAAKpP,EAAI,KAAK,CACxC,CACA,KAAK,aAAa,CAAC,EAAI,CACzB,KAAO,CACL,QAASoP,EAAM,EAAGA,EAAM,GAAK,KAAK,MAAM,OAAQA,IAAO,CAChDA,EAAO,GAAK,GAAW,KAAK,MAAM,aAAaA,EAAKpF,EAAQ,IAAI,EACrE,IAAMhK,EAAM,KAAK,MAAM,UAAUoP,CAAG,EAAE,IAAI,KAAK,KAAK,EAAIoD,CAAK,CAAC,EAE9D,GAAIxS,EAAI,MAAM,EACZ,MAAM,MAAMA,EAAI,MAAM,OAAO,EAE/B,KAAK,MAAM,aAAaoP,EAAKpP,EAAI,KAAK,CACxC,CACA,KAAK,aAAa,CAAC,EAAI,CACzB,CACF,CACA,OAAO,IACT,CAKA,IAAIyS,KAAyBL,EAA8B,CACzD,QAAW5M,KAAQ4M,EACjB,KAAK,mBAAmBK,EAAMjN,CAAI,EAEpC,OAAO,IACT,CAKA,UAAUiN,KAAyBL,EAA8B,CAC/D,QAAW5M,KAAQ4M,EACjB,KAAK,yBAAyBK,EAAMjN,CAAI,EAE1C,OAAO,IACT,CAEQ,mBAAmBiN,EAAsBZ,EAA2B,CAC1E,QAASjU,EAAI,EAAGA,EAAI6U,EAAM7U,IAAK,CAC7B,KAAK,EAAEiU,EAASjU,CAAC,EACjB,QAASwN,EAAI,EAAGA,EAAIqH,EAAO7U,EAAGwN,IAC5B,KAAK,MAAM,UAAK,GAAKA,CAAC,GAAIyG,EAASjU,EAAG,CAAC,SAAU,CAACiU,EAASjU,EAAIwN,CAAC,CAAC,CAAC,CAEtE,CACA,OAAO,IACT,CAEQ,yBAAyBqH,EAAsBZ,EAA2B,CAChF,QAASjU,EAAI6U,EAAO,EAAG7U,GAAK,EAAGA,IAAK,CAClC,QAASwN,EAAIqH,EAAO7U,EAAI,EAAGwN,EAAI,EAAGA,IAChC,KAAK,MAAM,WAAM,GAAKA,CAAC,GAAIyG,EAASjU,EAAG,CAAC,SAAU,CAACiU,EAASjU,EAAIwN,CAAC,CAAC,CAAC,EAErE,KAAK,EAAEyG,EAASjU,CAAC,CACnB,CACA,OAAO,IACT,CAEQ,gBAAgB0G,EAGtB,CACA,IAAM+N,EAAiB,OAAO/N,EAAKA,EAAK,OAAS,CAAC,GAAM,SAAYA,EAAK,IAAI,EAAuB,CAAC,EAGrG,MAAO,CAAC,QAFQA,EAEC,eAAA+N,CAAc,CACjC,CAEQ,GAAGK,EAAWN,EAAmBO,EAA0C,CACjF,QAAWxT,KAAKiT,EACd,KAAK,MAAM,oBAAoBM,EAAGvT,EAAGwT,EAAmB,SAAUA,EAAmB,YAAY,CAErG,CAEQ,MAAMd,EAAwB,CACpC,IAAIe,EAAI,EACR,QAASxD,EAAM,EAAGA,EAAM,GAAK,KAAK,MAAM,OAAQA,IACzCA,EAAO,GAAKyC,IACfe,GAAK,KAAK,IAAI,KAAK,MAAM,UAAUxD,CAAG,EAAE,IAAI,EAAG,CAAC,GAGpD,OAAOwD,CACT,CACF,EC3aA,IAAAC,GAAqB,S8BerB,SAASC,GAAUC,EAASC,EAAYC,EAAGC,EAAW,CAClD,SAASC,EAAMC,EAAO,CAAE,OAAOA,aAAiBH,EAAIG,EAAQ,IAAIH,EAAE,SAAUI,EAAS,CAAEA,EAAQD,CAAK,CAAG,CAAC,CAAG,CAAlG,OAAAE,EAAAH,EAAA,SACF,IAAKF,IAAMA,EAAI,UAAU,SAAUI,EAASE,EAAQ,CACvD,SAASC,EAAUJ,EAAO,CAAE,GAAI,CAAEK,EAAKP,EAAU,KAAKE,CAAK,CAAC,CAAG,OAASM,EAAG,CAAEH,EAAOG,CAAC,CAAG,CAAE,CAAjFJ,EAAAE,EAAA,aACT,SAASG,EAASP,EAAO,CAAE,GAAI,CAAEK,EAAKP,EAAU,MAASE,CAAK,CAAC,CAAG,OAASM,EAAG,CAAEH,EAAOG,CAAC,CAAG,CAAE,CAApFJ,EAAAK,EAAA,YACT,SAASF,EAAKG,EAAQ,CAAEA,EAAO,KAAOP,EAAQO,EAAO,KAAK,EAAIT,EAAMS,EAAO,KAAK,EAAE,KAAKJ,EAAWG,CAAQ,CAAG,CAApGL,EAAAG,EAAA,QACTA,GAAMP,EAAYA,EAAU,MAAMH,EAASC,GAAc,CAAC,CAAC,GAAG,KAAK,CAAC,CACxE,CAAC,CACL,CARSM,EAAAR,GAAA,aAUT,SAASe,GAAYd,EAASe,EAAM,CAChC,IAAIC,EAAI,CAAE,MAAO,EAAG,KAAM,UAAW,CAAE,GAAIC,EAAE,CAAC,EAAI,EAAG,MAAMA,EAAE,CAAC,EAAG,OAAOA,EAAE,CAAC,CAAG,EAAG,KAAM,CAAC,EAAG,IAAK,CAAC,CAAE,EAAGC,EAAGC,EAAGF,EAAGG,EAC/G,OAAOA,EAAI,CAAE,KAAMC,EAAK,CAAC,EAAG,MAASA,EAAK,CAAC,EAAG,OAAUA,EAAK,CAAC,CAAE,EAAG,OAAO,QAAW,aAAeD,EAAE,OAAO,QAAQ,EAAI,UAAW,CAAE,OAAO,IAAM,GAAIA,EACvJ,SAASC,EAAKC,EAAG,CAAE,OAAO,SAAUC,EAAG,CAAE,OAAOb,EAAK,CAACY,EAAGC,CAAC,CAAC,CAAG,CAAG,CACjE,SAASb,EAAKc,EAAI,CACd,GAAIN,EAAG,MAAM,IAAI,UAAU,iCAAiC,EAC5D,KAAOF,GAAG,GAAI,CACV,GAAIE,EAAI,EAAGC,IAAMF,EAAIO,EAAG,CAAC,EAAI,EAAIL,EAAE,OAAYK,EAAG,CAAC,EAAIL,EAAE,SAAcF,EAAIE,EAAE,SAAcF,EAAE,KAAKE,CAAC,EAAG,GAAKA,EAAE,OAAS,EAAEF,EAAIA,EAAE,KAAKE,EAAGK,EAAG,CAAC,CAAC,GAAG,KAAM,OAAOP,EAE3J,OADIE,EAAI,EAAGF,IAAGO,EAAK,CAACA,EAAG,CAAC,EAAI,EAAGP,EAAE,KAAK,GAC9BO,EAAG,CAAC,EAAG,CACX,IAAK,GAAG,IAAK,GAAGP,EAAIO,EAAI,MACxB,IAAK,GAAG,OAAAR,EAAE,QAAgB,CAAE,MAAOQ,EAAG,CAAC,EAAG,KAAM,EAAM,EACtD,IAAK,GAAGR,EAAE,QAASG,EAAIK,EAAG,CAAC,EAAGA,EAAK,CAAC,CAAC,EAAG,SACxC,IAAK,GAAGA,EAAKR,EAAE,IAAI,IAAI,EAAGA,EAAE,KAAK,IAAI,EAAG,SACxC,QACI,GAAMC,EAAID,EAAE,KAAM,EAAAC,EAAIA,EAAE,OAAS,GAAKA,EAAEA,EAAE,OAAS,CAAC,KAAOO,EAAG,CAAC,IAAM,GAAKA,EAAG,CAAC,IAAM,GAAI,CAAER,EAAI,EAAG,QAAU,CAC3G,GAAIQ,EAAG,CAAC,IAAM,IAAM,CAACP,GAAMO,EAAG,CAAC,EAAIP,EAAE,CAAC,GAAKO,EAAG,CAAC,EAAIP,EAAE,CAAC,GAAK,CAAED,EAAE,MAAQQ,EAAG,CAAC,EAAG,KAAO,CACrF,GAAIA,EAAG,CAAC,IAAM,GAAKR,EAAE,MAAQC,EAAE,CAAC,EAAG,CAAED,EAAE,MAAQC,EAAE,CAAC,EAAGA,EAAIO,EAAI,KAAO,CACpE,GAAIP,GAAKD,EAAE,MAAQC,EAAE,CAAC,EAAG,CAAED,EAAE,MAAQC,EAAE,CAAC,EAAGD,EAAE,IAAI,KAAKQ,CAAE,EAAG,KAAO,CAC9DP,EAAE,CAAC,GAAGD,EAAE,IAAI,IAAI,EACpBA,EAAE,KAAK,IAAI,EAAG,QACtB,CACAQ,EAAKT,EAAK,KAAKf,EAASgB,CAAC,CAC7B,OAASL,EAAG,CAAEa,EAAK,CAAC,EAAGb,CAAC,EAAGQ,EAAI,CAAG,QAAE,CAAUD,EAAID,EAAI,CAAG,CACzD,GAAIO,EAAG,CAAC,EAAI,EAAG,MAAMA,EAAG,CAAC,EAAG,MAAO,CAAE,MAAOA,EAAG,CAAC,EAAIA,EAAG,CAAC,EAAI,OAAQ,KAAM,EAAK,CACnF,CACJ,CA1BSjB,EAAAO,GAAA,eA4BT,SAASW,GAAOC,EAAGJ,EAAG,CAClB,IAAIK,EAAI,OAAO,QAAW,YAAcD,EAAE,OAAO,QAAQ,EACzD,GAAI,CAACC,EAAG,OAAOD,EACf,IAAIE,EAAID,EAAE,KAAKD,CAAC,EAAGG,EAAGC,EAAK,CAAC,EAAGnB,EAC/B,GAAI,CACA,MAAQW,IAAM,QAAUA,KAAM,IAAM,EAAEO,EAAID,EAAE,KAAK,GAAG,MAAME,EAAG,KAAKD,EAAE,KAAK,CAC7E,OACOE,EAAO,CAAEpB,EAAI,CAAE,MAAOoB,CAAM,CAAG,QACtC,CACI,GAAI,CACIF,GAAK,CAACA,EAAE,OAASF,EAAIC,EAAE,SAAYD,EAAE,KAAKC,CAAC,CACnD,QACA,CAAU,GAAIjB,EAAG,MAAMA,EAAE,KAAO,CACpC,CACA,OAAOmB,CACX,CAfSvB,EAAAkB,GAAA,UAiBT,SAASO,EAAcC,EAAIC,EAAMC,EAAM,CACnC,GAAIA,GAAQ,UAAU,SAAW,EAAG,QAASP,EAAI,EAAGQ,EAAIF,EAAK,OAAQJ,EAAIF,EAAIQ,EAAGR,KACxEE,GAAM,EAAEF,KAAKM,MACRJ,IAAIA,EAAK,MAAM,UAAU,MAAM,KAAKI,EAAM,EAAGN,CAAC,GACnDE,EAAGF,CAAC,EAAIM,EAAKN,CAAC,GAGtB,OAAOK,EAAG,OAAOH,GAAM,MAAM,UAAU,MAAM,KAAKI,CAAI,CAAC,CAC3D,CARS3B,EAAAyB,EAAA,iBAUT,IAAIK,GAAqB,CACrB,eAAgB,EACpB,EAGIC,GAAwB/B,EAAA,SAAUgC,EAAS1B,EAAQ2B,EAAQ,CACvDA,IAAW,SAAUA,EAASH,IAClC,IAAII,EAAO5B,EAAO,KAAK,EACjB,CAAE,KAAM,KAAM,MAAOA,EAAO,KAAM,EAClC,CAAE,KAAM,MAAO,MAAOA,EAAO,KAAM,EACrC6B,EAAaF,EAAO,eAAiB,IAAI,MAAM,EAAE,MAAQ,OAC7D,MAAO,CACH,KAAMC,EACN,QAASF,EACT,MAAOG,CACX,CACJ,EAX4B,yBAaxBC,GAA6B,UAAY,CACzC,SAASA,EAAYC,EAAK,CACtB,KAAK,SAAWA,CACpB,CAFS,OAAArC,EAAAoC,EAAA,eAGTA,EAAY,gBAAkB,SAAUE,EAAS,CAC7C,IAAIC,EAAaD,EAAQ,KAAK,SAAUxC,EAAO,CAAE,OAAO,IAAI0C,EAAG1C,CAAK,CAAG,CAAC,EACxE,OAAO,IAAIsC,EAAYG,CAAU,CACrC,EACAH,EAAY,YAAc,SAAUE,EAASG,EAAS,CAClD,IAAIF,EAAaD,EACZ,KAAK,SAAUxC,EAAO,CAAE,OAAO,IAAI0C,EAAG1C,CAAK,CAAG,CAAC,EAAE,MAAS,SAAUM,EAAG,CAAE,OAAO,IAAIsC,EAAID,EAAQrC,CAAC,CAAC,CAAG,CAAC,EAC3G,OAAO,IAAIgC,EAAYG,CAAU,CACrC,EACAH,EAAY,QAAU,SAAUO,EAAiB,CAC7C,OAAOC,GAAuBD,CAAe,CACjD,EACAP,EAAY,qBAAuB,SAAUO,EAAiB,CAC1D,OAAOE,GAAoCF,CAAe,CAC9D,EACAP,EAAY,UAAU,IAAM,SAAUzB,EAAG,CACrC,IAAImC,EAAQ,KACZ,OAAO,IAAIV,EAAY,KAAK,SAAS,KAAK,SAAUC,EAAK,CAAE,OAAO7C,GAAUsD,EAAO,OAAQ,OAAQ,UAAY,CAC3G,IAAIC,EACJ,OAAOxC,GAAY,KAAM,SAAUyC,EAAI,CACnC,OAAQA,EAAG,MAAO,CACd,IAAK,GACD,OAAIX,EAAI,MAAM,EACH,CAAC,EAAc,IAAIK,EAAIL,EAAI,KAAK,CAAC,GAE5CU,EAAKP,EAAG,KACD,CAAC,EAAa7B,EAAE0B,EAAI,KAAK,CAAC,GACrC,IAAK,GAAG,MAAO,CAAC,EAAc,IAAKU,EAAG,MAAMP,EAAI,CAAC,OAAQQ,EAAG,KAAK,CAAC,CAAC,EAAI,CAC3E,CACJ,CAAC,CACL,CAAC,CAAG,CAAC,CAAC,CACV,EACAZ,EAAY,UAAU,OAAS,SAAUzB,EAAG,CACxC,IAAImC,EAAQ,KACZ,OAAO,IAAIV,EAAY,KAAK,SAAS,KAAK,SAAUC,EAAK,CAAE,OAAO7C,GAAUsD,EAAO,OAAQ,OAAQ,UAAY,CAC3G,IAAIC,EACJ,OAAOxC,GAAY,KAAM,SAAUyC,EAAI,CACnC,OAAQA,EAAG,MAAO,CACd,IAAK,GACD,OAAIX,EAAI,KAAK,EACF,CAAC,EAAc,IAAIG,EAAGH,EAAI,KAAK,CAAC,GAE3CU,EAAKL,EAAI,KACF,CAAC,EAAa/B,EAAE0B,EAAI,KAAK,CAAC,GACrC,IAAK,GAAG,MAAO,CAAC,EAAc,IAAKU,EAAG,MAAML,EAAK,CAAC,OAAQM,EAAG,KAAK,CAAC,CAAC,EAAI,CAC5E,CACJ,CAAC,CACL,CAAC,CAAG,CAAC,CAAC,CACV,EAEAZ,EAAY,UAAU,QAAU,SAAUzB,EAAG,CACzC,OAAO,IAAIyB,EAAY,KAAK,SAAS,KAAK,SAAUC,EAAK,CACrD,GAAIA,EAAI,MAAM,EACV,OAAO,IAAIK,EAAIL,EAAI,KAAK,EAE5B,IAAIY,EAAWtC,EAAE0B,EAAI,KAAK,EAC1B,OAAOY,aAAoBb,EAAca,EAAS,SAAWA,CACjE,CAAC,CAAC,CACN,EAEAb,EAAY,UAAU,OAAS,SAAUzB,EAAG,CACxC,IAAImC,EAAQ,KACZ,OAAO,IAAIV,EAAY,KAAK,SAAS,KAAK,SAAUC,EAAK,CAAE,OAAO7C,GAAUsD,EAAO,OAAQ,OAAQ,UAAY,CAC3G,OAAOvC,GAAY,KAAM,SAAUwC,EAAI,CACnC,OAAIV,EAAI,MAAM,EACH,CAAC,EAAc1B,EAAE0B,EAAI,KAAK,CAAC,EAE/B,CAAC,EAAc,IAAIG,EAAGH,EAAI,KAAK,CAAC,CAC3C,CAAC,CACL,CAAC,CAAG,CAAC,CAAC,CACV,EACAD,EAAY,UAAU,MAAQ,SAAUc,EAAIC,EAAM,CAC9C,OAAO,KAAK,SAAS,KAAK,SAAUd,EAAK,CAAE,OAAOA,EAAI,MAAMa,EAAIC,CAAI,CAAG,CAAC,CAC5E,EACAf,EAAY,UAAU,SAAW,SAAU,EAAG,CAC1C,OAAO,KAAK,SAAS,KAAK,SAAUC,EAAK,CAAE,OAAOA,EAAI,SAAS,CAAC,CAAG,CAAC,CACxE,EAEAD,EAAY,UAAU,KAAO,SAAUgB,EAAiBC,EAAiB,CACrE,OAAO,KAAK,SAAS,KAAKD,EAAiBC,CAAe,CAC9D,EACOjB,CACX,EAAE,EAIF,IAAIkB,GAAWC,EAAA,SAAUC,EAAK,CAC1B,OAAO,IAAIC,GAAY,QAAQ,QAAQ,IAAIC,EAAIF,CAAG,CAAC,CAAC,CACxD,EAFe,YAGXG,GAAcF,GAAY,YAC1BG,GAAkBH,GAAY,gBAE9BI,GAAyBN,EAAA,SAAUO,EAAO,CAAE,OAAO,SAAUC,EAAM,CAAE,OAAOC,EAAcA,EAAc,CAAC,EAAGC,GAAOF,CAAI,EAAG,EAAK,EAAG,CAACD,CAAK,EAAG,EAAK,CAAG,CAAG,EAA7H,0BAIzBI,GAAoBX,EAAA,SAAUY,EAAY,CAC1C,OAAOA,EAAW,OAAO,SAAUC,EAAKC,EAAQ,CAC5C,OAAOD,EAAI,KAAK,EACVC,EAAO,MAAM,EACTb,EAAIa,EAAO,KAAK,EAChBD,EAAI,IAAIP,GAAuBQ,EAAO,KAAK,CAAC,EAChDD,CACV,EAAGE,EAAG,CAAC,CAAC,CAAC,CACb,EARwB,qBAcpBC,GAAyBhB,EAAA,SAAUiB,EAAiB,CACpD,OAAOf,GAAY,gBAAgB,QAAQ,IAAIe,CAAe,CAAC,EAAE,QAAQN,EAAiB,CAC9F,EAF6B,0BAMzBO,GAAiClB,EAAA,SAAUY,EAAY,CACvD,OAAOA,EAAW,OAAO,SAAUC,EAAKC,EAAQ,CAC5C,OAAOA,EAAO,MAAM,EACdD,EAAI,MAAM,EACNZ,EAAIQ,EAAcA,EAAc,CAAC,EAAGC,GAAOG,EAAI,KAAK,EAAG,EAAK,EAAG,CAACC,EAAO,KAAK,EAAG,EAAK,CAAC,EACrFb,EAAI,CAACa,EAAO,KAAK,CAAC,EACtBD,EAAI,MAAM,EACNA,EACAE,EAAGN,EAAcA,EAAc,CAAC,EAAGC,GAAOG,EAAI,KAAK,EAAG,EAAK,EAAG,CAACC,EAAO,KAAK,EAAG,EAAK,CAAC,CAClG,EAAGC,EAAG,CAAC,CAAC,CAAC,CACb,EAVqC,kCAWjCI,GAAsCnB,EAAA,SAAUiB,EAAiB,CACjE,OAAOf,GAAY,gBAAgB,QAAQ,IAAIe,CAAe,CAAC,EAAE,QAAQC,EAA8B,CAC3G,EAF0C,uCAKtCE,IACH,SAAUA,EAAQ,CASf,SAASC,EAAcC,EAAIC,EAAS,CAChC,OAAO,UAAY,CAEf,QADIC,EAAO,CAAC,EACHC,EAAK,EAAGA,EAAK,UAAU,OAAQA,IACpCD,EAAKC,CAAE,EAAI,UAAUA,CAAE,EAE3B,GAAI,CACA,IAAIX,EAASQ,EAAG,MAAM,OAAQb,EAAc,CAAC,EAAGC,GAAOc,CAAI,EAAG,EAAK,CAAC,EACpE,OAAOT,EAAGD,CAAM,CACpB,OACOY,EAAG,CACN,OAAOzB,EAAIsB,EAAUA,EAAQG,CAAC,EAAIA,CAAC,CACvC,CACJ,CACJ,CAdS1B,EAAAqB,EAAA,iBAeTD,EAAO,cAAgBC,EACvB,SAASM,EAAQf,EAAY,CACzB,OAAOD,GAAkBC,CAAU,CACvC,CAFSZ,EAAA2B,EAAA,WAGTP,EAAO,QAAUO,EACjB,SAASC,EAAqBhB,EAAY,CACtC,OAAOM,GAA+BN,CAAU,CACpD,CAFSZ,EAAA4B,EAAA,wBAGTR,EAAO,qBAAuBQ,CAClC,GAAGR,KAAWA,GAAS,CAAC,EAAE,EAC1B,IAAIL,EAAKf,EAAA,SAAUO,EAAO,CAAE,OAAO,IAAIsB,EAAGtB,CAAK,CAAG,EAAzC,MACLN,EAAMD,EAAA,SAAUC,EAAK,CAAE,OAAO,IAAIE,EAAIF,CAAG,CAAG,EAAtC,OACN4B,EAAoB,UAAY,CAChC,SAASA,EAAGtB,EAAO,CACf,KAAK,MAAQA,CACjB,CAFS,OAAAP,EAAA6B,EAAA,MAGTA,EAAG,UAAU,KAAO,UAAY,CAC5B,MAAO,EACX,EACAA,EAAG,UAAU,MAAQ,UAAY,CAC7B,MAAO,CAAC,KAAK,KAAK,CACtB,EACAA,EAAG,UAAU,IAAM,SAAUC,EAAG,CAC5B,OAAOf,EAAGe,EAAE,KAAK,KAAK,CAAC,CAC3B,EAEAD,EAAG,UAAU,OAAS,SAAUE,EAAI,CAChC,OAAOhB,EAAG,KAAK,KAAK,CACxB,EAEAc,EAAG,UAAU,QAAU,SAAUC,EAAG,CAChC,OAAOA,EAAE,KAAK,KAAK,CACvB,EAEAD,EAAG,UAAU,OAAS,SAAUE,EAAI,CAChC,OAAOhB,EAAG,KAAK,KAAK,CACxB,EACAc,EAAG,UAAU,aAAe,SAAUC,EAAG,CACrC,OAAOA,EAAE,KAAK,KAAK,CACvB,EACAD,EAAG,UAAU,SAAW,SAAUC,EAAG,CACjC,OAAO5B,GAAY,gBAAgB4B,EAAE,KAAK,KAAK,CAAC,CACpD,EAEAD,EAAG,UAAU,SAAW,SAAUG,EAAI,CAClC,OAAO,KAAK,KAChB,EAEAH,EAAG,UAAU,MAAQ,SAAUd,EAAIkB,EAAM,CACrC,OAAOlB,EAAG,KAAK,KAAK,CACxB,EACAc,EAAG,UAAU,cAAgB,SAAUK,EAAG,CACtC,OAAO,KAAK,KAChB,EACAL,EAAG,UAAU,iBAAmB,SAAUM,EAAQ,CAC9C,MAAMC,GAAsB,qCAAsC,KAAMD,CAAM,CAClF,EACON,CACX,EAAE,EACE1B,EAAqB,UAAY,CACjC,SAASA,EAAIkC,EAAO,CAChB,KAAK,MAAQA,CACjB,CAFS,OAAArC,EAAAG,EAAA,OAGTA,EAAI,UAAU,KAAO,UAAY,CAC7B,MAAO,EACX,EACAA,EAAI,UAAU,MAAQ,UAAY,CAC9B,MAAO,CAAC,KAAK,KAAK,CACtB,EAEAA,EAAI,UAAU,IAAM,SAAU4B,EAAI,CAC9B,OAAO9B,EAAI,KAAK,KAAK,CACzB,EACAE,EAAI,UAAU,OAAS,SAAU2B,EAAG,CAChC,OAAO7B,EAAI6B,EAAE,KAAK,KAAK,CAAC,CAC5B,EAEA3B,EAAI,UAAU,QAAU,SAAU4B,EAAI,CAClC,OAAO9B,EAAI,KAAK,KAAK,CACzB,EAEAE,EAAI,UAAU,OAAS,SAAU2B,EAAG,CAChC,OAAOA,EAAE,KAAK,KAAK,CACvB,EAEA3B,EAAI,UAAU,aAAe,SAAU4B,EAAI,CACvC,OAAOhC,GAAS,KAAK,KAAK,CAC9B,EAEAI,EAAI,UAAU,SAAW,SAAU4B,EAAI,CACnC,OAAOhC,GAAS,KAAK,KAAK,CAC9B,EACAI,EAAI,UAAU,SAAW,SAAUmC,EAAG,CAClC,OAAOA,CACX,EACAnC,EAAI,UAAU,MAAQ,SAAUoC,EAAKtC,EAAK,CACtC,OAAOA,EAAI,KAAK,KAAK,CACzB,EACAE,EAAI,UAAU,cAAgB,SAAUgC,EAAQ,CAC5C,MAAMC,GAAsB,mCAAoC,KAAMD,CAAM,CAChF,EACAhC,EAAI,UAAU,iBAAmB,SAAU+B,EAAG,CAC1C,OAAO,KAAK,KAChB,EACO/B,CACX,EAAE,EACEkB,GAAgBD,GAAO,c7B3VpB,IAAMoB,GAAoB,CAC/B,CAAC,UAAW,OAAU,IAAK,OAAK,SAAU,MAAO,MAAO,EAAK,EAC7D,CAAC,UAAW,OAAU,IAAK,OAAK,SAAU,MAAO,MAAO,GAAK,EAC7D,CAAC,UAAW,OAAU,IAAK,OAAK,SAAU,MAAO,MAAO,GAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,iBAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,iBAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,EAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,EAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,EAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,EAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,kBAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,iBAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,kBAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,IAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,IAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,IAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,IAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,MAAO,MAAO,iBAAK,EAC7D,CAAC,UAAW,SAAU,IAAK,SAAK,SAAU,OAAQ,MAAO,EAAM,CACjE,EAMaC,EAAN,MAAMA,CAAO,CD3CpB,MC2CoB,CAAAC,EAAA,UA2BlB,OAAO,WAAWC,EAAsB,CACtC,GAAIA,EAAK,SAAW,EAClB,MAAM,IAAI,MAAM,kBAAkBA,CAAI,GAAG,EAE3C,GAAIA,EAAK,CAAC,IAAM,IACd,MAAO,CAACF,EAAO,WAAWE,EAAK,OAAO,CAAC,CAAC,EAE1C,GAAIA,EAAK,CAAC,IAAM,SACd,OAAO,KAAK,KAAKF,EAAO,WAAWE,EAAK,OAAO,CAAC,CAAC,CAAC,EAGpD,IAAMC,EAAWH,EAAO,qBAAqBI,GAAKA,EAAE,YAAcF,CAAI,EACtE,GAAIC,IAAa,OACf,OAAOA,EAAS,MAGlB,IAAME,EAAS,WAAWH,CAAI,EAC9B,GAAI,MAAMG,CAAM,EACd,MAAM,IAAI,MAAM,kBAAkBH,CAAI,GAAG,EAE3C,OAAOG,CACT,CASA,OAAO,mBAAmBC,EAAeC,EAAyB,CAChE,GAAID,EAAQ,EACV,MAAO,CAACN,EAAO,mBAAmB,CAACM,EAAOC,CAAO,EAGnD,IAAMC,EAAIF,EAAQ,EAClB,GAAIE,GAAKD,GAAW,EAAIC,GAAKD,EAC3B,OAAO,KAAK,MAAMD,CAAK,EAGzB,IAAMH,EAAWH,EAAO,qBAAqBI,GAAK,KAAK,IAAIA,EAAE,MAAQE,CAAK,GAAKC,CAAO,EACtF,GAAIJ,IAAa,OACf,OAAOA,EAAS,MAGlB,IAAMM,EAAeT,EAAO,qBAAqBI,GAAK,KAAK,IAAI,KAAK,KAAKA,EAAE,KAAK,EAAIE,CAAK,GAAKC,CAAO,EACrG,OAAIE,IAAiB,OACZ,KAAK,KAAKA,EAAa,KAAK,EAG9BH,CACT,CAQA,OAAO,qBAAqBI,EAAiF,CAC3G,QAAWC,KAAQZ,GACjB,GAAIW,EAAUC,CAAI,EAAG,OAAOA,CAGhC,CAaA,YACEC,EACAC,EACAC,EACAC,EACA,CACA,KAAK,kBAAoBH,EACzB,KAAK,qBAAuBC,EAC5B,KAAK,YAAcC,EACnB,KAAK,cAAgBC,CACvB,CAEA,YAAYC,EAAmB,CAC7B,OAAI,KAAK,kBACA,KAAK,gBAAgBA,EAAG,KAAK,qBAAsB,KAAK,WAAW,EAExE,KAAK,cAAgB,OAChBA,EAAE,QAAQ,KAAK,WAAW,EAE5B,OAAOA,CAAC,CACjB,CAUQ,gBAAgBV,EAAeC,EAAU,EAAGU,EAA6B,OAAmB,CAClG,GAAI,KAAK,IAAIX,CAAK,EAAIC,EAAS,MAAO,IACtC,GAAID,EAAQ,EAAG,MAAO,IAAI,KAAK,gBAAgB,CAACA,EAAOC,EAASU,CAAM,CAAC,GAEvE,IAAMd,EAAWH,EAAO,qBAAqBI,GAAK,KAAK,IAAIA,EAAE,MAAQE,CAAK,GAAKC,CAAO,EACtF,GAAIJ,IAAa,OACf,OAAOA,EAAS,UAGlB,IAAMM,EAAeT,EAAO,qBAAqBI,GAAK,KAAK,IAAI,KAAK,KAAKA,EAAE,KAAK,EAAIE,CAAK,GAAKC,CAAO,EACrG,OAAIE,IAAiB,OACZ,SAASA,EAAa,SAAS,GAGpCH,EAAQ,IAAM,GAAKW,IAAW,OACzBX,EAAM,QAAQW,CAAM,EAGtBX,EAAM,SAAS,CACxB,CACF,EA1JaN,EAMK,WAAa,IAAIA,EAAO,GAAO,EAAG,EAAG,IAAI,EAN9CA,EAWK,MAAQ,IAAIA,EAAO,GAAM,EAAG,OAAW,IAAI,EAXhDA,EAgBK,SAAW,IAAIA,EAAO,GAAM,EAAG,OAAW,GAAG,EAhBlDA,EAqBK,WAAa,IAAIA,EAAO,GAAM,KAAQ,EAAG,IAAI,EC5DxD,IAAMkB,GAAN,MAAMC,EAAgB,CFJ7B,MEI6B,CAAAC,EAAA,UAM3B,OAAO,qBAAqBC,EAAiF,CAC3G,QAAWC,KAAQC,GACjB,GAAIF,EAAUC,CAAI,EAAG,OAAOA,CAGhC,CAEA,YACEE,EACAC,EACAC,EACAC,EAAgB,KAChB,CACA,KAAK,kBAAoBH,EACzB,KAAK,qBAAuBC,EAC5B,KAAK,YAAcC,EACnB,KAAK,cAAgBC,CACvB,CAEA,OAAOC,EAAmB,CACxB,OAAI,KAAK,kBACA,KAAK,iBAAiBA,EAAG,KAAK,qBAAsB,KAAK,WAAW,EAEzE,KAAK,cAAgB,OAChBA,EAAE,QAAQ,KAAK,WAAW,EAE5B,OAAOA,CAAC,CACjB,CAEQ,iBAAiBC,EAAeC,EAAU,EAAGC,EAA6B,OAAmB,CACnG,GAAI,KAAK,IAAIF,CAAK,EAAIC,EAAS,MAAO,IACtC,GAAID,EAAQ,EAAG,MAAO,IAAI,KAAK,iBAAiB,CAACA,EAAOC,EAASC,CAAM,CAAC,GAExE,IAAMC,EAAWb,GAAgB,qBAAqBc,GAAK,KAAK,IAAIA,EAAE,MAAQJ,CAAK,GAAKC,CAAO,EAC/F,GAAIE,IAAa,OACf,OAAOA,EAAS,UAGlB,IAAME,EAAef,GAAgB,qBAAqBc,GAAK,KAAK,IAAI,KAAK,KAAKA,EAAE,KAAK,EAAIJ,CAAK,GAAKC,CAAO,EAC9G,OAAII,IAAiB,OACZ,SAASA,EAAa,SAAS,GAGpCL,EAAQ,IAAM,GAAKE,IAAW,OACzBF,EAAM,QAAQE,CAAM,EAGtBF,EAAM,SAAS,CACxB,CACF,EClDMM,GAAyB,CAC7B,kBAAmB,GACnB,qBAAsB,EACtB,YAAa,MACf,EAEaC,GAAN,MAAMA,CAAQ,CHfrB,MGeqB,CAAAhB,EAAA,UAkGnB,YAAYiB,EAAcC,EAAc,CAqCxC,KAAA,UAAY,KAAK,GAAG,KAAK,IAAI,EAe7B,KAAA,uBAAyB,KAAK,SAAS,KAAK,IAAI,EAWhD,KAAA,KAAO,KAAK,UAAU,KAAK,IAAI,EAuB/B,KAAA,KAAO,KAAK,IAAI,KAAK,IAAI,EAczB,KAAA,SAAW,KAAK,IAAI,KAAK,IAAI,EAC7B,KAAA,MAAQ,KAAK,IAAI,KAAK,IAAI,EAc1B,KAAA,SAAW,KAAK,KAAK,KAAK,IAAI,EAC9B,KAAA,MAAQ,KAAK,KAAK,KAAK,IAAI,EA6B3B,KAAA,UAAY,KAAK,IAAI,KAAK,IAAI,EAgB9B,KAAA,UAAY,KAAK,IAAI,KAAK,IAAI,EAgB9B,KAAA,MAAQ,KAAK,KAAK,KAAK,IAAI,EAW3B,KAAA,MAAQ,KAAK,IAAI,KAAK,IAAI,EAC1B,KAAA,MAAQ,KAAK,IAAI,KAAK,IAAI,EA5LxB,KAAK,KAAOD,EACZ,KAAK,KAAOC,EAEZ,KAAK,uBAAyB,KAAK,SACnC,KAAK,UAAY,KAAK,GACtB,KAAK,KAAO,KAAK,UACjB,KAAK,KAAO,KAAK,IAEjB,KAAK,SAAW,KAAK,IACrB,KAAK,MAAQ,KAAK,IAElB,KAAK,SAAW,KAAK,KACrB,KAAK,MAAQ,KAAK,KAClB,KAAK,UAAY,KAAK,IACtB,KAAK,UAAY,KAAK,IACtB,KAAK,MAAQ,KAAK,KAElB,KAAK,MAAQ,KAAK,IAClB,KAAK,MAAQ,KAAK,GACpB,CA1FA,OAAO,KAAKT,EAAkC,CAC5C,OAAI,OAAOA,GAAU,SACZ,IAAIO,EAAQP,EAAO,CAAC,EAGtBA,CACT,CAOA,OAAO,KAAKA,EAAiC,CAC3C,OAAI,OAAOA,GAAU,SACZA,EAGFA,EAAM,IACf,CAOA,OAAO,KAAKA,EAAiC,CAC3C,OAAI,OAAOA,GAAU,SACZ,EAGFA,EAAM,IACf,CAQA,OAAO,MAAMU,EAAmBC,EAAwB,CACtD,GAAM,CAACC,EAAKC,CAAG,EAAI,KAAK,UAAUF,CAAK,EAEvC,OAAO,IAAIJ,EAAQG,EAAYE,EAAKF,EAAYG,CAAG,CACrD,CAEA,OAAe,UAAUC,EAA2B,CAClD,IAAMC,EAAO,KAAK,GAAK,EACjBC,EAAI,KAAK,MAAMF,EAAUC,CAAI,EACnC,GAAIC,EAAID,IAASD,EAAS,CACxB,IAAMG,EAAI,KAAK,KAAK,EAAG,EAWvB,MAVc,CACZ,CAAC,EAAG,CAAC,EACL,CAACA,EAAGA,CAAC,EACL,CAAC,EAAG,CAAC,EACL,CAAC,CAACA,EAAGA,CAAC,EACN,CAAC,GAAI,CAAC,EACN,CAAC,CAACA,EAAG,CAACA,CAAC,EACP,CAAC,EAAG,EAAE,EACN,CAACA,EAAG,CAACA,CAAC,CACR,EACaD,EAAI,CAAC,CACpB,CACA,MAAO,CAAC,KAAK,IAAIF,CAAO,EAAG,KAAK,IAAIA,CAAO,CAAC,CAC9C,CAiCA,GAAGI,EAAyB,CAC1B,OAAI,OAAOA,GAAU,SACZ,KAAK,OAASA,GAAS,KAAK,OAAS,EAE1CA,aAAiBX,EACZ,KAAK,OAASW,EAAM,MAAQ,KAAK,OAASA,EAAM,KAElD,EACT,CASA,SAASA,EAAmCjB,EAA0B,CACpE,GAAI,OAAOiB,GAAU,UAAYA,aAAiBX,EAAS,CACzD,IAAMY,EAAI,KAAK,IAAIZ,EAAQ,KAAKW,CAAK,CAAC,EACtC,OAAO,KAAK,IAAIC,EAAE,IAAI,GAAKlB,GAAW,KAAK,IAAIkB,EAAE,IAAI,GAAKlB,GAAWkB,EAAE,IAAI,GAAKlB,CAClF,CACA,MAAO,EACT,CASA,WAAqB,CACnB,OAAO,IAAIM,EAAQ,KAAK,KAAM,CAAC,KAAK,IAAI,CAC1C,CASA,KAAe,CACb,OAAO,IAAIA,EAAQ,CAAC,KAAK,KAAM,CAAC,KAAK,IAAI,CAC3C,CAQA,IAAIP,EAAkC,CACpC,IAAMoB,EAAIb,EAAQ,KAAKP,CAAK,EAE5B,OAAO,IAAIO,EAAQ,KAAK,KAAOa,EAAE,KAAM,KAAK,KAAOA,EAAE,IAAI,CAC3D,CAUA,IAAIpB,EAAkC,CACpC,IAAMoB,EAAIb,EAAQ,KAAKP,CAAK,EAE5B,OAAO,IAAIO,EAAQ,KAAK,KAAOa,EAAE,KAAM,KAAK,KAAOA,EAAE,IAAI,CAC3D,CAWA,KAAKpB,EAAkC,CACrC,IAAMoB,EAAIb,EAAQ,KAAKP,CAAK,EAE5B,OAAO,IAAIO,EAAQ,KAAK,KAAOa,EAAE,KAAO,KAAK,KAAOA,EAAE,KAAM,KAAK,KAAOA,EAAE,KAAO,KAAK,KAAOA,EAAE,IAAI,CACrG,CAqBA,IAAIpB,EAAiD,CACnD,IAAMoB,EAAIb,EAAQ,KAAKP,CAAK,EACtBmB,EAAIC,EAAE,KAAK,EACjB,GAAID,IAAM,EACR,OAAOE,EAAI,MAAM,kBAAkB,CAAC,EAGtC,IAAMtB,EAAI,KAAK,KAAKqB,EAAE,UAAU,CAAC,EACjC,OAAOE,EAAG,IAAIf,EAAQR,EAAE,KAAOoB,EAAGpB,EAAE,KAAOoB,CAAC,CAAC,CAC/C,CAcA,KAAc,CACZ,OAAO,KAAK,KAAK,KAAK,KAAK,CAAC,CAC9B,CAcA,MAAe,CACb,OAAO,KAAK,KAAO,KAAK,KAAO,KAAK,KAAO,KAAK,IAClD,CASA,KAAc,CACZ,OAAO,KAAK,MAAM,KAAK,KAAM,KAAK,IAAI,CACxC,CAWA,IAAII,EAAqC,CACvC,OAAIA,IAAa,IAAO,KAAK,OAAS,GAAK,KAAK,MAAQ,EAC/C,IAAIhB,EAAQ,KAAK,KAAK,KAAK,IAAI,EAAG,CAAC,EAExC,KAAK,GAAGA,EAAQ,IAAI,EACfA,EAAQ,KAEV,KAAK,GAAG,EAAE,KAAKA,EAAQ,KAAKgB,CAAQ,CAAC,EAAE,IAAI,CACpD,CAKA,KAAe,CACb,OAAOhB,EAAQ,MAAM,KAAK,IAAI,KAAK,IAAI,EAAG,KAAK,IAAI,CACrD,CAgBA,OAAOiB,EAAyBlB,GAAgC,CAC9D,IAAMmB,EAAS,IAAIpC,GACjBmC,EAAQ,oBAAsB,OAAYlB,GAAuB,kBAAoBkB,EAAQ,kBAC7FA,EAAQ,sBAAwB,EAChCA,EAAQ,WACV,EACA,OAAOC,EAAO,kBAAoB,KAAK,yBAAyBA,CAAM,EAAI,KAAK,mBAAmBA,CAAM,CAC1G,CAYA,UAAmB,CACjB,IAAMC,EAAY,IAAIrC,GACpBiB,GAAuB,kBACvBA,GAAuB,qBACvBA,GAAuB,WACzB,EACA,OAAO,KAAK,yBAAyBoB,CAAS,CAChD,CAGQ,IAAc,CACpB,OAAO,IAAInB,EAAQ,KAAK,IAAI,KAAK,IAAI,CAAC,EAAG,KAAK,IAAI,CAAC,CACrD,CAIQ,yBAAyBmB,EAAoC,CACnE,GAAI,KAAK,qBAAqBA,EAAU,oBAAoB,EAC1D,OAAOA,EAAU,OAAO,KAAK,IAAI,EAGnC,GAAI,KAAK,qBAAqBA,EAAU,oBAAoB,EAAG,CAC7D,IAAIC,EAEJ,OAAI,KAAK,uBAAuBD,EAAU,oBAAoB,EAC5DC,EAAa,GACJ,KAAK,qBAAqBD,EAAU,oBAAoB,EACjEC,EAAa,IAEbA,EAAaD,EAAU,OAAO,KAAK,IAAI,EAGlC,GAAGC,CAAU,GACtB,CAEA,OAAO,KAAK,mBAAmBD,CAAS,CAC1C,CAGQ,mBAAmBA,EAAoC,CAC7D,IAAME,EAAW,KAAK,MAAQ,EAAI,IAAM,IAClCD,EAAa,KAAK,uBAAuBD,CAAS,EAAI,GAAKA,EAAU,OAAO,KAAK,IAAI,KAAK,IAAI,CAAC,EAGrG,MAAO,IAFcA,EAAU,mBAAqBA,EAAU,cAAgB,QAAa,KAAK,KAAO,EAAI,GAAK,KAEvFA,EAAU,OAAO,KAAK,IAAI,EAAIE,EAAWD,CAAU,GAC9E,CAGQ,qBAAqB/B,EAAuC,CAClE,OAAO,KAAK,IAAI,KAAK,IAAI,GAAKA,CAChC,CAGQ,qBAAqBA,EAAuC,CAClE,OAAO,KAAK,IAAI,KAAK,IAAI,GAAKA,CAChC,CAGQ,uBAAuBA,EAAuC,CACpE,OAAO,KAAK,IAAI,KAAK,KAAO,CAAC,GAAKA,CACpC,CAGQ,qBAAqBA,EAAuC,CAClE,OAAO,KAAK,IAAI,KAAK,KAAO,CAAC,GAAKA,CACpC,CAGQ,uBAAuB8B,EAAqC,CAClE,OAAOA,EAAU,mBAAqB,KAAK,IAAI,KAAK,IAAI,KAAK,IAAI,EAAI,CAAC,GAAKA,EAAU,oBACvF,CACF,EAhaanB,GAIK,KAAO,IAAIA,GAAQ,EAAG,CAAC,EAJ5BA,GAQK,IAAM,IAAIA,GAAQ,EAAG,CAAC,EAR3BA,GAYK,EAAI,IAAIA,GAAQ,EAAG,CAAC,EIRtC,IAAMsB,GAAeC,EAAA,KAAmB,CAAC,QAAS,aAAa,GAA1C,KAERC,GAAN,MAAMA,EAAK,CPrBlB,MOqBkB,CAAAD,EAAA,UAChB,OAAO,KAAKE,EAAqBC,EAAiBC,EAAsC,CACtF,GAAIF,IAAe,GAAM,CACvB,IAAMG,EAAUD,IAAS,OAAY,iBAAmB,IAAI,MAAM,UAAU,MAAM,KAAKA,CAAI,EAAE,KAAK,IAAI,CAAC,IAEjGE,EAAM;;WADIH,IAAY,OAAY,iBAAmBA,CACL;;QAAaE,CAAO,GAC1E,MAAM,IAAI,MAAMC,CAAG,CACrB,CACF,CAEA,OAAO,QAAWC,EAAmC,CACnDN,GAAK,KAAKM,GAAM,KAAyB,SAAS,CACpD,CAGA,WAAW,SAAkB,CAC3B,IAAMC,EAAM,IAAI,IAAI,SAAS,KAAM,OAAO,SAAS,MAAM,EACnDC,EAAO,mBAAmBD,EAAI,QAAQ,EACtCE,EAAiBD,EAAK,YAAY,GAAG,EAE3C,OAAOA,EAAK,UAAUC,EAAiB,CAAC,CAC1C,CAGF,EAxBaT,GAuBJ,cAAgBU,GAAO,cAAc,KAAK,MAAOZ,EAAY,EAvB/D,IAAMa,GAANX,GwBlBP,IAAIY,EAAc,CAAC,EAEnB,SAASC,GAAaC,EAAG,CACvB,IAAMC,EAAcD,EAAE,KAAK,YACrBE,EAAaF,EAAE,KAAK,WACpBG,EAAYH,EAAE,KAAK,UACnBI,EAAQJ,EAAE,KAAK,MACfK,EAAUL,EAAE,KAAK,QACjBM,EAAmBN,EAAE,KAAK,iBAC1BO,EAAY,IAAIC,GAAU,IAAI,OAAON,CAAU,CAAC,EAEtDO,GAAK,QAAQP,CAAU,EACvBO,GAAK,QAAQN,CAAS,EACtBM,GAAK,QAAQL,CAAK,EAClBK,GAAK,QAAQJ,CAAO,GAIhBP,EAAYG,CAAW,IAAM,QAAaK,KAC5CR,EAAc,CAAC,EACfA,EAAYG,CAAW,EAAI,CAAC,GAK9B,OAAW,CAACS,EAAGC,CAAU,IAAKP,EAAM,QAAQ,EAAG,CAC7C,IAAIQ,EAAa,CAAC,EAEdd,EAAYG,CAAW,EAAES,CAAC,IAAM,SAClCZ,EAAYG,CAAW,EAAES,CAAC,EAAI,CAAC,GAEjC,IAAMG,EAAmBf,EAAYG,CAAW,EAAES,CAAC,EAEnD,GACEG,IAAqB,QACrBA,EAAiB,UAAY,QAC7BA,EAAiB,QAAQ,OAASR,EAAQ,OAC1C,CAGAE,EAAU,QAAQI,CAAU,EAE5B,IAAMG,EAAgBP,EAAU,MAAM,OAAO,MAAM,EAC7CQ,EAAe,OAAO,OAAO,CAAC,EAAGR,EAAU,YAAY,EACvDS,EAAe,OAAO,OAAO,CAAC,EAAGT,EAAU,YAAY,EACvDU,EAAQ,OAAO,OAAO,CAAC,EAAGV,EAAU,KAAK,EAY/C,GAVAT,EAAYG,CAAW,EAAES,CAAC,EAAI,CAC5B,KAAM,OACN,KAAMA,EACN,WAAYI,EACZ,QAAAT,EACA,aAAAU,EACA,aAAAC,EACA,MAAAC,CACF,EAEIP,IAAMP,EAAW,CACnB,IAAMe,EAAaC,GAAqBd,EAASS,CAAa,EAE9DF,EAAa,CACX,KAAM,OACN,KAAMF,EACN,WAAAQ,EACA,aAAAH,EACA,aAAAC,EACA,MAAAC,CACF,CACF,MACEL,EAAa,CACX,KAAM,OACN,KAAMF,EACN,WAAY,CAAC,EACb,aAAAK,EACA,aAAAC,EACA,MAAAC,CACF,CAEJ,MAGEL,EAAa,CACX,KAAM,OACN,KAAMF,EACN,WAAY,CAAC,EACb,aAAcG,EAAiB,aAC/B,aAAcA,EAAiB,aAC/B,MAAOA,EAAiB,KAC1B,EAEIH,IAAMP,IACRS,EAAW,WAAaO,GAAqBd,EAASQ,EAAiB,UAAU,GAIrF,KAAK,YAAYD,CAAU,CAC7B,CAOA,KAAK,YAAY,CAAE,KAAM,QAAS,CAAC,CACrC,CAtGSQ,EAAArB,GAAA,gBAwGT,IAAMoB,GAAuBC,EAAA,CAACf,EAASa,IAC9Bb,EAAQ,OAAO,CAACgB,EAAKC,IAAS,CACnC,GAAIA,GAAQJ,EAAW,OACrBG,EAAIC,CAAI,EAAI,CAAC,EAAG,CAAC,MACZ,CACL,IAAMC,EAAIL,EAAW,QAAQI,EAAM,CAAC,EAAE,MACtCD,EAAIC,CAAI,EAAI,CAACC,EAAE,KAAMA,EAAE,IAAI,CAC7B,CACA,OAAOF,CACT,EAAG,CAAC,CAAC,EATsB,wBAY7B,KAAK,iBAAiB,UAAWtB,EAAY",
  "names": ["require_fraction", "__commonJSMin", "exports", "module", "root", "MAX_CYCLE_LEN", "P", "assign", "n", "s", "Fraction", "__name", "newFraction", "d", "f", "a", "gcd", "factorize", "num", "factors", "i", "parse", "p1", "p2", "v", "w", "x", "y", "z", "A", "B", "C", "D", "N", "M", "modpow", "b", "e", "m", "r", "cycleLen", "rem", "t", "cycleStart", "len", "rem1", "rem2", "places", "k", "eps", "thisABS", "cont", "excludeWhole", "whole", "str", "res", "dec", "cycLen", "cycOff", "makeBy", "__name", "f", "n", "j", "out", "i", "range", "__name", "start", "end", "makeBy", "i", "require_fraction", "__commonJSMin", "exports", "module", "root", "MAX_CYCLE_LEN", "P", "assign", "n", "s", "Fraction", "newFraction", "d", "f", "a", "gcd", "factorize", "num", "factors", "i", "parse", "__name", "p1", "p2", "v", "w", "x", "y", "z", "A", "B", "C", "D", "N", "M", "modpow", "b", "e", "m", "r", "cycleLen", "rem", "t", "cycleStart", "len", "rem1", "rem2", "places", "k", "eps", "thisABS", "cont", "excludeWhole", "whole", "str", "res", "dec", "cycLen", "cycOff", "import_fraction", "ir", "nt", "__awaiter", "thisArg", "_arguments", "generator", "adopt", "value", "resolve", "reject", "fulfilled", "step", "rejected", "result", "__generator", "body", "_", "g", "verb", "op", "__read", "o", "ar", "error", "__spreadArray", "to", "from", "pack", "l", "defaultErrorConfig", "createNeverThrowError", "message", "config", "data", "maybeStack", "ResultAsync", "promise", "newPromise", "Ok", "errorFn", "Err", "asyncResultList", "combineResultAsyncList", "combineResultAsyncListWithAllErrors", "_this", "_a", "_b", "newValue", "ok", "_err", "successCallback", "failureCallback", "errAsync", "err", "fromPromise", "fromSafePromise", "appendValueToEndOfList", "list", "combineResultList", "resultList", "acc", "combineResultListWithAllErrors", "Result", "fromThrowable", "fn", "args", "_i", "combine", "combineWithAllErrors", "_f", "_v", "_ok", "radian", "angle", "coefficient", "piCoefficient", "UNICODE_FRACTIONS", "_Format", "text", "fraction", "epsilon", "rootFraction", "predicate", "each", "allowAbbreviation", "maxAbbreviationError", "fixedDigits", "itemSeparator", "digits", "Format", "NumberFormatter", "_NumberFormatter", "DEFAULT_FORMAT_OPTIONS", "_Complex", "real", "imag", "magnitude", "phase", "cos", "sin", "radians", "unit", "other", "c", "exponent", "options", "format", "formatter", "imagFactor", "imagSign", "Complex", "toParseError", "_Util", "expression", "argDesc", "msg", "url", "path", "lastSlashIndex", "Util", "SerializedBlochDisplayType", "SerializedControlGateType", "SerializedHGateType", "SerializedMeasurementGateType", "SerializedPhaseGateType", "SerializedQftDaggerGateType", "SerializedQftGateType", "SerializedRnotGateType", "SerializedRxGateType", "SerializedRyGateType", "SerializedRzGateType", "SerializedSDaggerGateType", "SerializedSGateType", "SerializedSpacerGateType", "SerializedSwapGateType", "SerializedTDaggerGateType", "SerializedTGateType", "SerializedWrite0GateType", "SerializedWrite1GateType", "SerializedXGateType", "SerializedYGateType", "SerializedZGateType", "Matrix", "_Matrix", "height", "width", "buffer", "rows", "row", "col", "elements", "matrixElementGenerator", "buf", "ri", "ii", "h", "colIndex", "element", "newBuffer", "operation2x2", "targetBit", "controls", "antiControls", "old", "controlMask", "desiredValueMask", "ai", "br", "bi", "cr", "ci", "dr", "di", "targetBitSet", "meetsControlConditions", "j", "xr", "xi", "yr", "yi", "qubitIndex", "isControlled", "qubitVal", "range", "tr_r", "tr_i", "newBuf", "kIn", "kOut", "w1", "h1", "w2", "h2", "r1", "r2", "c1", "c2", "k1", "k2", "k3", "cr1", "ci1", "cr2", "ci2", "cr3", "ci3", "obj", "i1", "i2", "r3", "i3", "sr", "si", "vr", "vi", "mi", "H", "X", "Y", "Z", "S", "SDagger", "T", "TDagger", "PHASE", "phi", "\u03C6", "RNOT", "RX", "theta", "\u03B8", "cos\u03B82", "sin\u03B82", "RY", "RZ", "StateVector", "_StateVector", "bits", "index", "bit", "bitString", "paren", "parenToken", "kets", "invalidBitStringError", "char", "ket", "match", "coefLabel", "ketLabel", "coef", "vector", "traceBits", "removeBits", "mask", "right", "densityMatrix", "bra", "amp", "ketMat", "braMat", "ketBra", "round", "decimal", "Simulator", "operations", "De", "Oe", "Be", "le", "ye", "ge", "Ge", "we", "ie", "ce", "be", "fe", "Ae", "J", "target", "Re", "Fe", "te", "Te", "se", "ae", "targets", "controlOptions", "target0", "target1", "pZero", "span", "u", "gateControlOptions", "p", "import_fraction", "__awaiter", "thisArg", "_arguments", "P", "generator", "adopt", "value", "resolve", "__name", "reject", "fulfilled", "step", "e", "rejected", "result", "__generator", "body", "_", "t", "f", "y", "g", "verb", "n", "v", "op", "__read", "o", "m", "i", "r", "ar", "error", "__spreadArray", "to", "from", "pack", "l", "defaultErrorConfig", "createNeverThrowError", "message", "config", "data", "maybeStack", "ResultAsync", "res", "promise", "newPromise", "Ok", "errorFn", "Err", "asyncResultList", "combineResultAsyncList", "combineResultAsyncListWithAllErrors", "_this", "_a", "_b", "newValue", "ok", "_err", "successCallback", "failureCallback", "errAsync", "__name", "err", "ResultAsync", "Err", "fromPromise", "fromSafePromise", "appendValueToEndOfList", "value", "list", "__spreadArray", "__read", "combineResultList", "resultList", "acc", "result", "ok", "combineResultAsyncList", "asyncResultList", "combineResultListWithAllErrors", "combineResultAsyncListWithAllErrors", "Result", "fromThrowable", "fn", "errorFn", "args", "_i", "e", "combine", "combineWithAllErrors", "Ok", "f", "_f", "_v", "_err", "_", "config", "createNeverThrowError", "error", "v", "_ok", "UNICODE_FRACTIONS", "_Format", "__name", "text", "fraction", "e", "result", "value", "epsilon", "r", "rootFraction", "predicate", "each", "allowAbbreviation", "maxAbbreviationError", "fixedDigits", "itemSeparator", "f", "digits", "NumberFormatter", "_NumberFormatter", "__name", "predicate", "each", "UNICODE_FRACTIONS", "allowAbbreviation", "maxAbbreviationError", "fixedDigits", "itemSeparator", "n", "value", "epsilon", "digits", "fraction", "e", "rootFraction", "DEFAULT_FORMAT_OPTIONS", "_Complex", "real", "imag", "magnitude", "phase", "cos", "sin", "radians", "unit", "i", "s", "other", "d", "c", "err", "ok", "exponent", "options", "format", "formatter", "imagFactor", "imagSign", "toParseError", "__name", "_Util", "expression", "message", "args", "argDesc", "msg", "v", "url", "path", "lastSlashIndex", "Result", "Util", "resultCache", "runSimulator", "e", "circuitJson", "qubitCount", "stepIndex", "steps", "targets", "invalidateCaches", "simulator", "Ht", "x", "i", "operations", "stepResult", "cachedStepResult", "allAmplitudes", "blochVectors", "measuredBits", "flags", "amplitudes", "pickTargetAmplitudes", "__name", "map", "each", "c"]
}
