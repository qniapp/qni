<!DOCTYPE html>
<html lang="ja">
  <head>
    <title>BB84 プロトコル</title>

    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Untitled</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <!-- Place favicon.ico in the root directory -->

    <script type="module" src="./application.js" defer></script>
    <link href="./application.css" rel="stylesheet" />

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>
    <script
      defer
      data-domain="qniapp.github.io"
      src="https://plausible.io/js/plausible.js"
    ></script>
  </head>
  <body>
    <div class="flex h-screen overflow-hidden">
  <div class="hidden md:flex md:flex-shrink-0">
  <div class="flex w-64 flex-col">
    <div class="flex flex-grow flex-col overflow-y-auto bg-white pt-5 pb-4">
      <div class="flex flex-shrink-0 items-center px-8">
        <img class="mr-2 h-8 w-8" src="https://qniapp.net/icon-512.png" alt="Qni" />
        <span class="font-sans text-xl font-bold tracking-wider text-gray-900 subpixel-antialiased"
          >Qni</span
        >
      </div>
      <div class="mt-5 mb-14 flex flex-grow flex-col"><nav class="flex-1 space-y-1 bg-white px-6">
  
  <div class="px-2 py-2 text-sm font-bold uppercase tracking-wide text-blue-700">
    QPU
  </div>

   
  <a
    href="./"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    はじめに
  </a>
   
  <a
    href="./qpu.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    QPU とは
  </a>
   
  <a
    href="./what_qpu_do_faster.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    QPU は何が得意？
  </a>
   
  <a
    href="./qpu_operations.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    QPU 演算
  </a>
   
  <a
    href="./qni_intro.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    Qni 入門
  </a>
   
  <div class="px-2 py-2 text-sm font-bold uppercase tracking-wide text-blue-700">
    量子ビット
  </div>

   
  <a
    href="./p_bit.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    確率的ビット
  </a>
   
  <a
    href="./superposition.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    重ね合わせ状態
  </a>
   
  <a
    href="./q_bit.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    量子ビット
  </a>
   
  <a
    href="./circle_notation.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    状態ベクトル表示
  </a>
   
  <div class="px-2 py-2 text-sm font-bold uppercase tracking-wide text-blue-700">
    QPU 演算その 1
  </div>

   
  <a
    href="./cpu_vs_qpu_operations.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    CPU 演算との違い
  </a>
   
  <a
    href="./not_gate.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    量子 NOT ゲート (X ゲート)
  </a>
   
  <a
    href="./h_gate.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    H ゲート
  </a>
   
  <a
    href="./write_operation.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    WRITE 命令
  </a>
   
  <a
    href="./measurement_operation.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    MEASUREMENT (測定) 命令
  </a>
   
  <a
    href="./no_cloning_theorem.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    CLONE (複製) 命令!?
  </a>
   
  <div class="px-2 py-2 text-sm font-bold uppercase tracking-wide text-blue-700">
    量子暗号通信
  </div>

   
  <a
    href="./quantum_key_distribution.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    量子鍵配送
  </a>
   
  <a
    href="./bb84_protocol.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-900 bg-blue-100 "
  >
    BB84 プロトコル
  </a>
   
  <a
    href="./bb84_circuit.html"
    class="flex group items-center pl-4 pr-2 py-2 text-sm font-medium rounded-md  text-gray-500 hover:text-gray-900 hover:bg-blue-50 "
  >
    BB84 回路
  </a>
   
</nav>
</div>
    </div>
  </div>
</div>

  <div class="flex w-0 flex-1 flex-col overflow-hidden">
    <main class="relative flex-1 overflow-y-auto focus:outline-none">
      <div class="py-5">
        <div class="h-8"></div>
        <div class="mx-auto max-w-7xl px-4 sm:px-6 md:px-8">
          <div class="mt-5 sm:mb-12 lg:mb-16">
            <div class="mb-10 border-b border-gray-200 pb-10">
              <div>
                <h1 class="inline-block text-3xl font-extrabold tracking-tight text-gray-900">
                  BB84 プロトコル
                </h1>
              </div>
              <p class="mt-1 text-lg text-gray-500">量子力学で暗号鍵の盗聴を検出</p>
            </div>
            <div class="prose"><p>
  暗号の話を始める前に、いつもの登場人物を紹介しましょう。同じ小学校に通うアリスとボブ、イブの 3
  人です<label for="margin-note-alice-bob" class="margin-toggle margin-note-number"></label><input type="checkbox" id="margin-note-alice-bob" class="margin-toggle"><span class="margin-note md:w-1/2">暗号技術の解説記事や論文では、説明のためによくこの架空の 3 人が登場します。
  たいていはアリス (Alice) がボブ (Bob) にメッセージを送り、悪いハッカーのイブ (Eve)
  が盗聴を企てます。複雑な暗号の例になるとさらに、チャーリー (Charlie)、デイヴ
  (Dave)、というように頭文字に A, B, C, D,... を持つキャラクター達が続々と登場します。</span>。
  アリスは自宅ガレージで作ったゴリラロボットの制御ソフトウェアをボブに送ろうとしています。
  イブは意地悪な天才ハッカーで、アリスのソフトウェアを盗聴し、ロボットにバックドアを仕掛けてやろうともくろんでいます。
</p>

<p>
  アリスはイブがいつも盗聴していることを知っているので、ボブとの通信には絶対に破られない量子暗号通信を使います。
  量子暗号通信は、アリスとボブが暗号鍵を安全に共有することを可能にします。
</p>

<h2>暗号鍵の共有</h2>

<p>
  暗号鍵を共有するには、アリスが <code>0</code> と
  <code>1</code>
  をランダムに並べた長い文字列を作り、それを盗聴されないようにボブに送る必要があります。
  普通のコンピュータでランダム文字列を生成してしまうと、イブがアリスの乱数アルゴリズムを突き止めることで暗号鍵を盗んでしまう可能性があります。
  そこで、量子乱数ジェネレータ<label for="margin-note-measurement-operation" class="margin-toggle margin-note-number"></label><input type="checkbox" id="margin-note-measurement-operation" class="margin-toggle"><span class="margin-note md:w-1/2"><a href="./measurement_operation.html">MEASUREMENT (測定) 命令</a>を参照</span>を使って、原理的にまったく予測できない完璧な乱数を生成します。 アリスは長めに
  <code>4,000</code> 文字の暗号鍵を量子乱数で生成しました。
</p>

<p>
  今度は、生成した暗号鍵をボブに送る必要があります。
  しかしイブはアリスの通信をいつも盗聴しており、さらに最新の量子コンピュータまで持っています。
  アリスが暗号鍵に暗号をかけてボブにメールしようものなら、イブはたちどころにその暗号を解除してしまうでしょう。
  そこで BB84 プロトコルの出番です。
</p>

<h2>BB84 プロトコル</h2>

<p>
  BB84 では、盗聴を検知するために量子チャンネルを使って暗号鍵データを送ります。
  量子チャンネルとは量子ビットを送受信できる通信路で、現在の技術では光ファイバを通じて光子を量子ビットとして送ることで、これを実現できます。
  アリスは量子チャンネルを通じて、<code>4,000</code> 文字の <code>0</code> と
  <code>1</code> からなる暗号鍵を、<code>|0⟩</code> または <code>|1⟩</code> の状態をもつ
  <code>4,000</code> 個の量子ビットとしてボブに送ります。
</p>

<p>
  量子ビットを送る際に、アリスはイブの盗聴を検出するための仕掛けを量子ビットに入れます
  (この仕掛けの効果については、後半で説明します)。 アリスは、送信する 1 量子ビットごとにランダムに H
  ゲートを適用します。1 量子ビット送るごとに量子乱数で <code>0</code> (H ゲートを適用しない) または
  <code>1</code> (H ゲートを適用する) を生成し、もし <code>1</code> (H ゲートを適用する)
  だったら現在の<span class="font-bold">量子ビットの通し番号をメモし (382 番目など)</span
  >、量子ビットに H ゲートを適用してからボブに送ります。 このときアリスの送る量子ビットは、次の 4
  パターンのうちいずれか 1 つの状態になっています。
</p>

<div class="flex pb-10">
  <div class="flex flex-col">
    <div class="flex flex-row items-center">
      <div class="mr-16">ボブに <code>|0⟩</code> を送る場合 (H なし/あり)</div>

      <div class="flex flex-col">
        <div class="mb-8 flex flex-row items-center space-x-1">
          <circle-notation
            id="circle-notation-NOP-0-before"
            data-size="xl"
            data-show-kets
          ></circle-notation>
          <div class="flex flex-row items-center">
            <svg class="h-6 w-6 fill-current text-gray-400" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2.25 7.5C2.25 7.22386 2.47386 7 2.75 7H12.25C12.5261 7 12.75 7.22386 12.75 7.5C12.75 7.77614 12.5261 8 12.25 8H2.75C2.47386 8 2.25 7.77614 2.25 7.5Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>

            <div>NOP</div>
            <svg class="h-6 w-6 fill-current text-gray-400" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.14645 3.14645C8.34171 2.95118 8.65829 2.95118 8.85355 3.14645L12.8536 7.14645C13.0488 7.34171 13.0488 7.65829 12.8536 7.85355L8.85355 11.8536C8.65829 12.0488 8.34171 12.0488 8.14645 11.8536C7.95118 11.6583 7.95118 11.3417 8.14645 11.1464L11.2929 8H2.5C2.22386 8 2 7.77614 2 7.5C2 7.22386 2.22386 7 2.5 7H11.2929L8.14645 3.85355C7.95118 3.65829 7.95118 3.34171 8.14645 3.14645Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>

          </div>
          <circle-notation
            id="circle-notation-NOP-0-after"
            data-size="xl"
            data-show-kets
          ></circle-notation>
        </div>

        <div class="mb-8 flex flex-row items-center space-x-1">
          <circle-notation
            id="circle-notation-H0-before"
            data-size="xl"
            data-show-kets
          ></circle-notation>
          <div class="flex flex-row items-center">
            <svg class="h-6 w-6 fill-current text-gray-400" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2.25 7.5C2.25 7.22386 2.47386 7 2.75 7H12.25C12.5261 7 12.75 7.22386 12.75 7.5C12.75 7.77614 12.5261 8 12.25 8H2.75C2.47386 8 2.25 7.77614 2.25 7.5Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>

            <h-gate data-size="base"></h-gate>
            <svg class="h-6 w-6 fill-current text-gray-400" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.14645 3.14645C8.34171 2.95118 8.65829 2.95118 8.85355 3.14645L12.8536 7.14645C13.0488 7.34171 13.0488 7.65829 12.8536 7.85355L8.85355 11.8536C8.65829 12.0488 8.34171 12.0488 8.14645 11.8536C7.95118 11.6583 7.95118 11.3417 8.14645 11.1464L11.2929 8H2.5C2.22386 8 2 7.77614 2 7.5C2 7.22386 2.22386 7 2.5 7H11.2929L8.14645 3.85355C7.95118 3.65829 7.95118 3.34171 8.14645 3.14645Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>

          </div>
          <circle-notation
            id="circle-notation-H0-after"
            data-size="xl"
            data-show-kets
          ></circle-notation>
        </div>
      </div>
    </div>

    <hr class="pt-8" />

    <div class="flex flex-row items-center">
      <div class="mr-16">ボブに <code>|1⟩</code> を送る場合 (H なし/あり)</div>

      <div class="flex flex-col">
        <div class="mb-8 flex flex-row items-center space-x-1">
          <circle-notation
            id="circle-notation-NOP-1-before"
            data-size="xl"
            data-show-kets
          ></circle-notation>
          <div class="flex flex-row items-center">
            <svg class="h-6 w-6 fill-current text-gray-400" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2.25 7.5C2.25 7.22386 2.47386 7 2.75 7H12.25C12.5261 7 12.75 7.22386 12.75 7.5C12.75 7.77614 12.5261 8 12.25 8H2.75C2.47386 8 2.25 7.77614 2.25 7.5Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>

            <div>NOP</div>
            <svg class="h-6 w-6 fill-current text-gray-400" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.14645 3.14645C8.34171 2.95118 8.65829 2.95118 8.85355 3.14645L12.8536 7.14645C13.0488 7.34171 13.0488 7.65829 12.8536 7.85355L8.85355 11.8536C8.65829 12.0488 8.34171 12.0488 8.14645 11.8536C7.95118 11.6583 7.95118 11.3417 8.14645 11.1464L11.2929 8H2.5C2.22386 8 2 7.77614 2 7.5C2 7.22386 2.22386 7 2.5 7H11.2929L8.14645 3.85355C7.95118 3.65829 7.95118 3.34171 8.14645 3.14645Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>

          </div>
          <circle-notation
            id="circle-notation-NOP-1-after"
            data-size="xl"
            data-show-kets
          ></circle-notation>
        </div>

        <div class="mb-8 flex flex-row items-center space-x-1">
          <circle-notation
            id="circle-notation-H1-before"
            data-size="xl"
            data-show-kets
          ></circle-notation>
          <div class="flex flex-row items-center">
            <svg class="h-6 w-6 fill-current text-gray-400" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2.25 7.5C2.25 7.22386 2.47386 7 2.75 7H12.25C12.5261 7 12.75 7.22386 12.75 7.5C12.75 7.77614 12.5261 8 12.25 8H2.75C2.47386 8 2.25 7.77614 2.25 7.5Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>

            <h-gate data-size="base"></h-gate>
            <svg class="h-6 w-6 fill-current text-gray-400" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.14645 3.14645C8.34171 2.95118 8.65829 2.95118 8.85355 3.14645L12.8536 7.14645C13.0488 7.34171 13.0488 7.65829 12.8536 7.85355L8.85355 11.8536C8.65829 12.0488 8.34171 12.0488 8.14645 11.8536C7.95118 11.6583 7.95118 11.3417 8.14645 11.1464L11.2929 8H2.5C2.22386 8 2 7.77614 2 7.5C2 7.22386 2.22386 7 2.5 7H11.2929L8.14645 3.85355C7.95118 3.65829 7.95118 3.34171 8.14645 3.14645Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>

          </div>
          <circle-notation
            id="circle-notation-H1-after"
            data-size="xl"
            data-show-kets
          ></circle-notation>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    import { Complex } from './application.js'

    let circleNotationNOP0Before = document.getElementById('circle-notation-NOP-0-before')
    let circleNotationNOP0After = document.getElementById('circle-notation-NOP-0-after')
    let circleNotationH0before = document.getElementById('circle-notation-H0-before')
    let circleNotationH1before = document.getElementById('circle-notation-H1-before')

    let circleNotationNOP1Before = document.getElementById('circle-notation-NOP-1-before')
    let circleNotationNOP1After = document.getElementById('circle-notation-NOP-1-after')
    let circleNotationH0after = document.getElementById('circle-notation-H0-after')
    let circleNotationH1after = document.getElementById('circle-notation-H1-after')

    circleNotationNOP0Before.setAmplitudes({
      0: 1,
      1: 0,
    })
    circleNotationNOP0After.setAmplitudes({
      0: 1,
      1: 0,
    })
    circleNotationH0before.setAmplitudes({
      0: 1,
      1: 0,
    })
    circleNotationH0after.setAmplitudes({
      0: new Complex(Math.sqrt(0.5), 0),
      1: new Complex(Math.sqrt(0.5), 0),
    })
    circleNotationNOP1Before.setAmplitudes({
      0: 0,
      1: 1,
    })
    circleNotationNOP1After.setAmplitudes({
      0: 0,
      1: 1,
    })
    circleNotationH1before.setAmplitudes({
      0: 0,
      1: 1,
    })
    circleNotationH1after.setAmplitudes({
      0: new Complex(Math.sqrt(0.5), 0),
      1: new Complex(-Math.sqrt(0.5), 0),
    })
  </script>
</div>

<p>
  受け取る側のボブも、1 量子ビットごとに量子乱数でランダムに H ゲートを適用してから受け取ります。
  この時ボブもまた、<span class="font-bold"
    >H ゲートを適用した量子ビットの通し番号をメモしておきます。</span
  >
  ここで、アリスもボブの手元には H
  ゲートを適用した量子ビットの番号リストが残っていますが、それぞれ完全にランダムに選んだので、異なる番号リストを持っていることに注意しましょう。
</p>

<p>
  暗号鍵の送信が終わると、アリスとボブはそれぞれのリストをインターネット上で交換し、H
  ゲートを適用した/しないが一致する量子ビットの番号一覧を得ます。 一致するのは大体
  <code>1/2</code> ですから、手元にはもともと送った <code>4,000</code> 量子ビットの半分、<code
    >2,000</code
  >
  量子ビットのリストが残ります。 このリストの量子ビットをボブが測定すると、アリスとボブのどちらも H
  ゲートを適用しなかった量子ビットについては、アリスがセットした <code>|0⟩</code> または <code>|1⟩</code>
  がそのまま得られます。 アリスとボブの両者が H ゲートを適用した量子ビットについても、H ゲートを 2
  回適用することで元通りになるので (H
  ゲートはそれ自身を打ち消す効果があるのでした)、やはりボブはアリスのセットした値を得ます。
</p>

<p>
  アリスとボブはさらに、得られた <code>2,000</code> 文字のうち最初の半分
  <code>1,000</code>
  文字をインターネット経由で交換し、確かに一致していることをお互いにチェックします。
  もし一致していれば、インターネットに流していない残り
  <code>1,000</code> 文字を秘密の暗号鍵として使うことができます。
</p>

<h2>イブの盗聴を検出する</h2>

<p>
  もしイブがアリスとボブの中間で量子ビットを盗聴していたら、結果はどう変わるでしょうか？
  クローン禁止定理<label for="margin-note-no-cloning-theorem" class="margin-toggle margin-note-number"></label><input type="checkbox" id="margin-note-no-cloning-theorem" class="margin-toggle"><span class="margin-note md:w-1/2"><a href="./no_cloning_theorem.html">CLONE (複製) 命令!?</a>を参照</span>により、イブはアリスの送った量子ビットをそっくりそのまま複製することはできません。
  このため、盗聴するにはアリスの送った量子ビットをこっそり測定し、別の量子ビットをボブに送る必要があります。
</p>

<p>
  間にイブがはさまることで、ボブが受け取る量子ビットの測定結果に影響が出ます。
  これは、アリスとボブが最終チェックで <code>1,000</code> 文字の値を突き合わせる時に発覚します。
  イブがでたらめに送った量子ビットのせいで、<code>1,000</code> 文字の約半分
  <code>500</code> 文字が一致しなくなってしまうのです。
  こうなるとアリスとボブは別の通信方法を採るしかありませんが、イブによる暗号鍵ハッキングは未然に防げることになります。
</p>

<h2>まとめ</h2>

<p>
  BB84 は量子乱数の完全なランダム性や、H
  ゲートがそれ自身の逆演算であるという性質、そしてクローン禁止定理から来る制約を組合わせた、巧妙な量子暗号通信プロトコルです。
  数種類の基本的な QPU
  命令だけで量子暗号を実現できるので、汎用の量子コンピュータよりも先に商業化できることが期待されています。
</p>

<template id="circle-notation-popup">
  <ul class="list-none">
    <li>
      振幅:
      <span class="circle-notation-popup__amplitude-real text-eel font-mono font-bold"></span>
      <span class="circle-notation-popup__amplitude-imag text-eel font-mono font-bold"></span>
    </li>
    <li>
      確率:
      <span class="circle-notation-popup__probability text-eel font-mono font-bold"></span>
    </li>
    <li>
      位相:
      <span class="circle-notation-popup__phase text-eel font-mono font-bold"></span>
    </li>
  </ul>
</template>

</div>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>

  </body>
</html>
